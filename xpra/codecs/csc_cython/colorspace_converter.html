<!DOCTYPE html>
<!-- Generated by Cython 0.29.14 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Cython: colorspace_converter.pyx</title>
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 8px; border-left: 8px none; }

.cython.line .run { background-color: #B0FFB0; }
.cython.line .mis { background-color: #FFB0B0; }
.cython.code.run  { border-left: 8px solid #B0FFB0; }
.cython.code.mis  { border-left: 8px solid #FFB0B0; }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .trace  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}
    </style>
</head>
<body class="cython">
<p><span style="border-bottom: solid 1px grey;">Generated by Cython 0.29.14</span></p>
<p>
    <span style="background-color: #FFFF00">Yellow lines</span> hint at Python interaction.<br />
    Click on a line that starts with a "<code>+</code>" to see the C code that Cython generated for it.
</p>
<p>Raw output: <a href="colorspace_converter.c">colorspace_converter.c</a></p>
<div class="cython"><pre class="cython line score-0">&#xA0;<span class="">001</span>: # This file is part of Xpra.</pre>
<pre class="cython line score-0">&#xA0;<span class="">002</span>: # Copyright (C) 2013 Arthur Huillet</pre>
<pre class="cython line score-0">&#xA0;<span class="">003</span>: # Copyright (C) 2012-2022 Antoine Martin &lt;antoine@devloop.org.uk&gt;</pre>
<pre class="cython line score-0">&#xA0;<span class="">004</span>: # Xpra is released under the terms of the GNU GPL v2, or, at your option, any</pre>
<pre class="cython line score-0">&#xA0;<span class="">005</span>: # later version. See the file COPYING for details.</pre>
<pre class="cython line score-0">&#xA0;<span class="">006</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">007</span>: #cython: boundscheck=False, wraparound=False, overflowcheck=False</pre>
<pre class="cython line score-0">&#xA0;<span class="">008</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">009</span>: import os</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_os, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_os, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 9, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">010</span>: import sys</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_sys, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_sys, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 10, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">011</span>: import time</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_time, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_time, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 11, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">012</span>: </pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">013</span>: from xpra.log import Logger</pre>
<pre class='cython code score-19 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_Logger);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_Logger);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_Logger);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_xpra_log, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_Logger);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_Logger, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 13, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">014</span>: log = Logger("csc", "cython")</pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_Logger);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_tuple__17, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_log, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
/* … */
  __pyx_tuple__17 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_u_csc, __pyx_n_u_cython);<span class='error_goto'> if (unlikely(!__pyx_tuple__17)) __PYX_ERR(0, 14, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__17);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__17);
</pre><pre class="cython line score-0">&#xA0;<span class="">015</span>: </pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">016</span>: from xpra.codecs.codec_constants import csc_spec, get_subsampling_divs</pre>
<pre class='cython code score-29 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_csc_spec);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_csc_spec);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_csc_spec);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_get_subsampling_divs);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_get_subsampling_divs);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_s_get_subsampling_divs);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_xpra_codecs_codec_constants, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_csc_spec);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_csc_spec, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_get_subsampling_divs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_subsampling_divs, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 16, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">017</span>: from xpra.codecs.image_wrapper import ImageWrapper</pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_ImageWrapper);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_ImageWrapper);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_ImageWrapper);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_xpra_codecs_image_wrapper, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_ImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_ImageWrapper, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 17, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">018</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">019</span>: from libc.stdint cimport uint8_t, uintptr_t # pylint: disable=syntax-error</pre>
<pre class="cython line score-0">&#xA0;<span class="">020</span>: from xpra.buffers.membuf cimport memalign, buffer_context</pre>
<pre class="cython line score-0">&#xA0;<span class="">021</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">022</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">023</span>: cdef extern from "Python.h":</pre>
<pre class="cython line score-0">&#xA0;<span class="">024</span>:     object PyMemoryView_FromMemory(char *mem, Py_ssize_t size, int flags)</pre>
<pre class="cython line score-0">&#xA0;<span class="">025</span>:     int PyObject_GetBuffer(object obj, Py_buffer *view, int flags)</pre>
<pre class="cython line score-0">&#xA0;<span class="">026</span>:     void PyBuffer_Release(Py_buffer *view)</pre>
<pre class="cython line score-0">&#xA0;<span class="">027</span>:     int PyBUF_ANY_CONTIGUOUS</pre>
<pre class="cython line score-0">&#xA0;<span class="">028</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">029</span>: cdef extern from "stdlib.h":</pre>
<pre class="cython line score-0">&#xA0;<span class="">030</span>:     void free(void *ptr)</pre>
<pre class="cython line score-0">&#xA0;<span class="">031</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">032</span>: cdef inline int roundup(int n, int m):</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE int __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup(int __pyx_v_n, int __pyx_v_m) {
  int __pyx_r;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("roundup", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">033</span>:     return (n + m - 1) &amp; ~(m - 1)</pre>
<pre class='cython code score-0 '>  __pyx_r = (((__pyx_v_n + __pyx_v_m) - 1) &amp; (~(__pyx_v_m - 1)));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">034</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">035</span>: #precalculate indexes in native endianness:</pre>
<pre class="cython line score-0">&#xA0;<span class="">036</span>: cdef uint8_t BGRX_R, BGRX_G, BGRX_B, BGRX_X</pre>
<pre class="cython line score-0">&#xA0;<span class="">037</span>: cdef uint8_t RGBX_R, RGBX_G, RGBX_B, RGBX_X</pre>
<pre class="cython line score-0">&#xA0;<span class="">038</span>: cdef uint8_t RGB_R, RGB_G, RGB_B</pre>
<pre class="cython line score-0">&#xA0;<span class="">039</span>: cdef uint8_t BGR_R, BGR_G, BGR_B</pre>
<pre class="cython line score-0">&#xA0;<span class="">040</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">041</span>: if sys.byteorder=="little":</pre>
<pre class='cython code score-8 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_sys);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_byteorder);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_little, Py_EQ)); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 41, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (__pyx_t_3) {
/* … */
    goto __pyx_L2;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">042</span>:     BGRX_B, BGRX_G, BGRX_R, BGRX_X = 0, 1, 2, 3</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = 0;
    __pyx_t_5 = 1;
    __pyx_t_6 = 2;
    __pyx_t_7 = 3;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_B = __pyx_t_4;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_G = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_R = __pyx_t_6;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_X = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">043</span>:     RGBX_R, RGBX_G, RGBX_B, RGBX_X = 0, 1, 2, 3</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = 0;
    __pyx_t_6 = 1;
    __pyx_t_5 = 2;
    __pyx_t_4 = 3;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_R = __pyx_t_7;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_G = __pyx_t_6;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_B = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_X = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">044</span>:     BGR_R, BGR_G, BGR_B = 2, 1, 0</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = 2;
    __pyx_t_5 = 1;
    __pyx_t_6 = 0;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_R = __pyx_t_4;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_G = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_B = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">045</span>:     RGB_R, RGB_G, RGB_B = 0, 1, 2</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = 0;
    __pyx_t_5 = 1;
    __pyx_t_4 = 2;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_R = __pyx_t_6;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_G = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_B = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">046</span>: else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">047</span>:     BGRX_B, BGRX_G, BGRX_R, BGRX_X = 0, 1, 2, 3</pre>
<pre class='cython code score-0 '>  /*else*/ {
    __pyx_t_4 = 0;
    __pyx_t_5 = 1;
    __pyx_t_6 = 2;
    __pyx_t_7 = 3;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_B = __pyx_t_4;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_G = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_R = __pyx_t_6;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_X = __pyx_t_7;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">048</span>:     RGBX_R, RGBX_G, RGBX_B, RGBX_X = 0, 1, 2, 3</pre>
<pre class='cython code score-0 '>    __pyx_t_7 = 0;
    __pyx_t_6 = 1;
    __pyx_t_5 = 2;
    __pyx_t_4 = 3;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_R = __pyx_t_7;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_G = __pyx_t_6;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_B = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_X = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">049</span>:     BGR_R, BGR_G, BGR_B = 0, 1, 2</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = 0;
    __pyx_t_5 = 1;
    __pyx_t_6 = 2;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_R = __pyx_t_4;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_G = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_B = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">050</span>:     RGB_R, RGB_G, RGB_B = 2, 1, 0</pre>
<pre class='cython code score-0 '>    __pyx_t_6 = 2;
    __pyx_t_5 = 1;
    __pyx_t_4 = 0;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_R = __pyx_t_6;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_G = __pyx_t_5;
    __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_B = __pyx_t_4;
  }
  __pyx_L2:;
</pre><pre class="cython line score-0">&#xA0;<span class="">051</span>: </pre>
<pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">052</span>: log("csc_cython: %s endian:", sys.byteorder)</pre>
<pre class='cython code score-20 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_sys);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_byteorder);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_csc_cython_s_endian);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_csc_cython_s_endian);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_csc_cython_s_endian);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 52, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">053</span>: log("csc_cython: byteorder(BGRX)=%s", (BGRX_B, BGRX_G, BGRX_R, BGRX_X))</pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_B);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_G);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_9 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_R);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_X);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3, __pyx_t_10);
  __pyx_t_1 = 0;
  __pyx_t_2 = 0;
  __pyx_t_9 = 0;
  __pyx_t_10 = 0;
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_csc_cython_byteorder_BGRX_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_csc_cython_byteorder_BGRX_s);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_kp_u_csc_cython_byteorder_BGRX_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 53, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-24" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">054</span>: log("csc_cython: byteorder(RGBX)=%s", (RGBX_R, RGBX_G, RGBX_B, RGBX_X))</pre>
<pre class='cython code score-24 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_10 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_R);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_8 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_G);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_B);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_2 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_X);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_2);
  __pyx_t_10 = 0;
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_csc_cython_byteorder_RGBX_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_csc_cython_byteorder_RGBX_s);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_csc_cython_byteorder_RGBX_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 54, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">055</span>: log("csc_cython: byteorder(RGB)=%s", (RGB_R, RGB_G, RGB_B))</pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_R);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_11 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_G);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_9 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_B);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_9);
  __pyx_t_2 = 0;
  __pyx_t_11 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_csc_cython_byteorder_RGB_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_csc_cython_byteorder_RGB_s);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_kp_u_csc_cython_byteorder_RGB_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 55, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-23" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">056</span>: log("csc_cython: byteorder(BGR)=%s", (BGR_R, BGR_G, BGR_B))</pre>
<pre class='cython code score-23 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_R);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_1 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_G);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_11 = __Pyx_PyInt_From_uint8_t(__pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_B);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_t_11);
  __pyx_t_9 = 0;
  __pyx_t_1 = 0;
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_csc_cython_byteorder_BGR_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_csc_cython_byteorder_BGR_s);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_kp_u_csc_cython_byteorder_BGR_s);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 56, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">057</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">058</span>: #COLORSPACES = {"BGRX" : ["YUV420P"], "YUV420P" : ["RGB", "BGR", "RGBX", "BGRX"], "GBRP" : ["RGBX", "BGRX"] }</pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">059</span>: def get_CS(in_cs, valid_options):</pre>
<pre class='cython code score-47 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_1get_CS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_1get_CS = {"get_CS", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_1get_CS, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_1get_CS(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_in_cs = 0;
  PyObject *__pyx_v_valid_options = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_CS (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_in_cs,&amp;__pyx_n_s_valid_options,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_in_cs)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_valid_options)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_CS", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_CS") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_in_cs = values[0];
    __pyx_v_valid_options = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_CS", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.get_CS", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_get_CS(__pyx_self, __pyx_v_in_cs, __pyx_v_valid_options);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_get_CS(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_in_cs, PyObject *__pyx_v_valid_options) {
  PyObject *__pyx_v_v = NULL;
  PyObject *__pyx_v_env_override = NULL;
  PyObject *__pyx_v_cs = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_CS", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.get_CS", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_v);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_env_override);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cs);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__18 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_in_cs, __pyx_n_s_valid_options, __pyx_n_s_v, __pyx_n_s_env_override, __pyx_n_s_cs);<span class='error_goto'> if (unlikely(!__pyx_tuple__18)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__18);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__18);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_1get_CS, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_CS, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 59, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__19 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__18, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_get_CS, 59, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__19)) __PYX_ERR(0, 59, __pyx_L1_error)</span>
</pre><pre class="cython line score-25" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">060</span>:     v = os.environ.get("XPRA_CSC_CYTHON_%s_COLORSPACES" % in_cs)</pre>
<pre class='cython code score-25 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_os);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_environ);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_XPRA_CSC_CYTHON__s_COLORSPACES, __pyx_v_in_cs);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_4) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_4, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 60, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_v = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">061</span>:     if not v:</pre>
<pre class='cython code score-2 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_v); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 61, __pyx_L1_error)</span>
  __pyx_t_6 = ((!__pyx_t_5) != 0);
  if (__pyx_t_6) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">062</span>:         return valid_options</pre>
<pre class='cython code score-2 '>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_valid_options);
    __pyx_r = __pyx_v_valid_options;
    goto __pyx_L0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">063</span>:     env_override = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 63, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_env_override = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">064</span>:     for cs in v.split(","):</pre>
<pre class='cython code score-60 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_v, __pyx_n_s_split);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_kp_u_) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_kp_u_);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_1)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_t_1)) {
    __pyx_t_2 = __pyx_t_1; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_7 = 0;
    __pyx_t_8 = NULL;
  } else {
    __pyx_t_7 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_8 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  for (;;) {
    if (likely(!__pyx_t_8)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      } else {
        if (__pyx_t_7 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_1 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_7); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1); __pyx_t_7++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
        #else
        __pyx_t_1 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_7); __pyx_t_7++;<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 64, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        #endif
      }
    } else {
      __pyx_t_1 = __pyx_t_8(__pyx_t_2);
      if (unlikely(!__pyx_t_1)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 64, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_cs, __pyx_t_1);
    __pyx_t_1 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">065</span>:         if cs in valid_options:</pre>
<pre class='cython code score-2 '>    __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_cs, __pyx_v_valid_options, Py_EQ)); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 65, __pyx_L1_error)</span>
    __pyx_t_5 = (__pyx_t_6 != 0);
    if (__pyx_t_5) {
/* … */
      goto __pyx_L6;
    }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">066</span>:             env_override.append(cs)</pre>
<pre class='cython code score-2 '>      __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_env_override, __pyx_v_cs);<span class='error_goto'> if (unlikely(__pyx_t_9 == ((int)-1))) __PYX_ERR(0, 66, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">067</span>:         else:</pre>
<pre class="cython line score-47" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">068</span>:             log.warn("invalid colorspace override for %s: %s (only supports: %s)", in_cs, cs, valid_options)</pre>
<pre class='cython code score-47 '>    /*else*/ {
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 68, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_warn);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 68, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = NULL;
      __pyx_t_10 = 0;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_4))) {
        __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_4);
        if (likely(__pyx_t_3)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_4);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_4, function);
          __pyx_t_10 = 1;
        }
      }
      #if CYTHON_FAST_PYCALL
      if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[5] = {__pyx_t_3, __pyx_kp_u_invalid_colorspace_override_for, __pyx_v_in_cs, __pyx_v_cs, __pyx_v_valid_options};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      #if CYTHON_FAST_PYCCALL
      if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_4)) {
        PyObject *__pyx_temp[5] = {__pyx_t_3, __pyx_kp_u_invalid_colorspace_override_for, __pyx_v_in_cs, __pyx_v_cs, __pyx_v_valid_options};
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_4, __pyx_temp+1-__pyx_t_10, 4+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)</span>
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else
      #endif
      {
        __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 68, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
        if (__pyx_t_3) {
          <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_3); __pyx_t_3 = NULL;
        }
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_colorspace_override_for);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_colorspace_override_for);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_10, __pyx_kp_u_invalid_colorspace_override_for);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_in_cs);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_in_cs);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_10, __pyx_v_in_cs);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_cs);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_cs);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_10, __pyx_v_cs);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_valid_options);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_valid_options);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 3+__pyx_t_10, __pyx_v_valid_options);
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 68, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    }
    __pyx_L6:;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">069</span>:     log("environment override for %s: %s", in_cs, env_override)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = NULL;
  __pyx_t_10 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_4 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_4)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_10 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_kp_u_environment_override_for_s_s, __pyx_v_in_cs, __pyx_v_env_override};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[4] = {__pyx_t_4, __pyx_kp_u_environment_override_for_s_s, __pyx_v_in_cs, __pyx_v_env_override};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_10, 3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  } else
  #endif
  {
    __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
    if (__pyx_t_4) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_4); __pyx_t_4 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_environment_override_for_s_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_environment_override_for_s_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0+__pyx_t_10, __pyx_kp_u_environment_override_for_s_s);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_in_cs);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_in_cs);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1+__pyx_t_10, __pyx_v_in_cs);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_env_override);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_env_override);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 2+__pyx_t_10, __pyx_v_env_override);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 69, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">070</span>:     return env_override</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_env_override);
  __pyx_r = __pyx_v_env_override;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">071</span>: COLORSPACES = {</pre>
<pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">072</span>:                "BGRX"       : get_CS("BGRX",    ["YUV420P"]),</pre>
<pre class='cython code score-29 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(9);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV420P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV420P);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_n_u_YUV420P);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_BGRX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_BGRX);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_BGRX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_BGRX, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">073</span>:                "RGBX"       : get_CS("RGBX",    ["YUV420P"]),</pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 73, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 73, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV420P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV420P);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_YUV420P);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 73, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_RGBX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_RGBX);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_n_u_RGBX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 73, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_RGBX, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">074</span>:                "BGR"        : get_CS("BGR",     ["YUV420P"]),</pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV420P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV420P);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_n_u_YUV420P);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_BGR);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_BGR);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_n_u_BGR);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 74, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_BGR, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">075</span>:                "RGB"        : get_CS("RGB",     ["YUV420P"]),</pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV420P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV420P);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_n_u_YUV420P);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_RGB);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_RGB);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_RGB);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 75, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_RGB, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">076</span>:                "YUV420P"    : get_CS("YUV420P", ["RGB", "BGR", "RGBX", "BGRX"]),</pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 76, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_RGB);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_RGB);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_RGB);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_BGR);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_BGR);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 1, __pyx_n_u_BGR);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_RGBX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_RGBX);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 2, __pyx_n_u_RGBX);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_BGRX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_BGRX);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 3, __pyx_n_u_BGRX);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 76, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV420P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV420P);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_n_u_YUV420P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 76, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_YUV420P, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">077</span>:                "GBRP"       : get_CS("GBRP",    ["RGBX", "BGRX"]),</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_RGBX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_RGBX);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_n_u_RGBX);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_BGRX);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_BGRX);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 1, __pyx_n_u_BGRX);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_GBRP);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_GBRP);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_n_u_GBRP);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 77, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_GBRP, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">078</span>:                "r210"       : get_CS("r210",    ["YUV420P", "BGR48", "YUV444P10"]),</pre>
<pre class='cython code score-31 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_11, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  __pyx_t_8 = <span class='py_c_api'>PyList_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV420P);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV420P);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 0, __pyx_n_u_YUV420P);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_BGR48);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_BGR48);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 1, __pyx_n_u_BGR48);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV444P10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV444P10);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_8, 2, __pyx_n_u_YUV444P10);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_r210);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_r210);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_r210);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_8);
  __pyx_t_8 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_11, __pyx_t_1, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 78, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_r210, __pyx_t_8) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
</pre><pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">079</span>:                "YUV444P10"  : get_CS("YUV444P10", ["r210"]),</pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_8, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_r210);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_r210);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_u_r210);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_YUV444P10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_YUV444P10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_n_u_YUV444P10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 1, __pyx_t_1);
  __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 79, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_YUV444P10, __pyx_t_1) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-33" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">080</span>:                "GBRP10"     : get_CS("GBRP10",  ["r210", ]),</pre>
<pre class='cython code score-33 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_get_CS);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_11 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_r210);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_r210);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_11, 0, __pyx_n_u_r210);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_GBRP10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_GBRP10);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_n_u_GBRP10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_11);
  __pyx_t_11 = 0;
  __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 80, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_2, __pyx_n_u_GBRP10, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 72, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_COLORSPACES, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 71, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">081</span>:                }</pre>
<pre class="cython line score-0">&#xA0;<span class="">082</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">083</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">084</span>: def init_module():</pre>
<pre class='cython code score-14 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_3init_module(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_3init_module = {"init_module", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_3init_module, METH_NOARGS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_3init_module(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_module (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_2init_module(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_2init_module(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_module", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.init_module", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_3init_module, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_init_module, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 84, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_codeobj__20 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_init_module, 84, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__20)) __PYX_ERR(0, 84, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">085</span>:     #nothing to do!</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">086</span>:     log("csc_cython.init_module()")</pre>
<pre class='cython code score-17 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_kp_u_csc_cython_init_module) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_kp_u_csc_cython_init_module);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 86, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">087</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">088</span>: def cleanup_module():</pre>
<pre class='cython code score-14 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_5cleanup_module(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_5cleanup_module = {"cleanup_module", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_5cleanup_module, METH_NOARGS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_5cleanup_module(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cleanup_module (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_4cleanup_module(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_4cleanup_module(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("cleanup_module", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.cleanup_module", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_5cleanup_module, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_cleanup_module, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 88, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_codeobj__21 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_cleanup_module, 88, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__21)) __PYX_ERR(0, 88, __pyx_L1_error)</span>
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">089</span>:     log("csc_cython.cleanup_module()")</pre>
<pre class='cython code score-17 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_kp_u_csc_cython_cleanup_module) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_kp_u_csc_cython_cleanup_module);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 89, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">090</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">091</span>: def get_type():</pre>
<pre class='cython code score-8 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_7get_type(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_7get_type = {"get_type", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_7get_type, METH_NOARGS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_7get_type(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_type (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_6get_type(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_6get_type(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_type", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_7get_type, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_type, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 91, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_codeobj__22 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_get_type, 91, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__22)) __PYX_ERR(0, 91, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">092</span>:     return "cython"</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_cython);
  __pyx_r = __pyx_n_u_cython;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">093</span>: </pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">094</span>: def get_version():</pre>
<pre class='cython code score-8 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_9get_version(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_9get_version = {"get_version", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_9get_version, METH_NOARGS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_9get_version(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_version (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_8get_version(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_8get_version(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_version", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_9get_version, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_version, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 94, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_codeobj__23 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_get_version, 94, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__23)) __PYX_ERR(0, 94, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">095</span>:     return (4, 2)</pre>
<pre class='cython code score-7 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_tuple__2);
  __pyx_r = __pyx_tuple__2;
  goto __pyx_L0;
/* … */
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) __PYX_ERR(0, 95, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class="cython line score-0">&#xA0;<span class="">096</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">097</span>: def get_info():</pre>
<pre class='cython code score-17 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_11get_info(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_11get_info = {"get_info", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_11get_info, METH_NOARGS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_11get_info(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_info (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_10get_info(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_10get_info(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_v_info = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_info", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.get_info", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_info);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__24 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_info);<span class='error_goto'> if (unlikely(!__pyx_tuple__24)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__24);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__24);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_11get_info, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_info, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 97, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__25 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__24, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_get_info, 97, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__25)) __PYX_ERR(0, 97, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">098</span>:     info = {</pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">099</span>:             "version"   : (4, 1),</pre>
<pre class='cython code score-12 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_version, __pyx_tuple__3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 99, __pyx_L1_error)</span>
  __pyx_v_info = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
/* … */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_4, __pyx_int_1);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) __PYX_ERR(0, 99, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
</pre><pre class="cython line score-0">&#xA0;<span class="">100</span>:             }</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">101</span>:     return info</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_info);
  __pyx_r = __pyx_v_info;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">102</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">103</span>: def get_input_colorspaces():</pre>
<pre class='cython code score-13 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_13get_input_colorspaces(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_13get_input_colorspaces = {"get_input_colorspaces", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_13get_input_colorspaces, METH_NOARGS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_13get_input_colorspaces(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_input_colorspaces (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_12get_input_colorspaces(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_12get_input_colorspaces(CYTHON_UNUSED PyObject *__pyx_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_input_colorspaces", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.get_input_colorspaces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_13get_input_colorspaces, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_input_colorspaces, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 103, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
/* … */
  __pyx_codeobj__26 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_get_input_colorspaces, 103, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__26)) __PYX_ERR(0, 103, __pyx_L1_error)</span>
</pre><pre class="cython line score-22" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">104</span>:     return COLORSPACES.keys()</pre>
<pre class='cython code score-22 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_COLORSPACES);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_keys);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 104, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">105</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">106</span>: def get_output_colorspaces(input_colorspace):</pre>
<pre class='cython code score-17 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_15get_output_colorspaces(PyObject *__pyx_self, PyObject *__pyx_v_input_colorspace); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_15get_output_colorspaces = {"get_output_colorspaces", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_15get_output_colorspaces, METH_O, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_15get_output_colorspaces(PyObject *__pyx_self, PyObject *__pyx_v_input_colorspace) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_output_colorspaces (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_14get_output_colorspaces(__pyx_self, ((PyObject *)__pyx_v_input_colorspace));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_14get_output_colorspaces(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_input_colorspace) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_output_colorspaces", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.get_output_colorspaces", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_input_colorspace);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_15get_output_colorspaces, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_output_colorspaces, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 106, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__28 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_get_output_colorspaces, 106, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__28)) __PYX_ERR(0, 106, __pyx_L1_error)</span>
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">107</span>:     return COLORSPACES[input_colorspace]</pre>
<pre class='cython code score-6 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_COLORSPACES);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetItem</span>(__pyx_t_1, __pyx_v_input_colorspace);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 107, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">108</span>: </pre>
<pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">109</span>: def get_spec(in_colorspace, out_colorspace):</pre>
<pre class='cython code score-45 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_17get_spec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_17get_spec = {"get_spec", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_17get_spec, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_17get_spec(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_in_colorspace = 0;
  PyObject *__pyx_v_out_colorspace = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_spec (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_in_colorspace,&amp;__pyx_n_s_out_colorspace,0};
    PyObject* values[2] = {0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_in_colorspace)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_out_colorspace)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_spec", 1, 2, 2, 1); <span class='error_goto'>__PYX_ERR(0, 109, __pyx_L3_error)</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "get_spec") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 109, __pyx_L3_error)</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 2) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
    }
    __pyx_v_in_colorspace = values[0];
    __pyx_v_out_colorspace = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("get_spec", 1, 2, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 109, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.get_spec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_16get_spec(__pyx_self, __pyx_v_in_colorspace, __pyx_v_out_colorspace);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_16get_spec(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_in_colorspace, PyObject *__pyx_v_out_colorspace) {
  int __pyx_v_can_scale;
  long __pyx_v_width_mask;
  long __pyx_v_height_mask;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_spec", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.get_spec", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(5, __pyx_n_s_in_colorspace, __pyx_n_s_out_colorspace, __pyx_n_s_can_scale, __pyx_n_s_width_mask, __pyx_n_s_height_mask);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
/* … */
  __pyx_t_2 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_17get_spec, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_get_spec, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 109, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 5, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_get_spec, 109, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) __PYX_ERR(0, 109, __pyx_L1_error)</span>
</pre><pre class="cython line score-72" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">110</span>:     assert in_colorspace in COLORSPACES, "invalid input colorspace: %s (must be one of %s)" % (in_colorspace, get_input_colorspaces())</pre>
<pre class='cython code score-72 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_COLORSPACES);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_in_colorspace, __pyx_t_1, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!(__pyx_t_2 != 0))) {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_3 = 0;
      __pyx_t_4 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_input_colorspace);
      __pyx_t_3 += 26;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_input_colorspace);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_invalid_input_colorspace);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_in_colorspace), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_4;
      __pyx_t_3 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_one_of);
      __pyx_t_3 += 17;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_one_of);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_must_be_one_of);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_6, __pyx_n_s_get_input_colorspaces);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
        }
      }
      __pyx_t_5 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_5), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) &gt; __pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) : __pyx_t_4;
      __pyx_t_3 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_6);
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_3 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u__4);
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 110, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='error_goto'>__PYX_ERR(0, 110, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-87" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">111</span>:     assert out_colorspace in COLORSPACES.get(in_colorspace), "invalid output colorspace: %s (must be one of %s)" % (out_colorspace, get_output_colorspaces(in_colorspace))</pre>
<pre class='cython code score-87 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_COLORSPACES);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_get);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_6 = (__pyx_t_1) ? __Pyx_PyObject_Call2Args(__pyx_t_5, __pyx_t_1, __pyx_v_in_colorspace) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_v_in_colorspace);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_6)) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_v_out_colorspace, __pyx_t_6, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!(__pyx_t_2 != 0))) {
      __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_3 = 0;
      __pyx_t_4 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_output_colorspace);
      __pyx_t_3 += 27;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_output_colorspace);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_kp_u_invalid_output_colorspace);
      __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_out_colorspace), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_4;
      __pyx_t_3 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_t_5);
      __pyx_t_5 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_one_of);
      __pyx_t_3 += 17;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_one_of);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_kp_u_must_be_one_of);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_get_output_colorspaces);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
        }
      }
      __pyx_t_5 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_7, __pyx_v_in_colorspace) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_v_in_colorspace);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_5), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_4) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_4;
      __pyx_t_3 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_3 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_kp_u__4);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_6, 5, __pyx_t_3, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 111, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 111, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">112</span>:     can_scale = True</pre>
<pre class='cython code score-0 '>  __pyx_v_can_scale = 1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">113</span>:     width_mask = height_mask = 0xFFFF</pre>
<pre class='cython code score-0 '>  __pyx_v_width_mask = 0xFFFF;
  __pyx_v_height_mask = 0xFFFF;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">114</span>:     if in_colorspace=="r210" or out_colorspace=="r210":</pre>
<pre class='cython code score-4 '>  __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_in_colorspace, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  if (!__pyx_t_8) {
  } else {
    __pyx_t_2 = __pyx_t_8;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_8 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_out_colorspace, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 114, __pyx_L1_error)</span>
  __pyx_t_2 = __pyx_t_8;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_2) {
/* … */
    goto __pyx_L3;
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">115</span>:         can_scale = False</pre>
<pre class='cython code score-0 '>    __pyx_v_can_scale = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">116</span>:     elif in_colorspace=="GBRP10":</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_in_colorspace, __pyx_n_u_GBRP10, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 116, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/* … */
  }
  __pyx_L3:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">117</span>:         can_scale = False</pre>
<pre class='cython code score-0 '>    __pyx_v_can_scale = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">118</span>:     if in_colorspace=="YUV420P":</pre>
<pre class='cython code score-2 '>  __pyx_t_2 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_in_colorspace, __pyx_n_u_YUV420P, Py_EQ)); if (unlikely(__pyx_t_2 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 118, __pyx_L1_error)</span>
  if (__pyx_t_2) {
/* … */
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">119</span>:         #safer not to try to handle odd dimensions as input:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">120</span>:         width_mask = height_mask = 0xFFFE</pre>
<pre class='cython code score-0 '>    __pyx_v_width_mask = 0xFFFE;
    __pyx_v_height_mask = 0xFFFE;
</pre><pre class="cython line score-0">&#xA0;<span class="">121</span>:     #low score as this should be used as fallback only:</pre>
<pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">122</span>:     return csc_spec(in_colorspace, out_colorspace,</pre>
<pre class='cython code score-19 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_csc_spec);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_in_colorspace);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_in_colorspace);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_v_in_colorspace);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out_colorspace);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_out_colorspace);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_v_out_colorspace);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(((PyObject *)__pyx_ptype_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter));
  <span class='refnanny'>__Pyx_GIVEREF</span>(((PyObject *)__pyx_ptype_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter));
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, ((PyObject *)__pyx_ptype_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter));
/* … */
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 122, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_r = __pyx_t_7;
  __pyx_t_7 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-61" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">123</span>:                     ColorspaceConverter, codec_type=get_type(),</pre>
<pre class='cython code score-61 '>  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(11);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_9, __pyx_n_s_get_type);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
    __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
    if (likely(__pyx_t_10)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
    }
  }
  __pyx_t_7 = (__pyx_t_10) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_10) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_codec_type, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_quality, __pyx_int_50) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_speed, __pyx_int_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_setup_cost, __pyx_int_10) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_min_w, __pyx_int_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_min_h, __pyx_int_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_max_w, __pyx_int_16384) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_max_h, __pyx_int_16384) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
</pre><pre class="cython line score-0">&#xA0;<span class="">124</span>:                     quality=50, speed=10, setup_cost=10, min_w=2, min_h=2,</pre>
<pre class="cython line score-0">&#xA0;<span class="">125</span>:                     max_w=16*1024, max_h=16*1024,</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">126</span>:                     can_scale=can_scale,</pre>
<pre class='cython code score-8 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_v_can_scale);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 126, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_can_scale, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">127</span>:                     width_mask=width_mask, height_mask=height_mask)</pre>
<pre class='cython code score-16 '>  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_width_mask);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_width_mask, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_height_mask);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 127, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_height_mask, __pyx_t_7) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 123, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">128</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">129</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">130</span>: class CythonImageWrapper(ImageWrapper):</pre>
<pre class='cython code score-27 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_ImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_11 = <span class='py_c_api'>PyTuple_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_11, 0, __pyx_t_2);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CalculateMetaclass</span>(NULL, __pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_8 = __Pyx_Py3MetaclassPrepare(__pyx_t_2, __pyx_t_11, __pyx_n_s_CythonImageWrapper, __pyx_n_s_CythonImageWrapper, (PyObject *) NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2, (PyObject *) NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
/* … */
  __pyx_t_9 = __Pyx_Py3ClassCreate(__pyx_t_2, __pyx_n_s_CythonImageWrapper, __pyx_t_11, __pyx_t_8, NULL, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_CyFunction_InitClassCell</span>(__pyx_t_1, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_CythonImageWrapper, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 130, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">131</span>: </pre>
<pre class="cython line score-27" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">132</span>:     def free(self):</pre>
<pre class='cython code score-27 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_1free(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_1free = {"free", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_1free, METH_O, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_1free(PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("free (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_free(__pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_free(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_v_cb = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("free", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.CythonImageWrapper.free", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_cb);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_n_s_self, __pyx_n_s_cb);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
/* … */
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_1free, 0, __pyx_n_s_CythonImageWrapper_free, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2, __pyx_d, ((PyObject *)__pyx_codeobj__32));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
  <span class='py_c_api'>PyList_Append</span>(__pyx_t_1, __pyx_t_9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_8, __pyx_n_s_free, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 132, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 2, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_free, 132, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) __PYX_ERR(0, 132, __pyx_L1_error)</span>
</pre><pre class="cython line score-53" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">133</span>:         log("CythonImageWrapper.free() cython_buffer=%#x", &lt;uintptr_t&gt; self.cython_buffer)</pre>
<pre class='cython code score-53 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_cython_buffer);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_t_3); if (unlikely((__pyx_t_4 == ((uintptr_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(((uintptr_t)__pyx_t_4));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_kp_u_CythonImageWrapper_free_cython_b, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[3] = {__pyx_t_5, __pyx_kp_u_CythonImageWrapper_free_cython_b, __pyx_t_3};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_CythonImageWrapper_free_cython_b);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_CythonImageWrapper_free_cython_b);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_kp_u_CythonImageWrapper_free_cython_b);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_t_3);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 133, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-39" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">134</span>:         super().free()</pre>
<pre class='cython code score-39 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_GetClassObj</span>(__pyx_self);
  if (!__pyx_t_2) { <span class='py_c_api'>PyErr_SetString</span>(PyExc_SystemError, "super(): empty __class__ cell"); <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span> }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_v_self);
  __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_builtin_super, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_free);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 134, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">135</span>:         cb = self.cython_buffer</pre>
<pre class='cython code score-2 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_self, __pyx_n_s_cython_buffer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 135, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_cb = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">136</span>:         if cb&gt;0:</pre>
<pre class='cython code score-8 '>  __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_v_cb, __pyx_int_0, Py_GT); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 136, __pyx_L1_error)</span>
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_8 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 136, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_8) {
/* … */
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">137</span>:             self.cython_buffer = 0</pre>
<pre class='cython code score-2 '>    if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_self, __pyx_n_s_cython_buffer, __pyx_int_0) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 137, __pyx_L1_error)</span>
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">138</span>:             free(&lt;void *&gt; (&lt;uintptr_t&gt; cb))</pre>
<pre class='cython code score-7 '>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_v_cb); if (unlikely((__pyx_t_4 == ((uintptr_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 138, __pyx_L1_error)</span>
    free(((void *)((uintptr_t)__pyx_t_4)));
</pre><pre class="cython line score-0">&#xA0;<span class="">139</span>: </pre>
<pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">140</span>:     def _cn(self):</pre>
<pre class='cython code score-12 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_3_cn(PyObject *__pyx_self, PyObject *__pyx_v_self); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_3_cn = {"_cn", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_3_cn, METH_O, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_3_cn(PyObject *__pyx_self, PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cn (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_2_cn(__pyx_self, ((PyObject *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_2_cn(CYTHON_UNUSED PyObject *__pyx_self, CYTHON_UNUSED PyObject *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("_cn", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_self);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
/* … */
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_18CythonImageWrapper_3_cn, 0, __pyx_n_s_CythonImageWrapper__cn, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2, __pyx_d, ((PyObject *)__pyx_codeobj__34));<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  if (<span class='pyx_c_api'>__Pyx_SetNameInClass</span>(__pyx_t_8, __pyx_n_s_cn, __pyx_t_9) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 140, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  __pyx_codeobj__34 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_cn, 140, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__34)) __PYX_ERR(0, 140, __pyx_L1_error)</span>
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">141</span>:         return "CythonImageWrapper"</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_CythonImageWrapper);
  __pyx_r = __pyx_n_u_CythonImageWrapper;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">142</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">143</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">144</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">145</span>: DEF STRIDE_ROUNDUP = 2</pre>
<pre class="cython line score-0">&#xA0;<span class="">146</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">147</span>: #Pre-calculate some coefficients and define them as constants</pre>
<pre class="cython line score-0">&#xA0;<span class="">148</span>: #We use integer calculations so everything is multipled by 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">149</span>: #To get the result as a byte, we just bitshift:</pre>
<pre class="cython line score-0">&#xA0;<span class="">150</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">151</span>: #RGB to YUV</pre>
<pre class="cython line score-0">&#xA0;<span class="">152</span>: # Y = 0.299 * R + 0.587 * G + 0.114 * B</pre>
<pre class="cython line score-0">&#xA0;<span class="">153</span>: DEF YR = 19595      # 0.299 * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">154</span>: DEF YG = 38470      # 0.587 * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">155</span>: DEF YB = 7471       # 0.114 * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">156</span>: DEF Yc = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">157</span>: DEF YC = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">158</span>: # U = -0.169 * R - 0.331 * G + 0.500 * B</pre>
<pre class="cython line score-0">&#xA0;<span class="">159</span>: DEF UR = -11076     #-0.169 * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">160</span>: DEF UG = -21692     #-0.331 * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">161</span>: DEF UB = 32768      # 0.500 * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">162</span>: DEF Uc = 128</pre>
<pre class="cython line score-0">&#xA0;<span class="">163</span>: DEF UC = 8388608</pre>
<pre class="cython line score-0">&#xA0;<span class="">164</span>: # V = 0.500 * R - 0.419 * G - 0.081 * B</pre>
<pre class="cython line score-0">&#xA0;<span class="">165</span>: DEF VR = 32768      # 0.500  * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">166</span>: DEF VG = -27460     #-0.419 * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">167</span>: DEF VB = -5308      #-0.081  * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">168</span>: DEF Vc = 128</pre>
<pre class="cython line score-0">&#xA0;<span class="">169</span>: DEF VC = 8388608</pre>
<pre class="cython line score-0">&#xA0;<span class="">170</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">171</span>: DEF MAX_CLAMP = 16777216    #2**(16+8)</pre>
<pre class="cython line score-0">&#xA0;<span class="">172</span>: DEF MAX_CLAMP10 = 67108864  #2**(16+10)</pre>
<pre class="cython line score-0">&#xA0;<span class="">173</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">174</span>: #YUV to RGB:</pre>
<pre class="cython line score-0">&#xA0;<span class="">175</span>: #Y, Cb and Cr are adjusted as:</pre>
<pre class="cython line score-0">&#xA0;<span class="">176</span>: #Y'  = Y - 16</pre>
<pre class="cython line score-0">&#xA0;<span class="">177</span>: #Cb' = Cb - 128</pre>
<pre class="cython line score-0">&#xA0;<span class="">178</span>: #Cr' = Cr - 128</pre>
<pre class="cython line score-0">&#xA0;<span class="">179</span>: # (see YC, UC and VC above)</pre>
<pre class="cython line score-0">&#xA0;<span class="">180</span>: #RGB:</pre>
<pre class="cython line score-0">&#xA0;<span class="">181</span>: #R = 1*Y'                 + 1.403 * Cr'</pre>
<pre class="cython line score-0">&#xA0;<span class="">182</span>: #G = 1*Y' - 0.344   * Cb' - 0.714   * Cr'</pre>
<pre class="cython line score-0">&#xA0;<span class="">183</span>: #B = 1*Y' + 1.770   * Cb'</pre>
<pre class="cython line score-0">&#xA0;<span class="">184</span>: DEF RY = 65536      #1        * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">185</span>: DEF RU = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">186</span>: DEF RV = 91947      #1.403    * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">187</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">188</span>: DEF GY = 65536      #1        * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">189</span>: DEF GU = -22544     #-0.344   * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">190</span>: DEF GV = -46793     #-0.714   * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">191</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">192</span>: DEF BY = 65536      #1        * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">193</span>: DEF BU = 115999     #1.77     * 2**16</pre>
<pre class="cython line score-0">&#xA0;<span class="">194</span>: DEF BV = 0</pre>
<pre class="cython line score-0">&#xA0;<span class="">195</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">196</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">197</span>: cdef inline unsigned char clamp(const long v) nogil:</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE unsigned char __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp(long const __pyx_v_v) {
  unsigned char __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">198</span>:     if v&lt;=0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_v &lt;= 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">199</span>:         return 0</pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">200</span>:     #v += 2**15</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">201</span>:     if v&gt;=MAX_CLAMP:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_v &gt;= 0x1000000) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">202</span>:         return 0xff         #2**8-1</pre>
<pre class='cython code score-0 '>    __pyx_r = 0xff;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">203</span>:     return &lt;unsigned char&gt; (v&gt;&gt;16)</pre>
<pre class='cython code score-0 '>  __pyx_r = ((unsigned char)(__pyx_v_v &gt;&gt; 16));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">204</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">205</span>: cdef inline unsigned short clamp10(const long v) nogil:</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE unsigned short __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp10(long const __pyx_v_v) {
  unsigned short __pyx_r;
/* … */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">206</span>:     if v&lt;=0:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_v &lt;= 0) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">207</span>:         return 0</pre>
<pre class='cython code score-0 '>    __pyx_r = 0;
    goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">208</span>:     #v += 2**15</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">209</span>:     if v&gt;=MAX_CLAMP10:</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = ((__pyx_v_v &gt;= 0x4000000) != 0);
  if (__pyx_t_1) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">210</span>:         return 0x3ff        #2**10-1</pre>
<pre class='cython code score-0 '>    __pyx_r = 0x3ff;
    goto __pyx_L0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">211</span>:     return &lt;unsigned short&gt; (v&gt;&gt;16)</pre>
<pre class='cython code score-0 '>  __pyx_r = ((unsigned short)(__pyx_v_v &gt;&gt; 16));
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">212</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">213</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">214</span>: cdef inline void r210_to_BGR48_copy(unsigned short *bgr48, const unsigned int *r210,</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE void __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_r210_to_BGR48_copy(unsigned short *__pyx_v_bgr48, unsigned int const *__pyx_v_r210, unsigned int __pyx_v_w, unsigned int __pyx_v_h, unsigned int __pyx_v_src_stride, unsigned int __pyx_v_dst_stride) {
  unsigned int __pyx_v_y;
  unsigned int __pyx_v_i;
  unsigned int __pyx_v_v;
  unsigned int __pyx_v_x;
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">215</span>:                                     unsigned int w, unsigned int h,</pre>
<pre class="cython line score-0">&#xA0;<span class="">216</span>:                                     unsigned int src_stride, unsigned int dst_stride) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">217</span>:     cdef unsigned int y</pre>
<pre class="cython line score-0">&#xA0;<span class="">218</span>:     cdef unsigned int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">219</span>:     cdef unsigned int v</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">220</span>:     for y in range(h):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_h;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_y = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">221</span>:         i = y*dst_stride//2</pre>
<pre class='cython code score-0 '>    __pyx_v_i = ((__pyx_v_y * __pyx_v_dst_stride) / 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">222</span>:         for x in range(w):</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_w;
    __pyx_t_5 = __pyx_t_4;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_x = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">223</span>:             v = r210[x]</pre>
<pre class='cython code score-0 '>      __pyx_v_v = (__pyx_v_r210[__pyx_v_x]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">224</span>:             bgr48[i] = v&amp;0x000003ff</pre>
<pre class='cython code score-0 '>      (__pyx_v_bgr48[__pyx_v_i]) = (__pyx_v_v &amp; 0x000003ff);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">225</span>:             bgr48[i+1] = (v&amp;0x000ffc00) &gt;&gt; 10</pre>
<pre class='cython code score-0 '>      (__pyx_v_bgr48[(__pyx_v_i + 1)]) = ((__pyx_v_v &amp; 0x000ffc00) &gt;&gt; 10);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">226</span>:             bgr48[i+2] = (v&amp;0x3ff00000) &gt;&gt; 20</pre>
<pre class='cython code score-0 '>      (__pyx_v_bgr48[(__pyx_v_i + 2)]) = ((__pyx_v_v &amp; 0x3ff00000) &gt;&gt; 20);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">227</span>:             i += 3</pre>
<pre class='cython code score-0 '>      __pyx_v_i = (__pyx_v_i + 3);
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">228</span>:         r210 = &lt;unsigned int*&gt; ((&lt;uintptr_t&gt; r210) + src_stride)</pre>
<pre class='cython code score-0 '>    __pyx_v_r210 = ((unsigned int *)(((uintptr_t)__pyx_v_r210) + __pyx_v_src_stride));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">229</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">230</span>: cdef inline void gbrp10_to_r210_copy(uintptr_t r210, uintptr_t[3] gbrp10,</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE void __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_gbrp10_to_r210_copy(uintptr_t __pyx_v_r210, uintptr_t *__pyx_v_gbrp10, unsigned int __pyx_v_width, unsigned int __pyx_v_height, unsigned int __pyx_v_src_stride, unsigned int __pyx_v_dst_stride) {
  unsigned int __pyx_v_x;
  unsigned int __pyx_v_y;
  unsigned short *__pyx_v_b;
  unsigned short *__pyx_v_g;
  unsigned short *__pyx_v_r;
  unsigned int *__pyx_v_dst;
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">231</span>:                                      unsigned int width, unsigned int height,</pre>
<pre class="cython line score-0">&#xA0;<span class="">232</span>:                                      unsigned int src_stride, unsigned int dst_stride) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">233</span>:     cdef unsigned int x, y</pre>
<pre class="cython line score-0">&#xA0;<span class="">234</span>:     cdef unsigned short *b</pre>
<pre class="cython line score-0">&#xA0;<span class="">235</span>:     cdef unsigned short *g</pre>
<pre class="cython line score-0">&#xA0;<span class="">236</span>:     cdef unsigned short *r</pre>
<pre class="cython line score-0">&#xA0;<span class="">237</span>:     cdef unsigned int *dst</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">238</span>:     for y in range(height):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_height;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_y = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">239</span>:         dst = &lt;unsigned int*&gt; (r210 + y*dst_stride)</pre>
<pre class='cython code score-0 '>    __pyx_v_dst = ((unsigned int *)(__pyx_v_r210 + (__pyx_v_y * __pyx_v_dst_stride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">240</span>:         g = &lt;unsigned short*&gt; ((&lt;uintptr_t&gt; gbrp10[0]) + y*src_stride)</pre>
<pre class='cython code score-0 '>    __pyx_v_g = ((unsigned short *)(((uintptr_t)(__pyx_v_gbrp10[0])) + (__pyx_v_y * __pyx_v_src_stride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">241</span>:         b = &lt;unsigned short*&gt; ((&lt;uintptr_t&gt; gbrp10[1]) + y*src_stride)</pre>
<pre class='cython code score-0 '>    __pyx_v_b = ((unsigned short *)(((uintptr_t)(__pyx_v_gbrp10[1])) + (__pyx_v_y * __pyx_v_src_stride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">242</span>:         r = &lt;unsigned short*&gt; ((&lt;uintptr_t&gt; gbrp10[2]) + y*src_stride)</pre>
<pre class='cython code score-0 '>    __pyx_v_r = ((unsigned short *)(((uintptr_t)(__pyx_v_gbrp10[2])) + (__pyx_v_y * __pyx_v_src_stride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">243</span>:         for x in range(width):</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_width;
    __pyx_t_5 = __pyx_t_4;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_x = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">244</span>:             dst[x] = (b[x] &amp; 0x3ff) + ((g[x] &amp; 0x3ff)&lt;&lt;10) + ((r[x] &amp; 0x3ff)&lt;&lt;20)</pre>
<pre class='cython code score-0 '>      (__pyx_v_dst[__pyx_v_x]) = ((((__pyx_v_b[__pyx_v_x]) &amp; 0x3ff) + (((__pyx_v_g[__pyx_v_x]) &amp; 0x3ff) &lt;&lt; 10)) + (((__pyx_v_r[__pyx_v_x]) &amp; 0x3ff) &lt;&lt; 20));
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">245</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">246</span>: cdef inline void r210_to_YUV444P10_copy(unsigned short *Y, unsigned short *U, unsigned short *V, uintptr_t r210data,</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE void __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_r210_to_YUV444P10_copy(unsigned short *__pyx_v_Y, unsigned short *__pyx_v_U, unsigned short *__pyx_v_V, uintptr_t __pyx_v_r210data, unsigned int __pyx_v_width, unsigned int __pyx_v_height, unsigned int __pyx_v_Ystride, unsigned int __pyx_v_Ustride, unsigned int __pyx_v_Vstride, unsigned int __pyx_v_r210_stride) {
  unsigned int const *__pyx_v_r210_row;
  unsigned int __pyx_v_r210;
  unsigned int __pyx_v_R;
  unsigned int __pyx_v_G;
  unsigned int __pyx_v_B;
  unsigned int __pyx_v_x;
  unsigned int __pyx_v_y;
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">247</span>:                                         unsigned int width, unsigned int height,</pre>
<pre class="cython line score-0">&#xA0;<span class="">248</span>:                                         unsigned int Ystride, unsigned int Ustride, unsigned int Vstride,</pre>
<pre class="cython line score-0">&#xA0;<span class="">249</span>:                                         unsigned int r210_stride) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">250</span>:     cdef const unsigned int *r210_row</pre>
<pre class="cython line score-0">&#xA0;<span class="">251</span>:     cdef unsigned int r210</pre>
<pre class="cython line score-0">&#xA0;<span class="">252</span>:     cdef unsigned int R, G, B</pre>
<pre class="cython line score-0">&#xA0;<span class="">253</span>:     cdef unsigned int x, y</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">254</span>:     for y in range(height):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_height;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_y = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">255</span>:         r210_row = &lt;unsigned int*&gt; (r210data + r210_stride*y)</pre>
<pre class='cython code score-0 '>    __pyx_v_r210_row = ((unsigned int *)(__pyx_v_r210data + (__pyx_v_r210_stride * __pyx_v_y)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">256</span>:         for x in range(width):</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_width;
    __pyx_t_5 = __pyx_t_4;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_x = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">257</span>:             r210 = r210_row[x]</pre>
<pre class='cython code score-0 '>      __pyx_v_r210 = (__pyx_v_r210_row[__pyx_v_x]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">258</span>:             R = (r210&amp;0x3ff00000) &gt;&gt; 20</pre>
<pre class='cython code score-0 '>      __pyx_v_R = ((__pyx_v_r210 &amp; 0x3ff00000) &gt;&gt; 20);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">259</span>:             G = (r210&amp;0x000ffc00) &gt;&gt; 10</pre>
<pre class='cython code score-0 '>      __pyx_v_G = ((__pyx_v_r210 &amp; 0x000ffc00) &gt;&gt; 10);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">260</span>:             B = (r210&amp;0x000003ff)</pre>
<pre class='cython code score-0 '>      __pyx_v_B = (__pyx_v_r210 &amp; 0x000003ff);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">261</span>:             Y[x] = clamp10(YR * R + YG * G + YB * B + YC*4)</pre>
<pre class='cython code score-0 '>      (__pyx_v_Y[__pyx_v_x]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp10(((((0x4C8B * __pyx_v_R) + (0x9646 * __pyx_v_G)) + (0x1D2F * __pyx_v_B)) + 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">262</span>:             U[x] = clamp10(UR * R + UG * G + UB * B + UC*4)</pre>
<pre class='cython code score-0 '>      (__pyx_v_U[__pyx_v_x]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp10(((((-11076L * __pyx_v_R) + (-21692L * __pyx_v_G)) + (0x8000 * __pyx_v_B)) + 0x2000000));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">263</span>:             V[x] = clamp10(VR * R + VG * G + VB * B + VC*4)</pre>
<pre class='cython code score-0 '>      (__pyx_v_V[__pyx_v_x]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp10(((((0x8000 * __pyx_v_R) + (-27460L * __pyx_v_G)) + (-5308L * __pyx_v_B)) + 0x2000000));
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">264</span>:         Y = &lt;unsigned short *&gt; ((&lt;uintptr_t&gt; Y) + Ystride)</pre>
<pre class='cython code score-0 '>    __pyx_v_Y = ((unsigned short *)(((uintptr_t)__pyx_v_Y) + __pyx_v_Ystride));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">265</span>:         U = &lt;unsigned short *&gt; ((&lt;uintptr_t&gt; U) + Ustride)</pre>
<pre class='cython code score-0 '>    __pyx_v_U = ((unsigned short *)(((uintptr_t)__pyx_v_U) + __pyx_v_Ustride));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">266</span>:         V = &lt;unsigned short *&gt; ((&lt;uintptr_t&gt; V) + Vstride)</pre>
<pre class='cython code score-0 '>    __pyx_v_V = ((unsigned short *)(((uintptr_t)__pyx_v_V) + __pyx_v_Vstride));
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">267</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">268</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">269</span>: cdef inline void YUV444P10_to_r210_copy(uintptr_t r210data, const unsigned short *Ybuf, const unsigned short *Ubuf, const unsigned short *Vbuf,</pre>
<pre class='cython code score-0 '>static CYTHON_INLINE void __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_YUV444P10_to_r210_copy(uintptr_t __pyx_v_r210data, unsigned short const *__pyx_v_Ybuf, unsigned short const *__pyx_v_Ubuf, unsigned short const *__pyx_v_Vbuf, unsigned int __pyx_v_width, unsigned int __pyx_v_height, unsigned int __pyx_v_r210_stride, unsigned int __pyx_v_Ystride, unsigned int __pyx_v_Ustride, unsigned int __pyx_v_Vstride) {
  unsigned short *__pyx_v_Yrow;
  unsigned short *__pyx_v_Urow;
  unsigned short *__pyx_v_Vrow;
  short __pyx_v_Y;
  short __pyx_v_U;
  short __pyx_v_V;
  unsigned int *__pyx_v_r210row;
  unsigned int __pyx_v_x;
  unsigned int __pyx_v_y;
/* … */
  /* function exit code */
}
</pre><pre class="cython line score-0">&#xA0;<span class="">270</span>:                                         unsigned int width, unsigned int height,</pre>
<pre class="cython line score-0">&#xA0;<span class="">271</span>:                                         unsigned int r210_stride,</pre>
<pre class="cython line score-0">&#xA0;<span class="">272</span>:                                         unsigned int Ystride, unsigned int Ustride, unsigned int Vstride) nogil:</pre>
<pre class="cython line score-0">&#xA0;<span class="">273</span>:         cdef unsigned short *Yrow</pre>
<pre class="cython line score-0">&#xA0;<span class="">274</span>:         cdef unsigned short *Urow</pre>
<pre class="cython line score-0">&#xA0;<span class="">275</span>:         cdef unsigned short *Vrow</pre>
<pre class="cython line score-0">&#xA0;<span class="">276</span>:         cdef short Y, U, V</pre>
<pre class="cython line score-0">&#xA0;<span class="">277</span>:         cdef unsigned int *r210row</pre>
<pre class="cython line score-0">&#xA0;<span class="">278</span>:         cdef unsigned int x, y</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">279</span>:         for y in range(height):</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = __pyx_v_height;
  __pyx_t_2 = __pyx_t_1;
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_2; __pyx_t_3+=1) {
    __pyx_v_y = __pyx_t_3;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">280</span>:             Yrow = &lt;unsigned short*&gt; ((&lt;uintptr_t&gt; Ybuf) + y*Ystride)</pre>
<pre class='cython code score-0 '>    __pyx_v_Yrow = ((unsigned short *)(((uintptr_t)__pyx_v_Ybuf) + (__pyx_v_y * __pyx_v_Ystride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">281</span>:             Urow = &lt;unsigned short*&gt; ((&lt;uintptr_t&gt; Ubuf) + y*Ustride)</pre>
<pre class='cython code score-0 '>    __pyx_v_Urow = ((unsigned short *)(((uintptr_t)__pyx_v_Ubuf) + (__pyx_v_y * __pyx_v_Ustride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">282</span>:             Vrow = &lt;unsigned short*&gt; ((&lt;uintptr_t&gt; Vbuf) + y*Vstride)</pre>
<pre class='cython code score-0 '>    __pyx_v_Vrow = ((unsigned short *)(((uintptr_t)__pyx_v_Vbuf) + (__pyx_v_y * __pyx_v_Vstride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">283</span>:             r210row = &lt;unsigned int*&gt; (r210data + y*r210_stride)</pre>
<pre class='cython code score-0 '>    __pyx_v_r210row = ((unsigned int *)(__pyx_v_r210data + (__pyx_v_y * __pyx_v_r210_stride)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">284</span>:             for x in range(width):</pre>
<pre class='cython code score-0 '>    __pyx_t_4 = __pyx_v_width;
    __pyx_t_5 = __pyx_t_4;
    for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
      __pyx_v_x = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">285</span>:                 Y = (Yrow[x] &amp; 0x3ff) - Yc*4</pre>
<pre class='cython code score-0 '>      __pyx_v_Y = (((__pyx_v_Yrow[__pyx_v_x]) &amp; 0x3ff) - 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">286</span>:                 U = (Urow[x] &amp; 0x3ff) - Uc*4</pre>
<pre class='cython code score-0 '>      __pyx_v_U = (((__pyx_v_Urow[__pyx_v_x]) &amp; 0x3ff) - 0x200);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">287</span>:                 V = (Vrow[x] &amp; 0x3ff) - Vc*4</pre>
<pre class='cython code score-0 '>      __pyx_v_V = (((__pyx_v_Vrow[__pyx_v_x]) &amp; 0x3ff) - 0x200);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">288</span>:                 r210row[x] = (</pre>
<pre class='cython code score-0 '>      (__pyx_v_r210row[__pyx_v_x]) = (((__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp10((((0x10000 * __pyx_v_Y) + (0 * __pyx_v_U)) + (0x1672B * __pyx_v_V))) &lt;&lt; 20) | (__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp10((((0x10000 * __pyx_v_Y) + (-22544L * __pyx_v_U)) + (-46793L * __pyx_v_V))) &lt;&lt; 10)) | __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp10((((0x10000 * __pyx_v_Y) + (0x1C51F * __pyx_v_U)) + (0 * __pyx_v_V))));
    }
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">289</span>:                     (clamp10(RY * Y + RU * U + RV * V)&lt;&lt;20) |</pre>
<pre class="cython line score-0">&#xA0;<span class="">290</span>:                     (clamp10(GY * Y + GU * U + GV * V)&lt;&lt;10) |</pre>
<pre class="cython line score-0">&#xA0;<span class="">291</span>:                     (clamp10(BY * Y + BU * U + BV * V))</pre>
<pre class="cython line score-0">&#xA0;<span class="">292</span>:                     )</pre>
<pre class="cython line score-0">&#xA0;<span class="">293</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">294</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">295</span>: cdef class ColorspaceConverter:</pre>
<pre class='cython code score-0 '>struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter {
  PyObject_HEAD
  struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_vtab;
  unsigned int src_width;
  unsigned int src_height;
  PyObject *src_format;
  unsigned int dst_width;
  unsigned int dst_height;
  PyObject *dst_format;
  unsigned long dst_strides[3];
  unsigned long dst_sizes[3];
  unsigned long offsets[3];
  PyObject *convert_image_function;
  unsigned long frames;
  double time;
  unsigned long buffer_size;
  PyObject *__weakref__;
};
/* … */
struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter {
  PyObject *(*do_RGB_to_YUV420P)(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *, PyObject *, uint8_t const , uint8_t const , uint8_t const , uint8_t const );
  PyObject *(*planar3_image_wrapper)(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *, void *, struct __pyx_opt_args_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_planar3_image_wrapper *__pyx_optional_args);
  PyObject *(*packed_image_wrapper)(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *, char *, struct __pyx_opt_args_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_packed_image_wrapper *__pyx_optional_args);
  PyObject *(*do_YUV420P_to_RGB)(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *, PyObject *, uint8_t const , uint8_t const , uint8_t const , uint8_t const , uint8_t const );
  PyObject *(*do_RGBP_to_RGB)(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *, PyObject *, uint8_t const , uint8_t const , uint8_t const , uint8_t const , uint8_t const , uint8_t const , uint8_t const );
};
static struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_vtabptr_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter;
</pre><pre class="cython line score-0">&#xA0;<span class="">296</span>:     cdef unsigned int src_width</pre>
<pre class="cython line score-0">&#xA0;<span class="">297</span>:     cdef unsigned int src_height</pre>
<pre class="cython line score-0">&#xA0;<span class="">298</span>:     cdef object src_format</pre>
<pre class="cython line score-0">&#xA0;<span class="">299</span>:     cdef unsigned int dst_width</pre>
<pre class="cython line score-0">&#xA0;<span class="">300</span>:     cdef unsigned int dst_height</pre>
<pre class="cython line score-0">&#xA0;<span class="">301</span>:     cdef object dst_format</pre>
<pre class="cython line score-0">&#xA0;<span class="">302</span>:     cdef unsigned long[3] dst_strides</pre>
<pre class="cython line score-0">&#xA0;<span class="">303</span>:     cdef unsigned long[3] dst_sizes</pre>
<pre class="cython line score-0">&#xA0;<span class="">304</span>:     cdef unsigned long[3] offsets</pre>
<pre class="cython line score-0">&#xA0;<span class="">305</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">306</span>:     cdef convert_image_function</pre>
<pre class="cython line score-0">&#xA0;<span class="">307</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">308</span>:     cdef unsigned long frames</pre>
<pre class="cython line score-0">&#xA0;<span class="">309</span>:     cdef double time</pre>
<pre class="cython line score-0">&#xA0;<span class="">310</span>:     cdef unsigned long buffer_size</pre>
<pre class="cython line score-0">&#xA0;<span class="">311</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">312</span>:     cdef object __weakref__</pre>
<pre class="cython line score-0">&#xA0;<span class="">313</span>: </pre>
<pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">314</span>:     def init_context(self, int src_width, int src_height, src_format,</pre>
<pre class='cython code score-18 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_1init_context(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_1init_context(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  int __pyx_v_src_width;
  int __pyx_v_src_height;
  PyObject *__pyx_v_src_format = 0;
  int __pyx_v_dst_width;
  int __pyx_v_dst_height;
  PyObject *__pyx_v_dst_format = 0;
  PyObject *__pyx_v_options = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_context (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_src_width,&amp;__pyx_n_s_src_height,&amp;__pyx_n_s_src_format,&amp;__pyx_n_s_dst_width,&amp;__pyx_n_s_dst_height,&amp;__pyx_n_s_dst_format,&amp;__pyx_n_s_options,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
/* … */
  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_init_context(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, int __pyx_v_src_width, int __pyx_v_src_height, PyObject *__pyx_v_src_format, int __pyx_v_dst_width, int __pyx_v_dst_height, PyObject *__pyx_v_dst_format, PyObject *__pyx_v_options) {
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *__pyx_cur_scope;
  int __pyx_v_i;
  PyObject *__pyx_v_assert_no_scaling = 0;
  PyObject *__pyx_v_allocate_yuv = 0;
  PyObject *__pyx_v_allocate_rgb = 0;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init_context", 0);
  __pyx_cur_scope = (struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *)__pyx_tp_new_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context(__pyx_ptype_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context, __pyx_empty_tuple, NULL);
  if (unlikely(!__pyx_cur_scope)) {
    __pyx_cur_scope = ((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *)Py_None);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
    <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L1_error)</span>
  } else {
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope);
  }
  __pyx_cur_scope-&gt;__pyx_v_self = __pyx_v_self;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  <span class='refnanny'>__Pyx_GIVEREF</span>((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self);
  __pyx_cur_scope-&gt;__pyx_v_src_width = __pyx_v_src_width;
  __pyx_cur_scope-&gt;__pyx_v_src_height = __pyx_v_src_height;
  __pyx_cur_scope-&gt;__pyx_v_src_format = __pyx_v_src_format;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format);
  __pyx_cur_scope-&gt;__pyx_v_dst_width = __pyx_v_dst_width;
  __pyx_cur_scope-&gt;__pyx_v_dst_height = __pyx_v_dst_height;
  __pyx_cur_scope-&gt;__pyx_v_dst_format = __pyx_v_dst_format;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.init_context", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_assert_no_scaling);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_allocate_yuv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_allocate_rgb);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(((PyObject *)__pyx_cur_scope));
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context {
  PyObject_HEAD
  PyObject *__pyx_v_dst_format;
  int __pyx_v_dst_height;
  int __pyx_v_dst_width;
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self;
  PyObject *__pyx_v_src_format;
  int __pyx_v_src_height;
  int __pyx_v_src_width;
};


</pre><pre class="cython line score-80" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">315</span>:                            int dst_width, int dst_height, dst_format, options=None):</pre>
<pre class='cython code score-80 '>    values[6] = ((PyObject *)Py_None);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        CYTHON_FALLTHROUGH;
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        CYTHON_FALLTHROUGH;
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        CYTHON_FALLTHROUGH;
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        CYTHON_FALLTHROUGH;
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_src_width)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        CYTHON_FALLTHROUGH;
        case  1:
        if (likely((values[1] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_src_height)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_context", 0, 6, 7, 1); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  2:
        if (likely((values[2] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_src_format)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_context", 0, 6, 7, 2); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  3:
        if (likely((values[3] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dst_width)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_context", 0, 6, 7, 3); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  4:
        if (likely((values[4] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dst_height)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_context", 0, 6, 7, 4); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  5:
        if (likely((values[5] = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_dst_format)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_context", 0, 6, 7, 5); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
        }
        CYTHON_FALLTHROUGH;
        case  6:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_options);
          if (value) { values[6] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "init_context") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        CYTHON_FALLTHROUGH;
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_src_width = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[0]); if (unlikely((__pyx_v_src_width == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
    __pyx_v_src_height = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[1]); if (unlikely((__pyx_v_src_height == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
    __pyx_v_src_format = values[2];
    __pyx_v_dst_width = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[3]); if (unlikely((__pyx_v_dst_width == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L3_error)</span>
    __pyx_v_dst_height = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(values[4]); if (unlikely((__pyx_v_dst_height == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 315, __pyx_L3_error)</span>
    __pyx_v_dst_format = values[5];
    __pyx_v_options = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("init_context", 0, 6, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 314, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.init_context", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_init_context(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), __pyx_v_src_width, __pyx_v_src_height, __pyx_v_src_format, __pyx_v_dst_width, __pyx_v_dst_height, __pyx_v_dst_format, __pyx_v_options);
</pre><pre class="cython line score-0">&#xA0;<span class="">316</span>:         cdef int i</pre>
<pre class="cython line score-88" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">317</span>:         assert src_format in get_input_colorspaces(), "invalid input colorspace: %s (must be one of %s)" % (src_format, get_input_colorspaces())</pre>
<pre class='cython code score-88 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_get_input_colorspaces);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_t_1, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!(__pyx_t_4 != 0))) {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_6 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_input_colorspace);
      __pyx_t_5 += 26;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_input_colorspace);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_invalid_input_colorspace);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_src_format), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_one_of);
      __pyx_t_5 += 17;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_one_of);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_must_be_one_of);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_get_input_colorspaces);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_2 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_2), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_5 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u__4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 5, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 317, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 317, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-84" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">318</span>:         assert dst_format in get_output_colorspaces(src_format), "invalid output colorspace: %s (must be one of %s)" % (dst_format, get_output_colorspaces(src_format))</pre>
<pre class='cython code score-84 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_get_output_colorspaces);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_3 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_1, __pyx_t_2, __pyx_cur_scope-&gt;__pyx_v_src_format) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_cur_scope-&gt;__pyx_v_src_format);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PySequence_ContainsTF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_t_3, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!(__pyx_t_4 != 0))) {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 = 0;
      __pyx_t_6 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_output_colorspace);
      __pyx_t_5 += 27;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_output_colorspace);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_invalid_output_colorspace);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_1) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_1);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
      __pyx_t_1 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_must_be_one_of);
      __pyx_t_5 += 17;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_must_be_one_of);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_must_be_one_of);
      <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_get_output_colorspaces);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
        }
      }
      __pyx_t_1 = (__pyx_t_7) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_7, __pyx_cur_scope-&gt;__pyx_v_src_format) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_cur_scope-&gt;__pyx_v_src_format);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_1), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_2) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_2);
      __pyx_t_2 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_5 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 4, __pyx_kp_u__4);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 5, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 318, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 318, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">319</span>:         log("csc_cython.ColorspaceConverter.init_context%s", (</pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-62" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">320</span>:             src_width, src_height, src_format, dst_width, dst_height, dst_format, options))</pre>
<pre class='cython code score-62 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_cur_scope-&gt;__pyx_v_src_width);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_cur_scope-&gt;__pyx_v_src_height);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_cur_scope-&gt;__pyx_v_dst_width);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_cur_scope-&gt;__pyx_v_dst_height);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(7);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 320, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_cur_scope-&gt;__pyx_v_src_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 3, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 4, __pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 5, __pyx_cur_scope-&gt;__pyx_v_dst_format);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_options);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_options);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 6, __pyx_v_options);
  __pyx_t_1 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
      __pyx_t_11 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_kp_u_csc_cython_ColorspaceConverter_i, __pyx_t_10};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_3)) {
    PyObject *__pyx_temp[3] = {__pyx_t_9, __pyx_kp_u_csc_cython_ColorspaceConverter_i, __pyx_t_10};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_3, __pyx_temp+1-__pyx_t_11, 2+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(2+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_csc_cython_ColorspaceConverter_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_csc_cython_ColorspaceConverter_i);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_11, __pyx_kp_u_csc_cython_ColorspaceConverter_i);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_11, __pyx_t_10);
    __pyx_t_10 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_3, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 319, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">321</span>:         self.src_width = src_width</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;src_width = __pyx_cur_scope-&gt;__pyx_v_src_width;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">322</span>:         self.src_height = src_height</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;src_height = __pyx_cur_scope-&gt;__pyx_v_src_height;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">323</span>:         self.dst_width = dst_width</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_width = __pyx_cur_scope-&gt;__pyx_v_dst_width;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">324</span>:         self.dst_height = dst_height</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_height = __pyx_cur_scope-&gt;__pyx_v_dst_height;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">325</span>:         self.src_format = src_format[:]</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;src_format);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;src_format);
  __pyx_cur_scope-&gt;__pyx_v_self-&gt;src_format = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_slice__5 = <span class='py_c_api'>PySlice_New</span>(Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_slice__5)) __PYX_ERR(0, 325, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_slice__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_slice__5);
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">326</span>:         self.dst_format = dst_format[:]</pre>
<pre class='cython code score-3 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetSlice</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, 0, 0, NULL, NULL, &amp;__pyx_slice__5, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 326, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_format);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_format);
  __pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_format = __pyx_t_2;
  __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">327</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">328</span>:         self.time = 0</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;time = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">329</span>:         self.frames = 0</pre>
<pre class='cython code score-0 '>  __pyx_cur_scope-&gt;__pyx_v_self-&gt;frames = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">330</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">331</span>:         #explicity clear all strides / sizes / offsets:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">332</span>:         for i in range(2):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_11 = 0; __pyx_t_11 &lt; 2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">333</span>:             self.dst_strides[i] = 0</pre>
<pre class='cython code score-0 '>    (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[__pyx_v_i]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">334</span>:             self.dst_sizes[i]   = 0</pre>
<pre class='cython code score-0 '>    (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[__pyx_v_i]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">335</span>:             self.offsets[i]     = 0</pre>
<pre class='cython code score-0 '>    (__pyx_cur_scope-&gt;__pyx_v_self-&gt;offsets[__pyx_v_i]) = 0;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">336</span>: </pre>
<pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">337</span>:         def assert_no_scaling():</pre>
<pre class='cython code score-11 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_1assert_no_scaling(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_1assert_no_scaling = {"assert_no_scaling", (PyCFunction)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_1assert_no_scaling, METH_NOARGS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_1assert_no_scaling(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assert_no_scaling (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_assert_no_scaling(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_assert_no_scaling(PyObject *__pyx_self) {
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *__pyx_cur_scope;
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("assert_no_scaling", 0);
  __pyx_outer_scope = (struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.init_context.assert_no_scaling", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_1assert_no_scaling, 0, __pyx_n_s_init_context_locals_assert_no_sc, ((PyObject*)__pyx_cur_scope), __pyx_n_s_xpra_codecs_csc_cython_colorspac_2, __pyx_d, ((PyObject *)__pyx_codeobj__6));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_v_assert_no_scaling = __pyx_t_2;
  __pyx_t_2 = 0;
/* … */
  __pyx_codeobj__6 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(0, 0, 0, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_assert_no_scaling, 337, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__6)) __PYX_ERR(0, 337, __pyx_L1_error)</span>
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">338</span>:             assert src_width==dst_width and src_height==dst_height, "scaling is not supported for %s to %s" % (src_format, dst_format)</pre>
<pre class='cython code score-50 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = ((__pyx_cur_scope-&gt;__pyx_v_src_width == __pyx_cur_scope-&gt;__pyx_v_dst_width) != 0);
    if (__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L3_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_cur_scope-&gt;__pyx_v_src_height == __pyx_cur_scope-&gt;__pyx_v_dst_height) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L3_bool_binop_done:;
    if (unlikely(!__pyx_t_1)) {
      __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_4 = 0;
      __pyx_t_5 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_scaling_is_not_supported_for);
      __pyx_t_4 += 29;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_scaling_is_not_supported_for);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_kp_u_scaling_is_not_supported_for);
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_src_format)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("src_format"); <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span> }
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_src_format), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) &gt; __pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) : __pyx_t_5;
      __pyx_t_4 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_6);
      __pyx_t_6 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_to);
      __pyx_t_4 += 4;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_to);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 2, __pyx_kp_u_to);
      if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_dst_format)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("dst_format"); <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span> }
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_5 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) &gt; __pyx_t_5) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) : __pyx_t_5;
      __pyx_t_4 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 3, __pyx_t_6);
      __pyx_t_6 = 0;
      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_3, 4, __pyx_t_4, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 338, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_6);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      <span class='error_goto'>__PYX_ERR(0, 338, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">339</span>: </pre>
<pre class="cython line score-56" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">340</span>:         def allocate_yuv(fmt="YUV420P", Bpp=1):</pre>
<pre class='cython code score-56 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_3allocate_yuv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_3allocate_yuv = {"allocate_yuv", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_3allocate_yuv, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_3allocate_yuv(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_fmt = 0;
  PyObject *__pyx_v_Bpp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("allocate_yuv (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_fmt,&amp;__pyx_n_s_Bpp,0};
    PyObject* values[2] = {0,0};
    values[0] = ((PyObject *)((PyObject*)__pyx_n_u_YUV420P));
    values[1] = ((PyObject *)((PyObject *)__pyx_int_1));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_fmt);
          if (value) { values[0] = value; kw_args--; }
        }
        CYTHON_FALLTHROUGH;
        case  1:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Bpp);
          if (value) { values[1] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "allocate_yuv") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        CYTHON_FALLTHROUGH;
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_fmt = values[0];
    __pyx_v_Bpp = values[1];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("allocate_yuv", 0, 0, 2, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 340, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.init_context.allocate_yuv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_2allocate_yuv(__pyx_self, __pyx_v_fmt, __pyx_v_Bpp);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_2allocate_yuv(PyObject *__pyx_self, PyObject *__pyx_v_fmt, PyObject *__pyx_v_Bpp) {
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *__pyx_cur_scope;
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *__pyx_outer_scope;
  PyObject *__pyx_v_divs = NULL;
  PyObject *__pyx_v_i = NULL;
  PyObject *__pyx_v_div = NULL;
  PyObject *__pyx_v_xdiv = NULL;
  PyObject *__pyx_v_ydiv = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("allocate_yuv", 0);
  __pyx_outer_scope = (struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_16);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.init_context.allocate_yuv", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_divs);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_i);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_div);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_xdiv);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_ydiv);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_fmt, __pyx_n_s_Bpp, __pyx_n_s_divs, __pyx_n_s_i, __pyx_n_s_div, __pyx_n_s_xdiv, __pyx_n_s_ydiv);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
  __pyx_codeobj__8 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(2, 0, 7, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__7, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_allocate_yuv, 340, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__8)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_3allocate_yuv, 0, __pyx_n_s_init_context_locals_allocate_yuv, ((PyObject*)__pyx_cur_scope), __pyx_n_s_xpra_codecs_csc_cython_colorspac_2, __pyx_d, ((PyObject *)__pyx_codeobj__8));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__9);
  __pyx_v_allocate_yuv = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(2, ((PyObject*)__pyx_n_u_YUV420P), ((PyObject *)__pyx_int_1));<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) __PYX_ERR(0, 340, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
</pre><pre class="cython line score-16" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">341</span>:             divs = get_subsampling_divs(fmt)</pre>
<pre class='cython code score-16 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_get_subsampling_divs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 341, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_fmt) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_fmt);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 341, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_divs = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">342</span>:             assert divs, "invalid pixel format '%s'" % fmt</pre>
<pre class='cython code score-10 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_divs); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_invalid_pixel_format_s, __pyx_v_fmt);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 342, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 342, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">343</span>:             for i, div in enumerate(divs):</pre>
<pre class='cython code score-50 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  __pyx_t_1 = __pyx_int_0;
  if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_divs)) || <span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_divs)) {
    __pyx_t_2 = __pyx_v_divs; <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2); __pyx_t_5 = 0;
    __pyx_t_6 = NULL;
  } else {
    __pyx_t_5 = -1; __pyx_t_2 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_divs);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_6 = Py_TYPE(__pyx_t_2)-&gt;tp_iternext;<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
  }
  for (;;) {
    if (likely(!__pyx_t_6)) {
      if (likely(<span class='py_c_api'>PyList_CheckExact</span>(__pyx_t_2))) {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyList_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      } else {
        if (__pyx_t_5 &gt;= <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_t_2)) break;
        #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_t_2, __pyx_t_5); <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3); __pyx_t_5++; if (unlikely(0 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        #else
        __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(__pyx_t_2, __pyx_t_5); __pyx_t_5++;<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        #endif
      }
    } else {
      __pyx_t_3 = __pyx_t_6(__pyx_t_2);
      if (unlikely(!__pyx_t_3)) {
        PyObject* exc_type = <span class='py_c_api'>PyErr_Occurred</span>();
        if (exc_type) {
          if (likely(<span class='pyx_c_api'>__Pyx_PyErr_GivenExceptionMatches</span>(exc_type, PyExc_StopIteration))) <span class='py_c_api'>PyErr_Clear</span>();
          else <span class='error_goto'>__PYX_ERR(0, 343, __pyx_L1_error)</span>
        }
        break;
      }
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_div, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_i, __pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_AddObjC</span>(__pyx_t_1, __pyx_int_1, 1, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 343, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1);
    __pyx_t_1 = __pyx_t_3;
    __pyx_t_3 = 0;
/* … */
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">344</span>:                 xdiv, ydiv = div</pre>
<pre class='cython code score-44 '>    if ((likely(<span class='py_c_api'>PyTuple_CheckExact</span>(__pyx_v_div))) || (<span class='py_c_api'>PyList_CheckExact</span>(__pyx_v_div))) {
      PyObject* sequence = __pyx_v_div;
      Py_ssize_t size = <span class='pyx_c_api'>__Pyx_PySequence_SIZE</span>(sequence);
      if (unlikely(size != 2)) {
        if (size &gt; 2) <span class='pyx_c_api'>__Pyx_RaiseTooManyValuesError</span>(2);
        else if (size &gt;= 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(size);
        <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>
      }
      #if CYTHON_ASSUME_SAFE_MACROS &amp;&amp; !CYTHON_AVOID_BORROWED_REFS
      if (likely(<span class='py_c_api'>PyTuple_CheckExact</span>(sequence))) {
        __pyx_t_3 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(sequence, 1); 
      } else {
        __pyx_t_3 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 0); 
        __pyx_t_7 = <span class='py_macro_api'>PyList_GET_ITEM</span>(sequence, 1); 
      }
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      #else
      __pyx_t_3 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = <span class='py_macro_api'>PySequence_ITEM</span>(sequence, 1);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      #endif
    } else {
      Py_ssize_t index = -1;
      __pyx_t_8 = <span class='py_c_api'>PyObject_GetIter</span>(__pyx_v_div);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 344, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_9 = Py_TYPE(__pyx_t_8)-&gt;tp_iternext;
      index = 0; __pyx_t_3 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_3)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      index = 1; __pyx_t_7 = __pyx_t_9(__pyx_t_8); if (unlikely(!__pyx_t_7)) goto __pyx_L5_unpacking_failed;
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      if (<span class='pyx_c_api'>__Pyx_IternextUnpackEndCheck</span>(__pyx_t_9(__pyx_t_8), 2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>
      __pyx_t_9 = NULL;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      goto __pyx_L6_unpacking_done;
      __pyx_L5_unpacking_failed:;
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_9 = NULL;
      if (<span class='pyx_c_api'>__Pyx_IterFinish</span>() == 0) <span class='pyx_c_api'>__Pyx_RaiseNeedMoreValuesError</span>(index);
      <span class='error_goto'>__PYX_ERR(0, 344, __pyx_L1_error)</span>
      __pyx_L6_unpacking_done:;
    }
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_xdiv, __pyx_t_3);
    __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_ydiv, __pyx_t_7);
    __pyx_t_7 = 0;
</pre><pre class="cython line score-50" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">345</span>:                 self.dst_strides[i] = roundup(roundup(self.dst_width*Bpp, xdiv)//xdiv, STRIDE_ROUNDUP)</pre>
<pre class='cython code score-50 '>    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span> }
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_width);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_7, __pyx_v_Bpp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_3); if (unlikely((__pyx_t_10 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_xdiv); if (unlikely((__pyx_t_11 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup(__pyx_t_10, __pyx_t_11));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_7 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_3, __pyx_v_xdiv);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 345, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_7); if (unlikely((__pyx_t_11 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span> }
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_i); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 345, __pyx_L1_error)</span>
    (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[__pyx_t_12]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup(__pyx_t_11, 2);
</pre><pre class="cython line score-43" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">346</span>:                 self.dst_sizes[i] = self.dst_strides[i] * roundup(self.dst_height, ydiv)//ydiv</pre>
<pre class='cython code score-43 '>    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span> }
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_i); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span> }
    __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_v_ydiv); if (unlikely((__pyx_t_11 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[__pyx_t_12]) * __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup(__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_height, __pyx_t_11)));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = <span class='py_c_api'>PyNumber_FloorDivide</span>(__pyx_t_7, __pyx_v_ydiv);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 346, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_long</span>(__pyx_t_3); if (unlikely((__pyx_t_13 == (unsigned long)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span> }
    __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyIndex_AsSsize_t</span>(__pyx_v_i); if (unlikely((__pyx_t_12 == (Py_ssize_t)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 346, __pyx_L1_error)</span>
    (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[__pyx_t_12]) = __pyx_t_13;
</pre><pre class="cython line score-0">&#xA0;<span class="">347</span>:             #U channel follows Y with 1 line padding, V follows U with another line of padding:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">348</span>:             self.offsets[0] = 0</pre>
<pre class='cython code score-2 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 348, __pyx_L1_error)</span> }
  (__pyx_cur_scope-&gt;__pyx_v_self-&gt;offsets[0]) = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">349</span>:             self.offsets[1] = self.offsets[0] + self.dst_sizes[0] + self.dst_strides[0]</pre>
<pre class='cython code score-8 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 349, __pyx_L1_error)</span> }
  (__pyx_cur_scope-&gt;__pyx_v_self-&gt;offsets[1]) = (((__pyx_cur_scope-&gt;__pyx_v_self-&gt;offsets[0]) + (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[0])) + (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[0]));
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">350</span>:             self.offsets[2] = self.offsets[1] + self.dst_sizes[1] + self.dst_strides[1]</pre>
<pre class='cython code score-8 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 350, __pyx_L1_error)</span> }
  (__pyx_cur_scope-&gt;__pyx_v_self-&gt;offsets[2]) = (((__pyx_cur_scope-&gt;__pyx_v_self-&gt;offsets[1]) + (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[1])) + (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[1]));
</pre><pre class="cython line score-0">&#xA0;<span class="">351</span>:             #output buffer ends after V + 1 line of padding:</pre>
<pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">352</span>:             self.buffer_size = self.offsets[2] + self.dst_sizes[2] + self.dst_strides[2]</pre>
<pre class='cython code score-8 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 352, __pyx_L1_error)</span> }
  __pyx_cur_scope-&gt;__pyx_v_self-&gt;buffer_size = (((__pyx_cur_scope-&gt;__pyx_v_self-&gt;offsets[2]) + (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[2])) + (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[2]));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">353</span>:             log("allocate_yuv(%s, %i) buffer_size=%s, sizes=%s, strides=%s",</pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">354</span>:                 fmt, Bpp, self.buffer_size,</pre>
<pre class='cython code score-4 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 354, __pyx_L1_error)</span> }
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 354, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">355</span>:                 (self.dst_sizes[0], self.dst_sizes[1], self.dst_sizes[2]),</pre>
<pre class='cython code score-20 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span> }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[0]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span> }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[1]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 355, __pyx_L1_error)</span> }
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[2]));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_15)) __PYX_ERR(0, 355, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 1, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 2, __pyx_t_14);
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_14 = 0;
</pre><pre class="cython line score-69" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">356</span>:                 (self.dst_strides[0], self.dst_strides[1], self.dst_strides[2])</pre>
<pre class='cython code score-69 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span> }
  __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[0]));<span class='error_goto'> if (unlikely(!__pyx_t_14)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_14);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span> }
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[1]));<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 356, __pyx_L1_error)</span> }
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[2]));<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_16 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_16)) __PYX_ERR(0, 356, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 0, __pyx_t_14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 1, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_16, 2, __pyx_t_7);
  __pyx_t_14 = 0;
  __pyx_t_8 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_11 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[7] = {__pyx_t_7, __pyx_kp_u_allocate_yuv_s_i_buffer_size_s_s, __pyx_v_fmt, __pyx_v_Bpp, __pyx_t_3, __pyx_t_15, __pyx_t_16};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[7] = {__pyx_t_7, __pyx_kp_u_allocate_yuv_s_i_buffer_size_s_s, __pyx_v_fmt, __pyx_v_Bpp, __pyx_t_3, __pyx_t_15, __pyx_t_16};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 6+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(6+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_allocate_yuv_s_i_buffer_size_s_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_allocate_yuv_s_i_buffer_size_s_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_11, __pyx_kp_u_allocate_yuv_s_i_buffer_size_s_s);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fmt);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fmt);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_11, __pyx_v_fmt);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Bpp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Bpp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_11, __pyx_v_Bpp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3+__pyx_t_11, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_15);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 4+__pyx_t_11, __pyx_t_15);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_16);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 5+__pyx_t_11, __pyx_t_16);
    __pyx_t_3 = 0;
    __pyx_t_15 = 0;
    __pyx_t_16 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 353, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">357</span>:                 )</pre>
<pre class="cython line score-0">&#xA0;<span class="">358</span>: </pre>
<pre class="cython line score-46" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">359</span>:         def allocate_rgb(Bpp=4):</pre>
<pre class='cython code score-46 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_5allocate_rgb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_5allocate_rgb = {"allocate_rgb", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_5allocate_rgb, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_5allocate_rgb(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_Bpp = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("allocate_rgb (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_Bpp,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)((PyObject *)__pyx_int_4));
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_Bpp);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "allocate_rgb") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_Bpp = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("allocate_rgb", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 359, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.init_context.allocate_rgb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_4allocate_rgb(__pyx_self, __pyx_v_Bpp);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_4allocate_rgb(PyObject *__pyx_self, PyObject *__pyx_v_Bpp) {
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *__pyx_cur_scope;
  struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *__pyx_outer_scope;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("allocate_rgb", 0);
  __pyx_outer_scope = (struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter___pyx_scope_struct__init_context *) <span class='pyx_c_api'>__Pyx_CyFunction_GetClosure</span>(__pyx_self);
  __pyx_cur_scope = __pyx_outer_scope;
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.init_context.allocate_rgb", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(1, __pyx_n_s_Bpp);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
  __pyx_codeobj__11 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(1, 0, 1, 0, CO_OPTIMIZED|CO_NEWLOCALS, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__10, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_xpra_codecs_csc_cython_colorspac, __pyx_n_s_allocate_rgb, 359, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__11)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
/* … */
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_CyFunction_NewEx</span>(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_5allocate_rgb, 0, __pyx_n_s_init_context_locals_allocate_rgb, ((PyObject*)__pyx_cur_scope), __pyx_n_s_xpra_codecs_csc_cython_colorspac_2, __pyx_d, ((PyObject *)__pyx_codeobj__11));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_CyFunction_SetDefaultsTuple</span>(__pyx_t_2, __pyx_tuple__12);
  __pyx_v_allocate_rgb = __pyx_t_2;
  __pyx_t_2 = 0;
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(1, ((PyObject *)__pyx_int_4));<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) __PYX_ERR(0, 359, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class="cython line score-20" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">360</span>:             self.dst_strides[0] = roundup(self.dst_width*Bpp, STRIDE_ROUNDUP)</pre>
<pre class='cython code score-20 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span> }
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_width);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_v_Bpp);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_2); if (unlikely((__pyx_t_3 == (int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 360, __pyx_L1_error)</span> }
  (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[0]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup(__pyx_t_3, 2);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">361</span>:             self.dst_sizes[0] = self.dst_strides[0] * self.dst_height</pre>
<pre class='cython code score-6 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 361, __pyx_L1_error)</span> }
  (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[0]) = ((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[0]) * __pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_height);
</pre><pre class="cython line score-6" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">362</span>:             self.buffer_size = self.dst_sizes[0]+self.dst_strides[0]</pre>
<pre class='cython code score-6 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 362, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 362, __pyx_L1_error)</span> }
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 362, __pyx_L1_error)</span> }
  __pyx_cur_scope-&gt;__pyx_v_self-&gt;buffer_size = ((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[0]) + (__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[0]));
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">363</span>:             log("allocate_rgb(%i) buffer_size=%s, dst size=%s, stride=%s",</pre>
<pre class='cython code score-2 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
</pre><pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">364</span>:                 Bpp, self.buffer_size, self.dst_sizes[0], self.dst_strides[0])</pre>
<pre class='cython code score-59 '>  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span> }
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;buffer_size);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span> }
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_sizes[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  if (unlikely(!__pyx_cur_scope-&gt;__pyx_v_self)) { <span class='pyx_c_api'>__Pyx_RaiseClosureNameError</span>("self"); <span class='error_goto'>__PYX_ERR(0, 364, __pyx_L1_error)</span> }
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_cur_scope-&gt;__pyx_v_self-&gt;dst_strides[0]));<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 364, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = NULL;
  __pyx_t_3 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      __pyx_t_3 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[6] = {__pyx_t_7, __pyx_kp_u_allocate_rgb_i_buffer_size_s_dst, __pyx_v_Bpp, __pyx_t_4, __pyx_t_5, __pyx_t_6};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_3, 5+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_1)) {
    PyObject *__pyx_temp[6] = {__pyx_t_7, __pyx_kp_u_allocate_rgb_i_buffer_size_s_dst, __pyx_v_Bpp, __pyx_t_4, __pyx_t_5, __pyx_t_6};
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_1, __pyx_temp+1-__pyx_t_3, 5+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(5+__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_allocate_rgb_i_buffer_size_s_dst);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_allocate_rgb_i_buffer_size_s_dst);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_3, __pyx_kp_u_allocate_rgb_i_buffer_size_s_dst);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_Bpp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_Bpp);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_3, __pyx_v_Bpp);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_3, __pyx_t_4);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3+__pyx_t_3, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 4+__pyx_t_3, __pyx_t_6);
    __pyx_t_4 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 363, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">365</span>: </pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">366</span>:         if src_format in ("BGRX", "RGBX", "RGB", "BGR", "r210") and dst_format=="YUV420P":</pre>
<pre class='cython code score-14 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format);
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_src_format;
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_BGRX, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  if (!__pyx_t_13) {
  } else {
    __pyx_t_12 = __pyx_t_13;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_RGBX, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  if (!__pyx_t_13) {
  } else {
    __pyx_t_12 = __pyx_t_13;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_RGB, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  if (!__pyx_t_13) {
  } else {
    __pyx_t_12 = __pyx_t_13;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_BGR, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  if (!__pyx_t_13) {
  } else {
    __pyx_t_12 = __pyx_t_13;
    goto __pyx_L8_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  __pyx_t_12 = __pyx_t_13;
  __pyx_L8_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_13 = (__pyx_t_12 != 0);
  if (__pyx_t_13) {
  } else {
    __pyx_t_4 = __pyx_t_13;
    goto __pyx_L6_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_YUV420P, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 366, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_t_13;
  __pyx_L6_bool_binop_done:;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">367</span>:             allocate_yuv(dst_format)</pre>
<pre class='cython code score-3 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_v_allocate_yuv, __pyx_cur_scope-&gt;__pyx_v_dst_format);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 367, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">368</span>:             if src_format=="BGRX":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_BGRX, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 368, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L13;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">369</span>:                 self.convert_image_function = self.BGRX_to_YUV420P</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_BGRX_to_YUV420P);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 369, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">370</span>:             elif src_format=="RGBX":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_RGBX, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 370, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L13;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">371</span>:                 self.convert_image_function = self.RGBX_to_YUV420P</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_RGBX_to_YUV420P);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 371, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">372</span>:             elif src_format=="BGR":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_BGR, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 372, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L13;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">373</span>:                 self.convert_image_function = self.BGR_to_YUV420P</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_BGR_to_YUV420P);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 373, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">374</span>:             elif src_format=="RGB":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_RGB, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 374, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L13;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">375</span>:                 self.convert_image_function = self.RGB_to_YUV420P</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_RGB_to_YUV420P);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 375, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">376</span>:             else:</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">377</span>:                 assert src_format=="r210"</pre>
<pre class='cython code score-7 '>    /*else*/ {
      #ifndef CYTHON_WITHOUT_ASSERTIONS
      if (unlikely(!Py_OptimizeFlag)) {
        __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
        if (unlikely(!__pyx_t_4)) {
          <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
          <span class='error_goto'>__PYX_ERR(0, 377, __pyx_L1_error)</span>
        }
      }
      #endif
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">378</span>:                 self.convert_image_function = self.r210_to_YUV420P</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_r210_to_YUV420P);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 378, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    __pyx_L13:;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">379</span>:         elif src_format=="r210" and dst_format=="BGR48":</pre>
<pre class='cython code score-4 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
  if (__pyx_t_13) {
  } else {
    __pyx_t_4 = __pyx_t_13;
    goto __pyx_L14_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_BGR48, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 379, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_t_13;
  __pyx_L14_bool_binop_done:;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">380</span>:             assert_no_scaling()</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_assert_no_scaling(__pyx_v_assert_no_scaling);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 380, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">381</span>:             allocate_rgb(6)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_4allocate_rgb(__pyx_v_allocate_rgb, __pyx_int_6);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 381, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">382</span>:             self.convert_image_function = self.r210_to_BGR48</pre>
<pre class='cython code score-3 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_r210_to_BGR48);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 382, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
    __pyx_t_2 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">383</span>:         elif src_format=="r210" and dst_format=="YUV444P10":</pre>
<pre class='cython code score-4 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>
  if (__pyx_t_13) {
  } else {
    __pyx_t_4 = __pyx_t_13;
    goto __pyx_L16_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_YUV444P10, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 383, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_t_13;
  __pyx_L16_bool_binop_done:;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">384</span>:             assert_no_scaling()</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_assert_no_scaling(__pyx_v_assert_no_scaling);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 384, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">385</span>:             allocate_yuv(dst_format, 2)</pre>
<pre class='cython code score-3 '>    __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_dst_format;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
    __pyx_t_3 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_2allocate_yuv(__pyx_v_allocate_yuv, __pyx_t_2, __pyx_int_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 385, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">386</span>:             self.convert_image_function = self.r210_to_YUV444P10</pre>
<pre class='cython code score-3 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_r210_to_YUV444P10);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 386, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">387</span>:         elif src_format=="YUV444P10" and dst_format=="r210":</pre>
<pre class='cython code score-4 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_YUV444P10, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>
  if (__pyx_t_13) {
  } else {
    __pyx_t_4 = __pyx_t_13;
    goto __pyx_L18_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 387, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_t_13;
  __pyx_L18_bool_binop_done:;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">388</span>:             assert_no_scaling()</pre>
<pre class='cython code score-1 '>    __pyx_t_3 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_assert_no_scaling(__pyx_v_assert_no_scaling);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 388, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">389</span>:             allocate_rgb(4)</pre>
<pre class='cython code score-1 '>    __pyx_t_3 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_4allocate_rgb(__pyx_v_allocate_rgb, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 389, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">390</span>:             self.convert_image_function = self.YUV444P10_to_r210</pre>
<pre class='cython code score-3 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_YUV444P10_to_r210);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 390, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">391</span>:         elif src_format=="GBRP10" and dst_format=="r210":</pre>
<pre class='cython code score-4 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_GBRP10, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 391, __pyx_L1_error)</span>
  if (__pyx_t_13) {
  } else {
    __pyx_t_4 = __pyx_t_13;
    goto __pyx_L20_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 391, __pyx_L1_error)</span>
  __pyx_t_4 = __pyx_t_13;
  __pyx_L20_bool_binop_done:;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">392</span>:             assert_no_scaling()</pre>
<pre class='cython code score-1 '>    __pyx_t_3 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_assert_no_scaling(__pyx_v_assert_no_scaling);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 392, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">393</span>:             allocate_rgb(4)</pre>
<pre class='cython code score-1 '>    __pyx_t_3 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_4allocate_rgb(__pyx_v_allocate_rgb, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 393, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">394</span>:             self.convert_image_function = self.GBRP10_to_r210</pre>
<pre class='cython code score-3 '>    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_GBRP10_to_r210);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 394, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
    __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_3;
    __pyx_t_3 = 0;
</pre><pre class="cython line score-12" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">395</span>:         elif src_format=="YUV420P" and dst_format in ("RGBX", "BGRX", "RGB", "BGR"):</pre>
<pre class='cython code score-12 '>  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_YUV420P, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>
  if (__pyx_t_13) {
  } else {
    __pyx_t_4 = __pyx_t_13;
    goto __pyx_L22_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
  __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_dst_format;
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_3, __pyx_n_u_RGBX, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>
  if (!__pyx_t_12) {
  } else {
    __pyx_t_13 = __pyx_t_12;
    goto __pyx_L24_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_3, __pyx_n_u_BGRX, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>
  if (!__pyx_t_12) {
  } else {
    __pyx_t_13 = __pyx_t_12;
    goto __pyx_L24_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_3, __pyx_n_u_RGB, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>
  if (!__pyx_t_12) {
  } else {
    __pyx_t_13 = __pyx_t_12;
    goto __pyx_L24_bool_binop_done;
  }
  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_3, __pyx_n_u_BGR, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 395, __pyx_L1_error)</span>
  __pyx_t_13 = __pyx_t_12;
  __pyx_L24_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_12 = (__pyx_t_13 != 0);
  __pyx_t_4 = __pyx_t_12;
  __pyx_L22_bool_binop_done:;
  if (__pyx_t_4) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">396</span>:             #3 or 4 bytes per pixel:</pre>
<pre class="cython line score-14" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">397</span>:             allocate_rgb(len(dst_format))</pre>
<pre class='cython code score-14 '>    __pyx_t_3 = __pyx_cur_scope-&gt;__pyx_v_dst_format;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 397, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_4allocate_rgb(__pyx_v_allocate_rgb, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 397, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">398</span>:             if dst_format=="RGBX":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_RGBX, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 398, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L28;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">399</span>:                 self.convert_image_function = self.YUV420P_to_RGBX</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_YUV420P_to_RGBX);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 399, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">400</span>:             elif dst_format=="BGRX":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_BGRX, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 400, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L28;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">401</span>:                 self.convert_image_function = self.YUV420P_to_BGRX</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_YUV420P_to_BGRX);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 401, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">402</span>:             elif dst_format=="RGB":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_RGB, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 402, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L28;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">403</span>:                 self.convert_image_function = self.YUV420P_to_RGB</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_YUV420P_to_RGB);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 403, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">404</span>:             else:</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">405</span>:                 assert dst_format=="BGR"</pre>
<pre class='cython code score-7 '>    /*else*/ {
      #ifndef CYTHON_WITHOUT_ASSERTIONS
      if (unlikely(!Py_OptimizeFlag)) {
        __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_BGR, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
        if (unlikely(!__pyx_t_4)) {
          <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
          <span class='error_goto'>__PYX_ERR(0, 405, __pyx_L1_error)</span>
        }
      }
      #endif
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">406</span>:                 self.convert_image_function = self.YUV420P_to_BGR</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_YUV420P_to_BGR);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 406, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    __pyx_L28:;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">407</span>:         elif src_format=="GBRP" and dst_format in ("RGBX", "BGRX"):</pre>
<pre class='cython code score-8 '>  __pyx_t_12 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_src_format, __pyx_n_u_GBRP, Py_EQ)); if (unlikely(__pyx_t_12 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>
  if (__pyx_t_12) {
  } else {
    __pyx_t_4 = __pyx_t_12;
    goto __pyx_L29_bool_binop_done;
  }
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
  __pyx_t_2 = __pyx_cur_scope-&gt;__pyx_v_dst_format;
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_RGBX, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>
  if (!__pyx_t_13) {
  } else {
    __pyx_t_12 = __pyx_t_13;
    goto __pyx_L31_bool_binop_done;
  }
  __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_t_2, __pyx_n_u_BGRX, Py_EQ)); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 407, __pyx_L1_error)</span>
  __pyx_t_12 = __pyx_t_13;
  __pyx_L31_bool_binop_done:;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_13 = (__pyx_t_12 != 0);
  __pyx_t_4 = __pyx_t_13;
  __pyx_L29_bool_binop_done:;
  if (likely(__pyx_t_4)) {
/* … */
    goto __pyx_L5;
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">408</span>:             #4 bytes per pixel:</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">409</span>:             allocate_rgb(4)</pre>
<pre class='cython code score-1 '>    __pyx_t_2 = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12init_context_4allocate_rgb(__pyx_v_allocate_rgb, __pyx_int_4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 409, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">410</span>:             if dst_format=="RGBX":</pre>
<pre class='cython code score-2 '>    __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_RGBX, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 410, __pyx_L1_error)</span>
    if (__pyx_t_4) {
/* … */
      goto __pyx_L33;
    }
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">411</span>:                 self.convert_image_function = self.GBRP_to_RGBX</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_GBRP_to_RGBX);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 411, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">412</span>:             else:</pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">413</span>:                 assert dst_format=="BGRX"</pre>
<pre class='cython code score-7 '>    /*else*/ {
      #ifndef CYTHON_WITHOUT_ASSERTIONS
      if (unlikely(!Py_OptimizeFlag)) {
        __pyx_t_4 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format, __pyx_n_u_BGRX, Py_EQ)); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 413, __pyx_L1_error)</span>
        if (unlikely(!__pyx_t_4)) {
          <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
          <span class='error_goto'>__PYX_ERR(0, 413, __pyx_L1_error)</span>
        }
      }
      #endif
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">414</span>:                 self.convert_image_function = self.GBRP_to_BGRX</pre>
<pre class='cython code score-3 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_cur_scope-&gt;__pyx_v_self), __pyx_n_s_GBRP_to_BGRX);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 414, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function);
      __pyx_cur_scope-&gt;__pyx_v_self-&gt;convert_image_function = __pyx_t_2;
      __pyx_t_2 = 0;
    }
    __pyx_L33:;
</pre><pre class="cython line score-0">&#xA0;<span class="">415</span>:         else:</pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">416</span>:             raise Exception("BUG: src_format=%s, dst_format=%s", src_format, dst_format)</pre>
<pre class='cython code score-17 '>  /*else*/ {
    __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(3);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 416, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_BUG_src_format_s_dst_format_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_BUG_src_format_s_dst_format_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_BUG_src_format_s_dst_format_s);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_src_format);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_cur_scope-&gt;__pyx_v_src_format);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_cur_scope-&gt;__pyx_v_dst_format);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_cur_scope-&gt;__pyx_v_dst_format);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 416, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_3, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='error_goto'>__PYX_ERR(0, 416, __pyx_L1_error)</span>
  }
  __pyx_L5:;
</pre><pre class="cython line score-0">&#xA0;<span class="">417</span>: </pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">418</span>:     def clean(self):</pre>
<pre class='cython code score-1 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_3clean(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_3clean(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clean (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_2clean(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_2clean(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  int __pyx_v_i;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("clean", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">419</span>:         #overzealous clean is cheap!</pre>
<pre class="cython line score-0">&#xA0;<span class="">420</span>:         cdef int i                          #</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">421</span>:         self.src_width = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;src_width = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">422</span>:         self.src_height = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;src_height = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">423</span>:         self.dst_width = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;dst_width = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">424</span>:         self.dst_height = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;dst_height = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">425</span>:         self.src_format = ""</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__13);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;src_format);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;src_format);
  __pyx_v_self-&gt;src_format = __pyx_kp_u__13;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">426</span>:         self.dst_format = ""</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__13);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;dst_format);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;dst_format);
  __pyx_v_self-&gt;dst_format = __pyx_kp_u__13;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">427</span>:         self.time = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;time = 0.0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">428</span>:         self.frames = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;frames = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">429</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_1 = 0; __pyx_t_1 &lt; 3; __pyx_t_1+=1) {
    __pyx_v_i = __pyx_t_1;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">430</span>:             self.dst_strides[i] = 0</pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;dst_strides[__pyx_v_i]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">431</span>:             self.dst_sizes[i] = 0</pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;dst_sizes[__pyx_v_i]) = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">432</span>:             self.offsets[i] = 0</pre>
<pre class='cython code score-0 '>    (__pyx_v_self-&gt;offsets[__pyx_v_i]) = 0;
  }
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">433</span>:         self.convert_image_function = None</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GIVEREF</span>(Py_None);
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_v_self-&gt;convert_image_function);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_v_self-&gt;convert_image_function);
  __pyx_v_self-&gt;convert_image_function = Py_None;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">434</span>:         self.buffer_size = 0</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;buffer_size = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">435</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">436</span>:     def is_closed(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_5is_closed(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_5is_closed(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_closed (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_4is_closed(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_4is_closed(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("is_closed", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.is_closed", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">437</span>:         return self.convert_image_function is None</pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = (__pyx_v_self-&gt;convert_image_function == Py_None);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyBool_FromLong</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 437, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">438</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">439</span>:     def get_info(self):</pre>
<pre class='cython code score-5 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_7get_info(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_7get_info(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_info (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_6get_info(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_6get_info(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_v_info = NULL;
  double __pyx_v_pps;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_info", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.get_info", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_info);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">440</span>:         info = {</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">441</span>:                 "frames"    : self.frames,</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>(__pyx_v_self-&gt;frames);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_frames, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">442</span>:                 "src_width" : self.src_width,</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 442, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_src_width, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">443</span>:                 "src_height": self.src_height,</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_height);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 443, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_src_height, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">444</span>:                 "dst_width" : self.dst_width,</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 444, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_dst_width, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">445</span>:                 "dst_height": self.dst_height,</pre>
<pre class='cython code score-8 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_height);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 445, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_1, __pyx_n_u_dst_height, __pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 441, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_info = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">446</span>:                 }</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">447</span>:         if self.src_format:</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_self-&gt;src_format); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 447, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">448</span>:             info["src_format"] = self.src_format</pre>
<pre class='cython code score-7 '>    __pyx_t_1 = __pyx_v_self-&gt;src_format;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_info, __pyx_n_u_src_format, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 448, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">449</span>:         if self.dst_format:</pre>
<pre class='cython code score-2 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_v_self-&gt;dst_format); if (unlikely(__pyx_t_3 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 449, __pyx_L1_error)</span>
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">450</span>:             info["dst_format"] = self.dst_format</pre>
<pre class='cython code score-7 '>    __pyx_t_1 = __pyx_v_self-&gt;dst_format;
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_info, __pyx_n_u_dst_format, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 450, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">451</span>:         if self.frames&gt;0 and self.time&gt;0:</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = ((__pyx_v_self-&gt;frames &gt; 0) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L6_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_self-&gt;time &gt; 0.0) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L6_bool_binop_done:;
  if (__pyx_t_3) {
/* … */
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">452</span>:             pps = float(self.src_width) * float(self.src_height) * float(self.frames) / self.time</pre>
<pre class='cython code score-0 '>    __pyx_v_pps = (((((double)__pyx_v_self-&gt;src_width) * ((double)__pyx_v_self-&gt;src_height)) * ((double)__pyx_v_self-&gt;frames)) / __pyx_v_self-&gt;time);
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">453</span>:             info["total_time_ms"] = int(self.time*1000.0)</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>((__pyx_v_self-&gt;time * 1000.0));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_info, __pyx_n_u_total_time_ms, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 453, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">454</span>:             info["pixels_per_second"] = int(pps)</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_FromDouble</span>(__pyx_v_pps);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 454, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (unlikely(<span class='py_c_api'>PyDict_SetItem</span>(__pyx_v_info, __pyx_n_u_pixels_per_second, __pyx_t_1) &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 454, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">455</span>:         return info</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_info);
  __pyx_r = __pyx_v_info;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">456</span>: </pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">457</span>:     def __repr__(self):</pre>
<pre class='cython code score-4 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_9__repr__(PyObject *__pyx_v_self); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_9__repr__(PyObject *__pyx_v_self) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__ (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_8__repr__(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_8__repr__(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__repr__", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.__repr__", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">458</span>:         return "csc_cython(%s %sx%s - %s %sx%s)" % (self.src_format, self.src_width, self.src_height,</pre>
<pre class='cython code score-41 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(13);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = 0;
  __pyx_t_3 = 127;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_csc_cython);
  __pyx_t_2 += 11;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_csc_cython);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_csc_cython);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_self-&gt;src_format), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_3;
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__14);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__14);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u__14);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;src_width, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_x);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_n_u_x);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;src_height, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 5, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__15);
  __pyx_t_2 += 3;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__15);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 6, __pyx_kp_u__15);
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 13, __pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 458, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_r = __pyx_t_4;
  __pyx_t_4 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-30" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">459</span>:                                                  self.dst_format, self.dst_width, self.dst_height)</pre>
<pre class='cython code score-30 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_self-&gt;dst_format), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) &gt; __pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_4) : __pyx_t_3;
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 7, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__14);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__14);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 8, __pyx_kp_u__14);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;dst_width, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 9, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_x);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_u_x);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 10, __pyx_n_u_x);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;dst_height, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 459, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 11, __pyx_t_4);
  __pyx_t_4 = 0;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
  __pyx_t_2 += 1;
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 12, __pyx_kp_u__4);
</pre><pre class="cython line score-0">&#xA0;<span class="">460</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">461</span>:     def __dealloc__(self):</pre>
<pre class='cython code score-5 '>/* Python wrapper */
static void __pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_11__dealloc__(PyObject *__pyx_v_self); /*proto*/
static void __pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_11__dealloc__(PyObject *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__ (wrapper)", 0);
  __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_10__dealloc__(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}

static void __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_10__dealloc__(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("__dealloc__", 0);
/* … */
  /* function exit code */
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_WriteUnraisable</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.__dealloc__", __pyx_clineno, __pyx_lineno, __pyx_filename, 1, 0);
  __pyx_L0:;
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
}
</pre><pre class="cython line score-19" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">462</span>:         self.clean()</pre>
<pre class='cython code score-19 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_clean);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 462, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">463</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">464</span>:     def get_src_width(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_13get_src_width(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_13get_src_width(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_src_width (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12get_src_width(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_12get_src_width(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_src_width", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.get_src_width", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">465</span>:         return self.src_width</pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_width);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 465, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">466</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">467</span>:     def get_src_height(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_15get_src_height(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_15get_src_height(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_src_height (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_14get_src_height(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_14get_src_height(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_src_height", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.get_src_height", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">468</span>:         return self.src_height</pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 468, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">469</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">470</span>:     def get_src_format(self):</pre>
<pre class='cython code score-0 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_17get_src_format(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_17get_src_format(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_src_format (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_16get_src_format(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_16get_src_format(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_src_format", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">471</span>:         return self.src_format</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;src_format);
  __pyx_r = __pyx_v_self-&gt;src_format;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">472</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">473</span>:     def get_dst_width(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_19get_dst_width(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_19get_dst_width(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dst_width (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_18get_dst_width(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_18get_dst_width(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dst_width", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.get_dst_width", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">474</span>:         return self.dst_width</pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_width);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 474, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">475</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">476</span>:     def get_dst_height(self):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_21get_dst_height(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_21get_dst_height(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dst_height (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_20get_dst_height(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_20get_dst_height(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dst_height", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.get_dst_height", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">477</span>:         return self.dst_height</pre>
<pre class='cython code score-3 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 477, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">478</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">479</span>:     def get_dst_format(self):</pre>
<pre class='cython code score-0 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_23get_dst_format(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_23get_dst_format(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dst_format (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_22get_dst_format(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_22get_dst_format(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_dst_format", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">480</span>:         return self.dst_format</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;dst_format);
  __pyx_r = __pyx_v_self-&gt;dst_format;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">481</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">482</span>:     def get_type(self):</pre>
<pre class='cython code score-0 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_25get_type(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_25get_type(PyObject *__pyx_v_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_type (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_24get_type(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_24get_type(CYTHON_UNUSED struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("get_type", 0);
/* … */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">483</span>:         return  "cython"</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_u_cython);
  __pyx_r = __pyx_n_u_cython;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">484</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">485</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">486</span>:     def convert_image(self, image):</pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_27convert_image(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_27convert_image(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("convert_image (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_26convert_image(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_26convert_image(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  double __pyx_v_start;
  PyObject *__pyx_v_fn = NULL;
  PyObject *__pyx_v_r = NULL;
  double __pyx_v_elapsed;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("convert_image", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.convert_image", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_fn);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_r);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-32" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">487</span>:         cdef double start = time.time()</pre>
<pre class='cython code score-32 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 487, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_start = __pyx_t_4;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">488</span>:         fn = self.convert_image_function</pre>
<pre class='cython code score-1 '>  __pyx_t_1 = __pyx_v_self-&gt;convert_image_function;
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_fn = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">489</span>:         r = fn(image)</pre>
<pre class='cython code score-15 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fn);
  __pyx_t_3 = __pyx_v_fn; __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? __Pyx_PyObject_Call2Args(__pyx_t_3, __pyx_t_2, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 489, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_r = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">490</span>:         cdef double elapsed = time.time()-start</pre>
<pre class='cython code score-44 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_3, __pyx_n_s_time);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='py_c_api'>PyFloat_FromDouble</span>(__pyx_v_start);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='py_c_api'>PyNumber_Subtract</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = __pyx_<span class='py_c_api'>PyFloat_AsDouble</span>(__pyx_t_3); if (unlikely((__pyx_t_4 == (double)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 490, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_v_elapsed = __pyx_t_4;
</pre><pre class="cython line score-48" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">491</span>:         log("%s took %.1fms", fn, 1000.0*elapsed)</pre>
<pre class='cython code score-48 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='py_c_api'>PyFloat_FromDouble</span>((1000.0 * __pyx_v_elapsed));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_kp_u_s_took_1fms, __pyx_v_fn, __pyx_t_1};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_5, __pyx_kp_u_s_took_1fms, __pyx_v_fn, __pyx_t_1};
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_s_took_1fms);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_s_took_1fms);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_kp_u_s_took_1fms);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_fn);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_fn);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_v_fn);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_t_1);
    __pyx_t_1 = 0;
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 491, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">492</span>:         self.time += elapsed</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;time = (__pyx_v_self-&gt;time + __pyx_v_elapsed);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">493</span>:         self.frames += 1</pre>
<pre class='cython code score-0 '>  __pyx_v_self-&gt;frames = (__pyx_v_self-&gt;frames + 1);
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">494</span>:         return r</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_r);
  __pyx_r = __pyx_v_r;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">495</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">496</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">497</span>:     def r210_to_YUV420P(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_29r210_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_29r210_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("r210_to_YUV420P (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_28r210_to_YUV420P(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_28r210_to_YUV420P(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("r210_to_YUV420P", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.r210_to_YUV420P", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">498</span>:         return self.do_RGB_to_YUV420P(image, 4, 0, 0, 0)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_RGB_to_YUV420P(__pyx_v_self, __pyx_v_image, 4, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 498, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">499</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">500</span>:     def BGR_to_YUV420P(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_31BGR_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_31BGR_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("BGR_to_YUV420P (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_30BGR_to_YUV420P(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_30BGR_to_YUV420P(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("BGR_to_YUV420P", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.BGR_to_YUV420P", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">501</span>:         return self.do_RGB_to_YUV420P(image, 3, BGR_R, BGR_G, BGR_B)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_RGB_to_YUV420P(__pyx_v_self, __pyx_v_image, 3, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_B);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 501, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">502</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">503</span>:     def RGB_to_YUV420P(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_33RGB_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_33RGB_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("RGB_to_YUV420P (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_32RGB_to_YUV420P(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_32RGB_to_YUV420P(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("RGB_to_YUV420P", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.RGB_to_YUV420P", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">504</span>:         return self.do_RGB_to_YUV420P(image, 3, RGB_R, RGB_G, RGB_B)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_RGB_to_YUV420P(__pyx_v_self, __pyx_v_image, 3, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_B);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 504, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">505</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">506</span>:     def BGRX_to_YUV420P(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_35BGRX_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_35BGRX_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("BGRX_to_YUV420P (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_34BGRX_to_YUV420P(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_34BGRX_to_YUV420P(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("BGRX_to_YUV420P", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.BGRX_to_YUV420P", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">507</span>:         return self.do_RGB_to_YUV420P(image, 4, BGRX_R, BGRX_G, BGRX_B)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_RGB_to_YUV420P(__pyx_v_self, __pyx_v_image, 4, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_B);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 507, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">508</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">509</span>:     def RGBX_to_YUV420P(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_37RGBX_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_37RGBX_to_YUV420P(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("RGBX_to_YUV420P (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_36RGBX_to_YUV420P(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_36RGBX_to_YUV420P(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("RGBX_to_YUV420P", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.RGBX_to_YUV420P", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">510</span>:         return self.do_RGB_to_YUV420P(image, 4, RGBX_R, RGBX_G, RGBX_B)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_RGB_to_YUV420P(__pyx_v_self, __pyx_v_image, 4, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_B);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 510, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">511</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">512</span>:     cdef do_RGB_to_YUV420P(self, image, const uint8_t Bpp, const uint8_t Rindex, const uint8_t Gindex, const uint8_t Bindex):</pre>
<pre class='cython code score-13 '>static PyObject *__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_do_RGB_to_YUV420P(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image, uint8_t const __pyx_v_Bpp, uint8_t const __pyx_v_Rindex, uint8_t const __pyx_v_Gindex, uint8_t const __pyx_v_Bindex) {
  unsigned int const *__pyx_v_input_r210;
  unsigned int __pyx_v_x;
  unsigned int __pyx_v_y;
  unsigned int __pyx_v_o;
  unsigned int __pyx_v_sx;
  unsigned int __pyx_v_sy;
  unsigned int __pyx_v_ox;
  unsigned int __pyx_v_oy;
  unsigned int __pyx_v_r210;
  unsigned char __pyx_v_R;
  unsigned char __pyx_v_G;
  unsigned char __pyx_v_B;
  unsigned short __pyx_v_Rsum;
  unsigned short __pyx_v_Gsum;
  unsigned short __pyx_v_Bsum;
  unsigned char __pyx_v_count;
  unsigned char __pyx_v_dx;
  unsigned char __pyx_v_dy;
  PyObject *__pyx_v_pixels = NULL;
  unsigned int __pyx_v_input_stride;
  unsigned char *__pyx_v_output_image;
  unsigned char *__pyx_v_Y;
  unsigned char *__pyx_v_U;
  unsigned char *__pyx_v_V;
  unsigned int __pyx_v_Ystride;
  unsigned int __pyx_v_Ustride;
  unsigned int __pyx_v_Vstride;
  unsigned int __pyx_v_src_width;
  unsigned int __pyx_v_src_height;
  unsigned int __pyx_v_dst_width;
  unsigned int __pyx_v_dst_height;
  unsigned int __pyx_v_workw;
  unsigned int __pyx_v_workh;
  Py_buffer __pyx_v_py_buf;
  unsigned char const *__pyx_v_input_image;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("do_RGB_to_YUV420P", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.do_RGB_to_YUV420P", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pixels);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">513</span>:         cdef const unsigned int *input_r210</pre>
<pre class="cython line score-0">&#xA0;<span class="">514</span>:         cdef unsigned int x,y,o</pre>
<pre class="cython line score-0">&#xA0;<span class="">515</span>:         cdef unsigned int sx, sy, ox, oy</pre>
<pre class="cython line score-0">&#xA0;<span class="">516</span>:         cdef unsigned unsigned int r210</pre>
<pre class="cython line score-0">&#xA0;<span class="">517</span>:         cdef unsigned char R, G, B</pre>
<pre class="cython line score-0">&#xA0;<span class="">518</span>:         cdef unsigned short Rsum, Gsum, Bsum</pre>
<pre class="cython line score-0">&#xA0;<span class="">519</span>:         cdef unsigned char count, dx, dy</pre>
<pre class="cython line score-0">&#xA0;<span class="">520</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">521</span>:         self.validate_rgb_image(image)</pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_validate_rgb_image);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 521, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">522</span>:         pixels = image.get_pixels()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 522, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_pixels = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">523</span>:         cdef unsigned int input_stride = image.get_rowstride()</pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 523, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_input_stride = __pyx_t_4;
</pre><pre class="cython line score-70" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">524</span>:         log("do_RGB_to_YUV420P(%s, %i, %i, %i, %i) input=%s, strides=%s", image, Bpp, Rindex, Gindex, Bindex, len(pixels), input_stride)</pre>
<pre class='cython code score-70 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyInt_From_uint8_t(__pyx_v_Bpp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = __Pyx_PyInt_From_uint8_t(__pyx_v_Rindex);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyInt_From_uint8_t(__pyx_v_Gindex);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyInt_From_uint8_t(__pyx_v_Bindex);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_pixels);<span class='error_goto'> if (unlikely(__pyx_t_8 == ((Py_ssize_t)-1))) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  __pyx_t_9 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_input_stride);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  __pyx_t_11 = NULL;
  __pyx_t_12 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_11 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_11)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_11);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_12 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[9] = {__pyx_t_11, __pyx_kp_u_do_RGB_to_YUV420P_s_i_i_i_i_inpu, __pyx_v_image, __pyx_t_3, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_9, __pyx_t_10};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 8+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[9] = {__pyx_t_11, __pyx_kp_u_do_RGB_to_YUV420P_s_i_i_i_i_inpu, __pyx_v_image, __pyx_t_3, __pyx_t_5, __pyx_t_6, __pyx_t_7, __pyx_t_9, __pyx_t_10};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_12, 8+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  {
    __pyx_t_13 = <span class='py_c_api'>PyTuple_New</span>(8+__pyx_t_12);<span class='error_goto'> if (unlikely(!__pyx_t_13)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
    if (__pyx_t_11) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_11); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0, __pyx_t_11); __pyx_t_11 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_do_RGB_to_YUV420P_s_i_i_i_i_inpu);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_do_RGB_to_YUV420P_s_i_i_i_i_inpu);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 0+__pyx_t_12, __pyx_kp_u_do_RGB_to_YUV420P_s_i_i_i_i_inpu);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_image);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_image);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 1+__pyx_t_12, __pyx_v_image);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 2+__pyx_t_12, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 3+__pyx_t_12, __pyx_t_5);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 4+__pyx_t_12, __pyx_t_6);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 5+__pyx_t_12, __pyx_t_7);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 6+__pyx_t_12, __pyx_t_9);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_13, 7+__pyx_t_12, __pyx_t_10);
    __pyx_t_3 = 0;
    __pyx_t_5 = 0;
    __pyx_t_6 = 0;
    __pyx_t_7 = 0;
    __pyx_t_9 = 0;
    __pyx_t_10 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 524, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">525</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">526</span>:         #allocate output buffer:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">527</span>:         cdef unsigned char *output_image = &lt;unsigned char*&gt; memalign(self.buffer_size)</pre>
<pre class='cython code score-0 '>  __pyx_v_output_image = ((unsigned char *)__pyx_f_4xpra_7buffers_6membuf_memalign(__pyx_v_self-&gt;buffer_size));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">528</span>:         cdef unsigned char *Y = output_image + self.offsets[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_Y = (__pyx_v_output_image + (__pyx_v_self-&gt;offsets[0]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">529</span>:         cdef unsigned char *U = output_image + self.offsets[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_U = (__pyx_v_output_image + (__pyx_v_self-&gt;offsets[1]));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">530</span>:         cdef unsigned char *V = output_image + self.offsets[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_V = (__pyx_v_output_image + (__pyx_v_self-&gt;offsets[2]));
</pre><pre class="cython line score-0">&#xA0;<span class="">531</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">532</span>:         #copy to local variables (ensures C code will be optimized correctly)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">533</span>:         cdef unsigned int Ystride = self.dst_strides[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_Ystride = (__pyx_v_self-&gt;dst_strides[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">534</span>:         cdef unsigned int Ustride = self.dst_strides[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_Ustride = (__pyx_v_self-&gt;dst_strides[1]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">535</span>:         cdef unsigned int Vstride = self.dst_strides[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_Vstride = (__pyx_v_self-&gt;dst_strides[2]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">536</span>:         cdef unsigned int src_width = self.src_width</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;src_width;
  __pyx_v_src_width = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">537</span>:         cdef unsigned int src_height = self.src_height</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;src_height;
  __pyx_v_src_height = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">538</span>:         cdef unsigned int dst_width = self.dst_width</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;dst_width;
  __pyx_v_dst_width = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">539</span>:         cdef unsigned int dst_height = self.dst_height</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;dst_height;
  __pyx_v_dst_height = __pyx_t_4;
</pre><pre class="cython line score-0">&#xA0;<span class="">540</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">541</span>:         #we process 4 pixels at a time:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">542</span>:         cdef unsigned int workw = roundup(dst_width, 2)//2</pre>
<pre class='cython code score-0 '>  __pyx_v_workw = (__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup(__pyx_v_dst_width, 2) / 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">543</span>:         cdef unsigned int workh = roundup(dst_height, 2)//2</pre>
<pre class='cython code score-0 '>  __pyx_v_workh = (__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup(__pyx_v_dst_height, 2) / 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">544</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">545</span>:         cdef Py_buffer py_buf</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">546</span>:         if PyObject_GetBuffer(pixels, &amp;py_buf, PyBUF_ANY_CONTIGUOUS):</pre>
<pre class='cython code score-5 '>  __pyx_t_14 = (<span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_v_pixels, (&amp;__pyx_v_py_buf), PyBUF_ANY_CONTIGUOUS) != 0);
  if (unlikely(__pyx_t_14)) {
/* … */
  }
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">547</span>:             raise Exception("failed to read pixel data from %s" % type(pixels))</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_failed_to_read_pixel_data_from_s, ((PyObject *)Py_TYPE(__pyx_v_pixels)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 547, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 547, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='error_goto'>__PYX_ERR(0, 547, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">548</span>:         cdef const unsigned char *input_image = &lt;const unsigned char *&gt; py_buf.buf</pre>
<pre class='cython code score-0 '>  __pyx_v_input_image = ((unsigned char const *)__pyx_v_py_buf.buf);
</pre><pre class="cython line score-0">&#xA0;<span class="">549</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">550</span>:         #from now on, we can release the gil:</pre>
<pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">551</span>:         if self.src_format=="r210":</pre>
<pre class='cython code score-2 '>  __pyx_t_14 = (<span class='pyx_c_api'>__Pyx_PyUnicode_Equals</span>(__pyx_v_self-&gt;src_format, __pyx_n_u_r210, Py_EQ)); if (unlikely(__pyx_t_14 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 551, __pyx_L1_error)</span>
  if (__pyx_t_14) {
/* … */
    goto __pyx_L4;
  }
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">552</span>:             assert Bpp==4</pre>
<pre class='cython code score-5 '>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      if (unlikely(!((__pyx_v_Bpp == 4) != 0))) {
        <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
        <span class='error_goto'>__PYX_ERR(0, 552, __pyx_L1_error)</span>
      }
    }
    #endif
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">553</span>:             input_r210 = &lt;unsigned int*&gt; input_image</pre>
<pre class='cython code score-0 '>    __pyx_v_input_r210 = ((unsigned int *)__pyx_v_input_image);
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">554</span>:             with nogil:</pre>
<pre class='cython code score-4 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L7;
          }
          __pyx_L7:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">555</span>:                 for y in range(workh):</pre>
<pre class='cython code score-0 '>          __pyx_t_4 = __pyx_v_workh;
          __pyx_t_15 = __pyx_t_4;
          for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
            __pyx_v_y = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">556</span>:                     for x in range(workw):</pre>
<pre class='cython code score-0 '>            __pyx_t_17 = __pyx_v_workw;
            __pyx_t_18 = __pyx_t_17;
            for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
              __pyx_v_x = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">557</span>:                         Rsum = Gsum = Bsum = 0</pre>
<pre class='cython code score-0 '>              __pyx_v_Rsum = 0;
              __pyx_v_Gsum = 0;
              __pyx_v_Bsum = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">558</span>:                         count = 0</pre>
<pre class='cython code score-0 '>              __pyx_v_count = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">559</span>:                         for dy in range(2):</pre>
<pre class='cython code score-0 '>              for (__pyx_t_20 = 0; __pyx_t_20 &lt; 2; __pyx_t_20+=1) {
                __pyx_v_dy = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">560</span>:                             oy = y*2 + dy</pre>
<pre class='cython code score-0 '>                __pyx_v_oy = ((__pyx_v_y * 2) + __pyx_v_dy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">561</span>:                             if oy&gt;=dst_height:</pre>
<pre class='cython code score-0 '>                __pyx_t_14 = ((__pyx_v_oy &gt;= __pyx_v_dst_height) != 0);
                if (__pyx_t_14) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">562</span>:                                 break</pre>
<pre class='cython code score-0 '>                  goto __pyx_L13_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">563</span>:                             sy = oy*src_height//dst_height</pre>
<pre class='cython code score-0 '>                __pyx_v_sy = ((__pyx_v_oy * __pyx_v_src_height) / __pyx_v_dst_height);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">564</span>:                             for dx in range(2):</pre>
<pre class='cython code score-0 '>                for (__pyx_t_21 = 0; __pyx_t_21 &lt; 2; __pyx_t_21+=1) {
                  __pyx_v_dx = __pyx_t_21;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">565</span>:                                 ox = x*2 + dx</pre>
<pre class='cython code score-0 '>                  __pyx_v_ox = ((__pyx_v_x * 2) + __pyx_v_dx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">566</span>:                                 if ox&gt;=dst_width:</pre>
<pre class='cython code score-0 '>                  __pyx_t_14 = ((__pyx_v_ox &gt;= __pyx_v_dst_width) != 0);
                  if (__pyx_t_14) {
/* … */
                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">567</span>:                                     break</pre>
<pre class='cython code score-0 '>                    goto __pyx_L16_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">568</span>:                                 sx = ox*src_width//dst_width</pre>
<pre class='cython code score-0 '>                  __pyx_v_sx = ((__pyx_v_ox * __pyx_v_src_width) / __pyx_v_dst_width);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">569</span>:                                 o = sy*input_stride + sx*Bpp</pre>
<pre class='cython code score-0 '>                  __pyx_v_o = ((__pyx_v_sy * __pyx_v_input_stride) + (__pyx_v_sx * __pyx_v_Bpp));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">570</span>:                                 r210 = input_r210[o//4]</pre>
<pre class='cython code score-0 '>                  __pyx_v_r210 = (__pyx_v_input_r210[(__pyx_v_o / 4)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">571</span>:                                 B = (r210&amp;0x3ff00000) &gt;&gt; 22</pre>
<pre class='cython code score-0 '>                  __pyx_v_B = ((__pyx_v_r210 &amp; 0x3ff00000) &gt;&gt; 22);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">572</span>:                                 G = (r210&amp;0x000ffc00) &gt;&gt; 12</pre>
<pre class='cython code score-0 '>                  __pyx_v_G = ((__pyx_v_r210 &amp; 0x000ffc00) &gt;&gt; 12);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">573</span>:                                 R = (r210&amp;0x000003ff) &gt;&gt; 2</pre>
<pre class='cython code score-0 '>                  __pyx_v_R = ((__pyx_v_r210 &amp; 0x000003ff) &gt;&gt; 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">574</span>:                                 o = oy*Ystride + ox</pre>
<pre class='cython code score-0 '>                  __pyx_v_o = ((__pyx_v_oy * __pyx_v_Ystride) + __pyx_v_ox);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">575</span>:                                 Y[o] = clamp(YR * R + YG * G + YB * B + YC)</pre>
<pre class='cython code score-0 '>                  (__pyx_v_Y[__pyx_v_o]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp(((((0x4C8B * __pyx_v_R) + (0x9646 * __pyx_v_G)) + (0x1D2F * __pyx_v_B)) + 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">576</span>:                                 count += 1</pre>
<pre class='cython code score-0 '>                  __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">577</span>:                                 Rsum += R</pre>
<pre class='cython code score-0 '>                  __pyx_v_Rsum = (__pyx_v_Rsum + __pyx_v_R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">578</span>:                                 Gsum += G</pre>
<pre class='cython code score-0 '>                  __pyx_v_Gsum = (__pyx_v_Gsum + __pyx_v_G);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">579</span>:                                 Bsum += B</pre>
<pre class='cython code score-0 '>                  __pyx_v_Bsum = (__pyx_v_Bsum + __pyx_v_B);
                }
                __pyx_L16_break:;
              }
              __pyx_L13_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">580</span>:                         #write 1U and 1V:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">581</span>:                         if count&gt;0:</pre>
<pre class='cython code score-0 '>              __pyx_t_14 = ((__pyx_v_count &gt; 0) != 0);
              if (__pyx_t_14) {
/* … */
              }
            }
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">582</span>:                             U[y*Ustride + x] = clamp(UR * Rsum//count + UG * Gsum//count + UB * Bsum//count + UC)</pre>
<pre class='cython code score-0 '>                (__pyx_v_U[((__pyx_v_y * __pyx_v_Ustride) + __pyx_v_x)]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp((((((-11076L * __pyx_v_Rsum) / __pyx_v_count) + ((-21692L * __pyx_v_Gsum) / __pyx_v_count)) + ((0x8000 * __pyx_v_Bsum) / __pyx_v_count)) + 0x800000));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">583</span>:                             V[y*Vstride + x] = clamp(VR * Rsum//count + VG * Gsum//count + VB * Bsum//count + VC)</pre>
<pre class='cython code score-0 '>                (__pyx_v_V[((__pyx_v_y * __pyx_v_Vstride) + __pyx_v_x)]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp((((((0x8000 * __pyx_v_Rsum) / __pyx_v_count) + ((-27460L * __pyx_v_Gsum) / __pyx_v_count)) + ((-5308L * __pyx_v_Bsum) / __pyx_v_count)) + 0x800000));
</pre><pre class="cython line score-0">&#xA0;<span class="">584</span>:         else:</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">585</span>:             with nogil:</pre>
<pre class='cython code score-4 '>  /*else*/ {
    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L21;
          }
          __pyx_L21:;
        }
    }
  }
  __pyx_L4:;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">586</span>:                 for y in range(workh):</pre>
<pre class='cython code score-0 '>          __pyx_t_4 = __pyx_v_workh;
          __pyx_t_15 = __pyx_t_4;
          for (__pyx_t_16 = 0; __pyx_t_16 &lt; __pyx_t_15; __pyx_t_16+=1) {
            __pyx_v_y = __pyx_t_16;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">587</span>:                     for x in range(workw):</pre>
<pre class='cython code score-0 '>            __pyx_t_17 = __pyx_v_workw;
            __pyx_t_18 = __pyx_t_17;
            for (__pyx_t_19 = 0; __pyx_t_19 &lt; __pyx_t_18; __pyx_t_19+=1) {
              __pyx_v_x = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">588</span>:                         Rsum = Gsum = Bsum = 0</pre>
<pre class='cython code score-0 '>              __pyx_v_Rsum = 0;
              __pyx_v_Gsum = 0;
              __pyx_v_Bsum = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">589</span>:                         count = 0</pre>
<pre class='cython code score-0 '>              __pyx_v_count = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">590</span>:                         for dy in range(2):</pre>
<pre class='cython code score-0 '>              for (__pyx_t_20 = 0; __pyx_t_20 &lt; 2; __pyx_t_20+=1) {
                __pyx_v_dy = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">591</span>:                             oy = y*2 + dy</pre>
<pre class='cython code score-0 '>                __pyx_v_oy = ((__pyx_v_y * 2) + __pyx_v_dy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">592</span>:                             if oy&gt;=dst_height:</pre>
<pre class='cython code score-0 '>                __pyx_t_14 = ((__pyx_v_oy &gt;= __pyx_v_dst_height) != 0);
                if (__pyx_t_14) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">593</span>:                                 break</pre>
<pre class='cython code score-0 '>                  goto __pyx_L27_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">594</span>:                             sy = oy*src_height//dst_height</pre>
<pre class='cython code score-0 '>                __pyx_v_sy = ((__pyx_v_oy * __pyx_v_src_height) / __pyx_v_dst_height);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">595</span>:                             for dx in range(2):</pre>
<pre class='cython code score-0 '>                for (__pyx_t_21 = 0; __pyx_t_21 &lt; 2; __pyx_t_21+=1) {
                  __pyx_v_dx = __pyx_t_21;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">596</span>:                                 ox = x*2 + dx</pre>
<pre class='cython code score-0 '>                  __pyx_v_ox = ((__pyx_v_x * 2) + __pyx_v_dx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">597</span>:                                 if ox&gt;=dst_width:</pre>
<pre class='cython code score-0 '>                  __pyx_t_14 = ((__pyx_v_ox &gt;= __pyx_v_dst_width) != 0);
                  if (__pyx_t_14) {
/* … */
                  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">598</span>:                                     break</pre>
<pre class='cython code score-0 '>                    goto __pyx_L30_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">599</span>:                                 sx = ox*src_width//dst_width</pre>
<pre class='cython code score-0 '>                  __pyx_v_sx = ((__pyx_v_ox * __pyx_v_src_width) / __pyx_v_dst_width);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">600</span>:                                 o = sy*input_stride + sx*Bpp</pre>
<pre class='cython code score-0 '>                  __pyx_v_o = ((__pyx_v_sy * __pyx_v_input_stride) + (__pyx_v_sx * __pyx_v_Bpp));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">601</span>:                                 R = input_image[o + Rindex]</pre>
<pre class='cython code score-0 '>                  __pyx_v_R = (__pyx_v_input_image[(__pyx_v_o + __pyx_v_Rindex)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">602</span>:                                 G = input_image[o + Gindex]</pre>
<pre class='cython code score-0 '>                  __pyx_v_G = (__pyx_v_input_image[(__pyx_v_o + __pyx_v_Gindex)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">603</span>:                                 B = input_image[o + Bindex]</pre>
<pre class='cython code score-0 '>                  __pyx_v_B = (__pyx_v_input_image[(__pyx_v_o + __pyx_v_Bindex)]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">604</span>:                                 o = oy*Ystride + ox</pre>
<pre class='cython code score-0 '>                  __pyx_v_o = ((__pyx_v_oy * __pyx_v_Ystride) + __pyx_v_ox);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">605</span>:                                 Y[o] = clamp(YR * R + YG * G + YB * B + YC)</pre>
<pre class='cython code score-0 '>                  (__pyx_v_Y[__pyx_v_o]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp(((((0x4C8B * __pyx_v_R) + (0x9646 * __pyx_v_G)) + (0x1D2F * __pyx_v_B)) + 0));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">606</span>:                                 count += 1</pre>
<pre class='cython code score-0 '>                  __pyx_v_count = (__pyx_v_count + 1);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">607</span>:                                 Rsum += R</pre>
<pre class='cython code score-0 '>                  __pyx_v_Rsum = (__pyx_v_Rsum + __pyx_v_R);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">608</span>:                                 Gsum += G</pre>
<pre class='cython code score-0 '>                  __pyx_v_Gsum = (__pyx_v_Gsum + __pyx_v_G);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">609</span>:                                 Bsum += B</pre>
<pre class='cython code score-0 '>                  __pyx_v_Bsum = (__pyx_v_Bsum + __pyx_v_B);
                }
                __pyx_L30_break:;
              }
              __pyx_L27_break:;
</pre><pre class="cython line score-0">&#xA0;<span class="">610</span>:                         #write 1U and 1V:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">611</span>:                         if count&gt;0:</pre>
<pre class='cython code score-0 '>              __pyx_t_14 = ((__pyx_v_count &gt; 0) != 0);
              if (__pyx_t_14) {
/* … */
              }
            }
          }
        }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">612</span>:                             Rsum /= count</pre>
<pre class='cython code score-0 '>                __pyx_v_Rsum = (__pyx_v_Rsum / __pyx_v_count);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">613</span>:                             Gsum /= count</pre>
<pre class='cython code score-0 '>                __pyx_v_Gsum = (__pyx_v_Gsum / __pyx_v_count);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">614</span>:                             Bsum /= count</pre>
<pre class='cython code score-0 '>                __pyx_v_Bsum = (__pyx_v_Bsum / __pyx_v_count);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">615</span>:                             U[y*Ustride + x] = clamp(UR * Rsum + UG * Gsum + UB * Bsum + UC)</pre>
<pre class='cython code score-0 '>                (__pyx_v_U[((__pyx_v_y * __pyx_v_Ustride) + __pyx_v_x)]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp(((((-11076L * __pyx_v_Rsum) + (-21692L * __pyx_v_Gsum)) + (0x8000 * __pyx_v_Bsum)) + 0x800000));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">616</span>:                             V[y*Vstride + x] = clamp(VR * Rsum + VG * Gsum + VB * Bsum + VC)</pre>
<pre class='cython code score-0 '>                (__pyx_v_V[((__pyx_v_y * __pyx_v_Vstride) + __pyx_v_x)]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp(((((0x8000 * __pyx_v_Rsum) + (-27460L * __pyx_v_Gsum)) + (-5308L * __pyx_v_Bsum)) + 0x800000));
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">617</span>:         PyBuffer_Release(&amp;py_buf)</pre>
<pre class='cython code score-5 '>  <span class='py_c_api'>PyBuffer_Release</span>((&amp;__pyx_v_py_buf));
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">618</span>:         return self.planar3_image_wrapper(&lt;void *&gt; output_image)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;planar3_image_wrapper(__pyx_v_self, ((void *)__pyx_v_output_image), NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 618, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">619</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">620</span>:     cdef planar3_image_wrapper(self, void *buf, unsigned char bpp=24):</pre>
<pre class='cython code score-10 '>static PyObject *__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_planar3_image_wrapper(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, void *__pyx_v_buf, struct __pyx_opt_args_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_planar3_image_wrapper *__pyx_optional_args) {
  unsigned char __pyx_v_bpp = ((unsigned char)24);
  PyObject *__pyx_v_planes = NULL;
  PyObject *__pyx_v_strides = NULL;
  unsigned char __pyx_v_i;
  PyObject *__pyx_v_out_image = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("planar3_image_wrapper", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_bpp = __pyx_optional_args-&gt;bpp;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.planar3_image_wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_planes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_strides);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_image);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_planar3_image_wrapper {
  int __pyx_n;
  unsigned char bpp;
};
</pre><pre class="cython line score-0">&#xA0;<span class="">621</span>:         #create python buffer from each plane:</pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">622</span>:         planes = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 622, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_planes = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">623</span>:         strides = []</pre>
<pre class='cython code score-5 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 623, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_strides = ((PyObject*)__pyx_t_1);
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">624</span>:         cdef unsigned char i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">625</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_2 = 0; __pyx_t_2 &lt; 3; __pyx_t_2+=1) {
    __pyx_v_i = __pyx_t_2;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">626</span>:             strides.append(self.dst_strides[i])</pre>
<pre class='cython code score-5 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_v_self-&gt;dst_strides[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 626, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_strides, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 626, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">627</span>:             planes.append(PyMemoryView_FromMemory(&lt;char *&gt; ((&lt;uintptr_t&gt; buf) + self.offsets[i]), self.dst_sizes[i], True))</pre>
<pre class='cython code score-3 '>    __pyx_t_1 = PyMemoryView_FromMemory(((char *)(((uintptr_t)__pyx_v_buf) + (__pyx_v_self-&gt;offsets[__pyx_v_i]))), (__pyx_v_self-&gt;dst_sizes[__pyx_v_i]), 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 627, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyList_Append</span>(__pyx_v_planes, __pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_3 == ((int)-1))) __PYX_ERR(0, 627, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  }
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">628</span>:         out_image = CythonImageWrapper(0, 0, self.dst_width, self.dst_height,</pre>
<pre class='cython code score-29 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_CythonImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_width);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_height);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
/* … */
  __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3, __pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_planes);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_planes);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 4, __pyx_v_planes);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;dst_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;dst_format);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 5, __pyx_v_self-&gt;dst_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 6, __pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_strides);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_strides);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 7, __pyx_v_strides);
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
/* … */
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_7, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 628, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  __pyx_v_out_image = __pyx_t_4;
  __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">629</span>:                                        planes, self.dst_format, bpp, strides,</pre>
<pre class='cython code score-2 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_bpp);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 629, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
</pre><pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">630</span>:                                        planes=ImageWrapper.PLANAR_3)</pre>
<pre class='cython code score-13 '>  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_5, __pyx_n_s_ImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_5, __pyx_n_s_PLANAR_3);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_6, __pyx_n_s_planes, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 630, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">631</span>:         out_image.cython_buffer = &lt;uintptr_t&gt; buf</pre>
<pre class='cython code score-5 '>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(((uintptr_t)__pyx_v_buf));<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_out_image, __pyx_n_s_cython_buffer, __pyx_t_4) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 631, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">632</span>:         return out_image</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out_image);
  __pyx_r = __pyx_v_out_image;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">633</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">634</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">635</span>:     def validate_rgb_image(self, image):</pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_39validate_rgb_image(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_39validate_rgb_image(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("validate_rgb_image (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_38validate_rgb_image(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_38validate_rgb_image(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("validate_rgb_image", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.validate_rgb_image", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">636</span>:         assert image.get_planes()==ImageWrapper.PACKED, "invalid input format: %s planes" % image.get_planes()</pre>
<pre class='cython code score-60 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_planes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_ImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_PACKED);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_planes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_2 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_invalid_input_format_s_planes, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 636, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 636, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-88" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">637</span>:         assert image.get_width()&gt;=self.src_width, "invalid image width: %s (minimum is %s)" % (image.get_width(), self.src_width)</pre>
<pre class='cython code score-88 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_3 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_6 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_image_width);
      __pyx_t_5 += 21;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_image_width);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_invalid_image_width);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_width);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_2 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_2), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_minimum_is);
      __pyx_t_5 += 13;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_minimum_is);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_minimum_is);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;src_width, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_5 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u__4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 5, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 637, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 637, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-88" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">638</span>:         assert image.get_height()&gt;=self.src_height, "invalid image height: %s (minimum is %s)" % (image.get_height(), self.src_height)</pre>
<pre class='cython code score-88 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_3 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = 0;
      __pyx_t_6 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_image_height);
      __pyx_t_5 += 22;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_image_height);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_invalid_image_height);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_height);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_1 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_1), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_minimum_is);
      __pyx_t_5 += 13;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_minimum_is);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_minimum_is);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;src_height, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_5 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, __pyx_kp_u__4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 5, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 638, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 638, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">639</span>:         assert image.get_pixels(), "failed to get pixels from %s" % image</pre>
<pre class='cython code score-29 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_3 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_failed_to_get_pixels_from_s, __pyx_v_image);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 639, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 639, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">640</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">641</span>:     def r210_to_YUV444P10(self, image):</pre>
<pre class='cython code score-10 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_41r210_to_YUV444P10(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_41r210_to_YUV444P10(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("r210_to_YUV444P10 (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_40r210_to_YUV444P10(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_40r210_to_YUV444P10(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_v_pixels = NULL;
  unsigned int __pyx_v_input_stride;
  void *__pyx_v_output_image;
  unsigned short *__pyx_v_Y;
  unsigned short *__pyx_v_U;
  unsigned short *__pyx_v_V;
  unsigned int __pyx_v_Ystride;
  unsigned int __pyx_v_Ustride;
  unsigned int __pyx_v_Vstride;
  uintptr_t __pyx_v_buf;
  PyObject *__pyx_v_bc = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("r210_to_YUV444P10", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.r210_to_YUV444P10", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pixels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bc);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">642</span>:         self.validate_rgb_image(image)</pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_validate_rgb_image);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 642, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 642, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">643</span>:         pixels = image.get_pixels()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 643, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_pixels = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">644</span>:         cdef unsigned int input_stride = image.get_rowstride()</pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 644, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 644, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 644, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_input_stride = __pyx_t_4;
</pre><pre class="cython line score-58" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">645</span>:         log("r210_to_YUV444P10(%s) input=%s, strides=%s", image, len(pixels), input_stride)</pre>
<pre class='cython code score-58 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_pixels);<span class='error_goto'> if (unlikely(__pyx_t_5 == ((Py_ssize_t)-1))) __PYX_ERR(0, 645, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_input_stride);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = NULL;
  __pyx_t_8 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_8 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_kp_u_r210_to_YUV444P10_s_input_s_stri, __pyx_v_image, __pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[5] = {__pyx_t_7, __pyx_kp_u_r210_to_YUV444P10_s_input_s_stri, __pyx_v_image, __pyx_t_3, __pyx_t_6};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_8, 4+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  } else
  #endif
  {
    __pyx_t_9 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_r210_to_YUV444P10_s_input_s_stri);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_r210_to_YUV444P10_s_input_s_stri);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 0+__pyx_t_8, __pyx_kp_u_r210_to_YUV444P10_s_input_s_stri);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_image);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_image);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 1+__pyx_t_8, __pyx_v_image);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 2+__pyx_t_8, __pyx_t_3);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_9, 3+__pyx_t_8, __pyx_t_6);
    __pyx_t_3 = 0;
    __pyx_t_6 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 645, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">646</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">647</span>:         #allocate output buffer:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">648</span>:         cdef void *output_image = memalign(self.buffer_size)</pre>
<pre class='cython code score-0 '>  __pyx_v_output_image = __pyx_f_4xpra_7buffers_6membuf_memalign(__pyx_v_self-&gt;buffer_size);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">649</span>:         cdef unsigned short *Y = &lt;unsigned short *&gt; ((&lt;uintptr_t&gt; output_image) + self.offsets[0])</pre>
<pre class='cython code score-0 '>  __pyx_v_Y = ((unsigned short *)(((uintptr_t)__pyx_v_output_image) + (__pyx_v_self-&gt;offsets[0])));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">650</span>:         cdef unsigned short *U = &lt;unsigned short *&gt; ((&lt;uintptr_t&gt; output_image) + self.offsets[1])</pre>
<pre class='cython code score-0 '>  __pyx_v_U = ((unsigned short *)(((uintptr_t)__pyx_v_output_image) + (__pyx_v_self-&gt;offsets[1])));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">651</span>:         cdef unsigned short *V = &lt;unsigned short *&gt; ((&lt;uintptr_t&gt; output_image) + self.offsets[2])</pre>
<pre class='cython code score-0 '>  __pyx_v_V = ((unsigned short *)(((uintptr_t)__pyx_v_output_image) + (__pyx_v_self-&gt;offsets[2])));
</pre><pre class="cython line score-0">&#xA0;<span class="">652</span>:         #copy to local variables (ensures C code will be optimized correctly)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">653</span>:         cdef unsigned int Ystride = self.dst_strides[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_Ystride = (__pyx_v_self-&gt;dst_strides[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">654</span>:         cdef unsigned int Ustride = self.dst_strides[1]</pre>
<pre class='cython code score-0 '>  __pyx_v_Ustride = (__pyx_v_self-&gt;dst_strides[1]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">655</span>:         cdef unsigned int Vstride = self.dst_strides[2]</pre>
<pre class='cython code score-0 '>  __pyx_v_Vstride = (__pyx_v_self-&gt;dst_strides[2]);
</pre><pre class="cython line score-0">&#xA0;<span class="">656</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">657</span>:         cdef uintptr_t buf</pre>
<pre class="cython line score-65" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">658</span>:         with buffer_context(pixels) as bc:</pre>
<pre class='cython code score-65 '>  /*with:*/ {
    __pyx_t_1 = __pyx_f_4xpra_7buffers_6membuf_buffer_context(__pyx_v_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 658, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_6 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_9))) {
      __pyx_t_6 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_9);
      if (likely(__pyx_t_6)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_9);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_9, function);
      }
    }
    __pyx_t_2 = (__pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_9, __pyx_t_6) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_9);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    __pyx_t_9 = __pyx_t_2;
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    /*try:*/ {
      {
        /*try:*/ {
          __pyx_v_bc = __pyx_t_9;
          __pyx_t_9 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        goto __pyx_L12_try_end;
        __pyx_L7_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.r210_to_YUV444P10", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_9, &amp;__pyx_t_1, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_6 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_9, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 658, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
          __pyx_t_16 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_t_6, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
          if (unlikely(!__pyx_t_16)) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_16);
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_16);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_16); __pyx_t_16 = 0;
          if (__pyx_t_15 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L9_except_error)</span>
          __pyx_t_17 = ((!(__pyx_t_15 != 0)) != 0);
          if (__pyx_t_17) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
            <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_9, __pyx_t_1, __pyx_t_2);
            __pyx_t_9 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0; 
            <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L9_except_error)</span>
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          goto __pyx_L8_exception_handled;
        }
        __pyx_L9_except_error:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
        goto __pyx_L1_error;
        __pyx_L8_exception_handled:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_13);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_11, __pyx_t_12, __pyx_t_13);
        __pyx_L12_try_end:;
      }
    }
    /*finally:*/ {
      /*normal exit:*/{
        if (__pyx_t_10) {
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_10, __pyx_tuple__16, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
          if (unlikely(!__pyx_t_13)) <span class='error_goto'>__PYX_ERR(0, 658, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_13);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_13); __pyx_t_13 = 0;
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
    }
    goto __pyx_L20;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    goto __pyx_L1_error;
    __pyx_L20:;
  }
/* … */
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(3, Py_None, Py_None, Py_None);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) __PYX_ERR(0, 658, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">659</span>:             buf = &lt;uintptr_t&gt; int(bc)</pre>
<pre class='cython code score-10 '>          __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_bc);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 659, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_t_9); if (unlikely((__pyx_t_14 == ((uintptr_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 659, __pyx_L7_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          __pyx_v_buf = ((uintptr_t)__pyx_t_14);
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">660</span>:             if image.is_thread_safe():</pre>
<pre class='cython code score-21 '>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_is_thread_safe);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 660, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_2 = NULL;
          if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
            __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
            if (likely(__pyx_t_2)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
            }
          }
          __pyx_t_9 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          if (unlikely(!__pyx_t_9)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_9); if (unlikely(__pyx_t_15 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 660, __pyx_L7_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          if (__pyx_t_15) {
/* … */
            goto __pyx_L13;
          }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">661</span>:                 with nogil:</pre>
<pre class='cython code score-4 '>            {
                #ifdef WITH_THREAD
                PyThreadState *_save;
                Py_UNBLOCK_THREADS
                <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
                #endif
                /*try:*/ {
/* … */
                /*finally:*/ {
                  /*normal exit:*/{
                    #ifdef WITH_THREAD
                    <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
                    Py_BLOCK_THREADS
                    #endif
                    goto __pyx_L16;
                  }
                  __pyx_L16:;
                }
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">662</span>:                     r210_to_YUV444P10_copy(Y, U, V, buf,</pre>
<pre class='cython code score-0 '>                  __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_r210_to_YUV444P10_copy(__pyx_v_Y, __pyx_v_U, __pyx_v_V, __pyx_v_buf, __pyx_v_self-&gt;dst_width, __pyx_v_self-&gt;dst_height, __pyx_v_Ystride, __pyx_v_Ustride, __pyx_v_Vstride, __pyx_v_input_stride);
                }
</pre><pre class="cython line score-0">&#xA0;<span class="">663</span>:                                            self.dst_width, self.dst_height,</pre>
<pre class="cython line score-0">&#xA0;<span class="">664</span>:                                            Ystride, Ustride, Vstride,</pre>
<pre class="cython line score-0">&#xA0;<span class="">665</span>:                                            input_stride)</pre>
<pre class="cython line score-0">&#xA0;<span class="">666</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">667</span>:                 r210_to_YUV444P10_copy(Y, U, V, buf,</pre>
<pre class='cython code score-0 '>          /*else*/ {
/* … */
            __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_r210_to_YUV444P10_copy(__pyx_v_Y, __pyx_v_U, __pyx_v_V, __pyx_v_buf, __pyx_v_self-&gt;dst_width, __pyx_v_self-&gt;dst_height, __pyx_v_Ystride, __pyx_v_Ustride, __pyx_v_Vstride, __pyx_v_input_stride);
          }
          __pyx_L13:;
</pre><pre class="cython line score-0">&#xA0;<span class="">668</span>:                                        self.dst_width, self.dst_height,</pre>
<pre class="cython line score-0">&#xA0;<span class="">669</span>:                                        Ystride, Ustride, Vstride,</pre>
<pre class="cython line score-0">&#xA0;<span class="">670</span>:                                        input_stride)</pre>
<pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">671</span>:         return self.planar3_image_wrapper(output_image)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_2 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;planar3_image_wrapper(__pyx_v_self, __pyx_v_output_image, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 671, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">672</span>: </pre>
<pre class="cython line score-9" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">673</span>:     def YUV444P10_to_r210(self, image):</pre>
<pre class='cython code score-9 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_43YUV444P10_to_r210(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_43YUV444P10_to_r210(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV444P10_to_r210 (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_42YUV444P10_to_r210(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_42YUV444P10_to_r210(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_v_planes = NULL;
  PyObject *__pyx_v_input_strides = NULL;
  unsigned int __pyx_v_width;
  unsigned int __pyx_v_height;
  char *__pyx_v_output_image;
  unsigned int __pyx_v_stride;
  unsigned int __pyx_v_YUVstrides[3];
  Py_buffer __pyx_v_py_buf[3];
  unsigned short const *__pyx_v_YUV[3];
  int __pyx_v_i;
  PyObject *__pyx_v_min_len = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV444P10_to_r210", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.YUV444P10_to_r210", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_planes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_input_strides);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_min_len);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">674</span>:         self.validate_planar3_image(image)</pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_validate_planar3_image);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 674, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">675</span>:         planes = image.get_pixels()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 675, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_planes = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">676</span>:         input_strides = image.get_rowstride()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 676, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 676, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_input_strides = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-42" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">677</span>:         log("YUV444P10_to_r210(%s) strides=%s", image, input_strides)</pre>
<pre class='cython code score-42 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_kp_u_YUV444P10_to_r210_s_strides_s, __pyx_v_image, __pyx_v_input_strides};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_kp_u_YUV444P10_to_r210_s_strides_s, __pyx_v_image, __pyx_v_input_strides};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_YUV444P10_to_r210_s_strides_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_YUV444P10_to_r210_s_strides_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_kp_u_YUV444P10_to_r210_s_strides_s);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_image);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_image);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, __pyx_v_image);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_input_strides);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_input_strides);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_v_input_strides);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 677, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">678</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">679</span>:         #copy to local variables:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">680</span>:         cdef unsigned int width = self.dst_width</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;dst_width;
  __pyx_v_width = __pyx_t_6;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">681</span>:         cdef unsigned int height = self.dst_height</pre>
<pre class='cython code score-0 '>  __pyx_t_6 = __pyx_v_self-&gt;dst_height;
  __pyx_v_height = __pyx_t_6;
</pre><pre class="cython line score-0">&#xA0;<span class="">682</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">683</span>:         #allocate output buffer:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">684</span>:         cdef char *output_image = &lt;char *&gt; memalign(self.buffer_size)</pre>
<pre class='cython code score-0 '>  __pyx_v_output_image = ((char *)__pyx_f_4xpra_7buffers_6membuf_memalign(__pyx_v_self-&gt;buffer_size));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">685</span>:         cdef unsigned int stride = self.dst_strides[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_stride = (__pyx_v_self-&gt;dst_strides[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">686</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">687</span>:         cdef unsigned int YUVstrides[3]</pre>
<pre class="cython line score-0">&#xA0;<span class="">688</span>:         cdef Py_buffer py_buf[3]</pre>
<pre class="cython line score-0">&#xA0;<span class="">689</span>:         cdef const unsigned short * YUV[3]</pre>
<pre class="cython line score-0">&#xA0;<span class="">690</span>:         cdef int i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">691</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">692</span>:             YUVstrides[i] = input_strides[i]</pre>
<pre class='cython code score-10 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 692, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_6 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 692, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    (__pyx_v_YUVstrides[__pyx_v_i]) = __pyx_t_6;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">693</span>:             if PyObject_GetBuffer(planes[i], &amp;py_buf[i], PyBUF_ANY_CONTIGUOUS):</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_planes, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 693, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_7 = (<span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_t_1, (&amp;(__pyx_v_py_buf[__pyx_v_i])), PyBUF_ANY_CONTIGUOUS) != 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(__pyx_t_7)) {
/* … */
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">694</span>:                 raise Exception("failed to read pixel data from %s" % type(planes[i]))</pre>
<pre class='cython code score-11 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_planes, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_failed_to_read_pixel_data_from_s, ((PyObject *)Py_TYPE(__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 694, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 694, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">695</span>:             YUV[i] = &lt;const unsigned short *&gt; py_buf[i].buf</pre>
<pre class='cython code score-0 '>    (__pyx_v_YUV[__pyx_v_i]) = ((unsigned short const *)(__pyx_v_py_buf[__pyx_v_i]).buf);
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">696</span>:             min_len = YUVstrides[i]*image.get_height()</pre>
<pre class='cython code score-28 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>((__pyx_v_YUVstrides[__pyx_v_i]));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_height);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_5))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_5);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_5, function);
      }
    }
    __pyx_t_2 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_5, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    __pyx_t_5 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 696, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_min_len, __pyx_t_5);
    __pyx_t_5 = 0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">697</span>:             assert py_buf.len&gt;=min_len, "buffer for Y plane is too small: %s bytes, expected at least %s" % (py_buf.len, min_len)</pre>
<pre class='cython code score-51 '>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_5 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_py_buf-&gt;len);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_5, __pyx_v_min_len, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 697, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_7)) {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_8 = 0;
        __pyx_t_9 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_buffer_for_Y_plane_is_too_small);
        __pyx_t_8 += 33;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_buffer_for_Y_plane_is_too_small);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_buffer_for_Y_plane_is_too_small);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_v_py_buf-&gt;len, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_8 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_5);
        __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_bytes_expected_at_least);
        __pyx_t_8 += 26;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_bytes_expected_at_least);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_bytes_expected_at_least);
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_min_len), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        __pyx_t_9 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) &gt; __pyx_t_9) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_5) : __pyx_t_9;
        __pyx_t_8 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_5);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_5);
        __pyx_t_5 = 0;
        __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 4, __pyx_t_8, __pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 697, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_5);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='error_goto'>__PYX_ERR(0, 697, __pyx_L1_error)</span>
      }
    }
    #endif
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">698</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">699</span>:         if image.is_thread_safe():</pre>
<pre class='cython code score-21 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_is_thread_safe);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_1)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_5 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (unlikely(!__pyx_t_5)) <span class='error_goto'>__PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_5); if (unlikely(__pyx_t_7 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 699, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  if (__pyx_t_7) {
/* … */
    goto __pyx_L6;
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">700</span>:             with nogil:</pre>
<pre class='cython code score-4 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L9;
          }
          __pyx_L9:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">701</span>:                 YUV444P10_to_r210_copy(&lt;uintptr_t&gt; output_image, YUV[0], YUV[1], YUV[2],</pre>
<pre class='cython code score-0 '>          __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_YUV444P10_to_r210_copy(((uintptr_t)__pyx_v_output_image), (__pyx_v_YUV[0]), (__pyx_v_YUV[1]), (__pyx_v_YUV[2]), __pyx_v_width, __pyx_v_height, __pyx_v_stride, (__pyx_v_YUVstrides[0]), (__pyx_v_YUVstrides[1]), (__pyx_v_YUVstrides[2]));
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">702</span>:                                        width, height,</pre>
<pre class="cython line score-0">&#xA0;<span class="">703</span>:                                        stride,</pre>
<pre class="cython line score-0">&#xA0;<span class="">704</span>:                                        YUVstrides[0], YUVstrides[1], YUVstrides[2])</pre>
<pre class="cython line score-0">&#xA0;<span class="">705</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">706</span>:             YUV444P10_to_r210_copy(&lt;uintptr_t&gt; output_image, YUV[0], YUV[1], YUV[2],</pre>
<pre class='cython code score-0 '>  /*else*/ {
/* … */
    __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_YUV444P10_to_r210_copy(((uintptr_t)__pyx_v_output_image), (__pyx_v_YUV[0]), (__pyx_v_YUV[1]), (__pyx_v_YUV[2]), __pyx_v_width, __pyx_v_height, __pyx_v_stride, (__pyx_v_YUVstrides[0]), (__pyx_v_YUVstrides[1]), (__pyx_v_YUVstrides[2]));
  }
  __pyx_L6:;
</pre><pre class="cython line score-0">&#xA0;<span class="">707</span>:                                    width, height,</pre>
<pre class="cython line score-0">&#xA0;<span class="">708</span>:                                    stride,</pre>
<pre class="cython line score-0">&#xA0;<span class="">709</span>:                                    YUVstrides[0], YUVstrides[1], YUVstrides[2])</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">710</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">711</span>:             PyBuffer_Release(&amp;py_buf[i])</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyBuffer_Release</span>((&amp;(__pyx_v_py_buf[__pyx_v_i])));
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">712</span>:         return self.packed_image_wrapper(output_image, 30)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_10.__pyx_n = 1;
  __pyx_t_10.bpp = 30;
  __pyx_t_5 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;packed_image_wrapper(__pyx_v_self, __pyx_v_output_image, &amp;__pyx_t_10);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 712, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_r = __pyx_t_5;
  __pyx_t_5 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">713</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">714</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">715</span>:     def r210_to_BGR48(self, image):</pre>
<pre class='cython code score-10 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_45r210_to_BGR48(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_45r210_to_BGR48(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("r210_to_BGR48 (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_44r210_to_BGR48(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_44r210_to_BGR48(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_v_pixels = NULL;
  PyObject *__pyx_v_input_stride = NULL;
  unsigned short *__pyx_v_bgr48;
  unsigned int __pyx_v_w;
  unsigned int __pyx_v_h;
  unsigned int __pyx_v_src_stride;
  unsigned int __pyx_v_dst_stride;
  unsigned int const *__pyx_v_r210;
  PyObject *__pyx_v_bc = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("r210_to_BGR48", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.r210_to_BGR48", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pixels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_input_stride);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_bc);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">716</span>:         self.validate_rgb_image(image)</pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_validate_rgb_image);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 716, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 716, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">717</span>:         pixels = image.get_pixels()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 717, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_pixels = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">718</span>:         input_stride = image.get_rowstride()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 718, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_input_stride = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">719</span>:         log("r210_to_BGR48(%s) input=%s, strides=%s", image, len(pixels), input_stride)</pre>
<pre class='cython code score-55 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_4 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_pixels);<span class='error_goto'> if (unlikely(__pyx_t_4 == ((Py_ssize_t)-1))) __PYX_ERR(0, 719, __pyx_L1_error)</span>
  __pyx_t_3 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_5 = NULL;
  __pyx_t_6 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_5 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_5)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_5);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_6 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_kp_u_r210_to_BGR48_s_input_s_strides, __pyx_v_image, __pyx_t_3, __pyx_v_input_stride};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[5] = {__pyx_t_5, __pyx_kp_u_r210_to_BGR48_s_input_s_strides, __pyx_v_image, __pyx_t_3, __pyx_v_input_stride};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_6, 4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else
  #endif
  {
    __pyx_t_7 = <span class='py_c_api'>PyTuple_New</span>(4+__pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    if (__pyx_t_5) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0, __pyx_t_5); __pyx_t_5 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_r210_to_BGR48_s_input_s_strides);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_r210_to_BGR48_s_input_s_strides);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 0+__pyx_t_6, __pyx_kp_u_r210_to_BGR48_s_input_s_strides);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_image);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_image);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 1+__pyx_t_6, __pyx_v_image);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 2+__pyx_t_6, __pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_input_stride);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_input_stride);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_7, 3+__pyx_t_6, __pyx_v_input_stride);
    __pyx_t_3 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 719, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">720</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">721</span>:         #allocate output buffer:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">722</span>:         cdef unsigned short *bgr48 = &lt;unsigned short*&gt; memalign(self.dst_sizes[0])</pre>
<pre class='cython code score-0 '>  __pyx_v_bgr48 = ((unsigned short *)__pyx_f_4xpra_7buffers_6membuf_memalign((__pyx_v_self-&gt;dst_sizes[0])));
</pre><pre class="cython line score-0">&#xA0;<span class="">723</span>: </pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">724</span>:         cdef unsigned int w = self.src_width</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_self-&gt;src_width;
  __pyx_v_w = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">725</span>:         cdef unsigned int h = self.src_height</pre>
<pre class='cython code score-0 '>  __pyx_t_8 = __pyx_v_self-&gt;src_height;
  __pyx_v_h = __pyx_t_8;
</pre><pre class="cython line score-26" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">726</span>:         cdef unsigned int src_stride = image.get_rowstride()</pre>
<pre class='cython code score-26 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_7 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_8 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 726, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_src_stride = __pyx_t_8;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">727</span>:         cdef unsigned int dst_stride = self.dst_strides[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_dst_stride = (__pyx_v_self-&gt;dst_strides[0]);
</pre><pre class="cython line score-0">&#xA0;<span class="">728</span>: </pre>
<pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">729</span>:         assert (dst_stride%2)==0</pre>
<pre class='cython code score-5 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_dst_stride % 2) == 0) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 729, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">730</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">731</span>:         cdef const unsigned int *r210</pre>
<pre class="cython line score-59" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">732</span>:         with buffer_context(pixels) as bc:</pre>
<pre class='cython code score-59 '>  /*with:*/ {
    __pyx_t_1 = __pyx_f_4xpra_7buffers_6membuf_buffer_context(__pyx_v_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_exit);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 732, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_LookupSpecial</span>(__pyx_t_1, __pyx_n_s_enter);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 732, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
      }
    }
    __pyx_t_2 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L3_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_7 = __pyx_t_2;
    __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    /*try:*/ {
      {
        /*try:*/ {
          __pyx_v_bc = __pyx_t_7;
          __pyx_t_7 = 0;
/* … */
        }
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        goto __pyx_L12_try_end;
        __pyx_L7_error:;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
        <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
        /*except:*/ {
          <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.r210_to_BGR48", __pyx_clineno, __pyx_lineno, __pyx_filename);
          if (<span class='pyx_c_api'>__Pyx_GetException</span>(&amp;__pyx_t_7, &amp;__pyx_t_1, &amp;__pyx_t_2) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
          __pyx_t_3 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_t_7, __pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 732, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
          __pyx_t_15 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_t_3, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
          if (unlikely(!__pyx_t_15)) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L9_except_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_15);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
          if (__pyx_t_14 &lt; 0) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L9_except_error)</span>
          __pyx_t_16 = ((!(__pyx_t_14 != 0)) != 0);
          if (__pyx_t_16) {
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
            <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
            <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_2);
            <span class='pyx_c_api'>__Pyx_ErrRestoreWithState</span>(__pyx_t_7, __pyx_t_1, __pyx_t_2);
            __pyx_t_7 = 0; __pyx_t_1 = 0; __pyx_t_2 = 0; 
            <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L9_except_error)</span>
          }
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          goto __pyx_L8_exception_handled;
        }
        __pyx_L9_except_error:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);
        goto __pyx_L1_error;
        __pyx_L8_exception_handled:;
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_10);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_11);
        <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_t_12);
        <span class='pyx_c_api'>__Pyx_ExceptionReset</span>(__pyx_t_10, __pyx_t_11, __pyx_t_12);
        __pyx_L12_try_end:;
      }
    }
    /*finally:*/ {
      /*normal exit:*/{
        if (__pyx_t_9) {
          __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_9, __pyx_tuple__16, NULL);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
          if (unlikely(!__pyx_t_12)) <span class='error_goto'>__PYX_ERR(0, 732, __pyx_L1_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_12);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_12); __pyx_t_12 = 0;
        }
        goto __pyx_L6;
      }
      __pyx_L6:;
    }
    goto __pyx_L20;
    __pyx_L3_error:;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    goto __pyx_L1_error;
    __pyx_L20:;
  }
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">733</span>:             r210 = &lt;const unsigned int*&gt; (&lt;uintptr_t&gt; int(bc))</pre>
<pre class='cython code score-10 '>          __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyNumber_Int</span>(__pyx_v_bc);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 733, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyInt_As_size_t</span>(__pyx_t_7); if (unlikely((__pyx_t_13 == ((uintptr_t)-1)) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 733, __pyx_L7_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          __pyx_v_r210 = ((unsigned int const *)((uintptr_t)__pyx_t_13));
</pre><pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">734</span>:             if image.is_thread_safe():</pre>
<pre class='cython code score-21 '>          __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_is_thread_safe);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 734, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
          __pyx_t_2 = NULL;
          if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
            __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
            if (likely(__pyx_t_2)) {
              PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
              <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
              <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
            }
          }
          __pyx_t_7 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
          if (unlikely(!__pyx_t_7)) <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L7_error)</span>
          <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
          __pyx_t_14 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_7); if (unlikely(__pyx_t_14 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 734, __pyx_L7_error)</span>
          <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
          if (__pyx_t_14) {
/* … */
            goto __pyx_L13;
          }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">735</span>:                 with nogil:</pre>
<pre class='cython code score-4 '>            {
                #ifdef WITH_THREAD
                PyThreadState *_save;
                Py_UNBLOCK_THREADS
                <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
                #endif
                /*try:*/ {
/* … */
                /*finally:*/ {
                  /*normal exit:*/{
                    #ifdef WITH_THREAD
                    <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
                    Py_BLOCK_THREADS
                    #endif
                    goto __pyx_L16;
                  }
                  __pyx_L16:;
                }
            }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">736</span>:                     r210_to_BGR48_copy(bgr48, r210, w, h, src_stride, dst_stride)</pre>
<pre class='cython code score-0 '>                  __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_r210_to_BGR48_copy(__pyx_v_bgr48, __pyx_v_r210, __pyx_v_w, __pyx_v_h, __pyx_v_src_stride, __pyx_v_dst_stride);
                }
</pre><pre class="cython line score-0">&#xA0;<span class="">737</span>:             else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">738</span>:                 r210_to_BGR48_copy(bgr48, r210, w, h, src_stride, dst_stride)</pre>
<pre class='cython code score-0 '>          /*else*/ {
            __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_r210_to_BGR48_copy(__pyx_v_bgr48, __pyx_v_r210, __pyx_v_w, __pyx_v_h, __pyx_v_src_stride, __pyx_v_dst_stride);
          }
          __pyx_L13:;
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">739</span>:         return self.packed_image_wrapper(&lt;char *&gt; bgr48, 48)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_17.__pyx_n = 1;
  __pyx_t_17.bpp = 48;
  __pyx_t_2 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;packed_image_wrapper(__pyx_v_self, ((char *)__pyx_v_bgr48), &amp;__pyx_t_17);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 739, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_r = __pyx_t_2;
  __pyx_t_2 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">740</span>: </pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">741</span>:     cdef packed_image_wrapper(self, char *buf, unsigned char bpp=24):</pre>
<pre class='cython code score-10 '>static PyObject *__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_packed_image_wrapper(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, char *__pyx_v_buf, struct __pyx_opt_args_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_packed_image_wrapper *__pyx_optional_args) {
  unsigned char __pyx_v_bpp = ((unsigned char)24);
  PyObject *__pyx_v_pybuf = NULL;
  PyObject *__pyx_v_out_image = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("packed_image_wrapper", 0);
  if (__pyx_optional_args) {
    if (__pyx_optional_args-&gt;__pyx_n &gt; 0) {
      __pyx_v_bpp = __pyx_optional_args-&gt;bpp;
    }
  }
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.packed_image_wrapper", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pybuf);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_out_image);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
struct __pyx_opt_args_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_packed_image_wrapper {
  int __pyx_n;
  unsigned char bpp;
};
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">742</span>:         pybuf = PyMemoryView_FromMemory(buf, self.dst_sizes[0], True)</pre>
<pre class='cython code score-0 '>  __pyx_t_1 = PyMemoryView_FromMemory(__pyx_v_buf, (__pyx_v_self-&gt;dst_sizes[0]), 1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 742, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_v_pybuf = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-45" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">743</span>:         out_image = CythonImageWrapper(0, 0, self.dst_width, self.dst_height, pybuf, self.dst_format, bpp, self.dst_strides[0], planes=ImageWrapper.PACKED)</pre>
<pre class='cython code score-45 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_1, __pyx_n_s_CythonImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;dst_height);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_char</span>(__pyx_v_bpp);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_long</span>((__pyx_v_self-&gt;dst_strides[0]));<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_int_0);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_int_0);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1, __pyx_int_0);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2, __pyx_t_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 3, __pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_pybuf);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_pybuf);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 4, __pyx_v_pybuf);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_self-&gt;dst_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_self-&gt;dst_format);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 5, __pyx_v_self-&gt;dst_format);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 6, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 7, __pyx_t_5);
  __pyx_t_2 = 0;
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyDict_NewPresized</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_4, __pyx_n_s_ImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_PACKED);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_t_5, __pyx_n_s_planes, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_t_6, __pyx_t_5);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 743, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  __pyx_v_out_image = __pyx_t_3;
  __pyx_t_3 = 0;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">744</span>:         out_image.cython_buffer = &lt;uintptr_t&gt; buf</pre>
<pre class='cython code score-5 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyInt_FromSize_t</span>(((uintptr_t)__pyx_v_buf));<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  if (<span class='pyx_c_api'>__Pyx_PyObject_SetAttrStr</span>(__pyx_v_out_image, __pyx_n_s_cython_buffer, __pyx_t_3) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 744, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
</pre><pre class="cython line score-2" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">745</span>:         return out_image</pre>
<pre class='cython code score-2 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_out_image);
  __pyx_r = __pyx_v_out_image;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">746</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">747</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">748</span>:     def validate_planar3_image(self, image):</pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_47validate_planar3_image(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_47validate_planar3_image(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("validate_planar3_image (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_46validate_planar3_image(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_46validate_planar3_image(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("validate_planar3_image", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.validate_planar3_image", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-60" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">749</span>:         assert image.get_planes()==ImageWrapper.PLANAR_3, "invalid input format: %s planes" % image.get_planes()</pre>
<pre class='cython code score-60 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_planes);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_3)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_ImageWrapper);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_PLANAR_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_3, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_planes);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_1 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_1)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_2 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_invalid_input_format_s_planes, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 749, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 749, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-88" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">750</span>:         assert image.get_width()&gt;=self.src_width, "invalid image width: %s (minimum is %s)" % (image.get_width(), self.src_width)</pre>
<pre class='cython code score-88 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_3 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_width);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_1 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_5 = 0;
      __pyx_t_6 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_image_width);
      __pyx_t_5 += 21;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_image_width);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 0, __pyx_kp_u_invalid_image_width);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_width);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_2 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_2), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 1, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_minimum_is);
      __pyx_t_5 += 13;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_minimum_is);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 2, __pyx_kp_u_minimum_is);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;src_width, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 3, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_5 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_1, 4, __pyx_kp_u__4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_1, 5, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 750, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 750, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-88" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">751</span>:         assert image.get_height()&gt;=self.src_height, "invalid image height: %s (minimum is %s)" % (image.get_height(), self.src_height)</pre>
<pre class='cython code score-88 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_1))) {
      __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_1);
      if (likely(__pyx_t_2)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_1, function);
      }
    }
    __pyx_t_3 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_1, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_self-&gt;src_height);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_1, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(5);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_5 = 0;
      __pyx_t_6 = 127;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_invalid_image_height);
      __pyx_t_5 += 22;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_invalid_image_height);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_invalid_image_height);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_height);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_7 = NULL;
      if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
        __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
        if (likely(__pyx_t_7)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
        }
      }
      __pyx_t_1 = (__pyx_t_7) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_7) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_t_1), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_6 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) &gt; __pyx_t_6) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_3) : __pyx_t_6;
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_minimum_is);
      __pyx_t_5 += 13;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_minimum_is);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_minimum_is);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_unsigned_int</span>(__pyx_v_self-&gt;src_height, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      __pyx_t_5 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_3);
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_3);
      __pyx_t_3 = 0;
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u__4);
      __pyx_t_5 += 1;
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u__4);
      <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 4, __pyx_kp_u__4);
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 5, __pyx_t_5, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 751, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 751, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-29" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">752</span>:         assert image.get_pixels(), "failed to get pixels from %s" % image</pre>
<pre class='cython code score-29 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
      __pyx_t_1 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
      if (likely(__pyx_t_1)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      }
    }
    __pyx_t_3 = (__pyx_t_1) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_1) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(!__pyx_t_3)) <span class='error_goto'>__PYX_ERR(0, 752, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_4 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 752, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (unlikely(!__pyx_t_4)) {
      __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_failed_to_get_pixels_from_s, __pyx_v_image);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 752, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
      <span class='error_goto'>__PYX_ERR(0, 752, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">753</span>: </pre>
<pre class="cython line score-7" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">754</span>:     def GBRP10_to_r210(self, image):</pre>
<pre class='cython code score-7 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_49GBRP10_to_r210(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_49GBRP10_to_r210(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("GBRP10_to_r210 (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_48GBRP10_to_r210(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_48GBRP10_to_r210(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_v_pixels = NULL;
  PyObject *__pyx_v_input_strides = NULL;
  unsigned int __pyx_v_w;
  unsigned int __pyx_v_h;
  unsigned int __pyx_v_src_stride;
  unsigned int __pyx_v_dst_stride;
  unsigned int *__pyx_v_r210;
  uintptr_t __pyx_v_gbrp10[3];
  unsigned int __pyx_v_i;
  Py_buffer __pyx_v_py_buf[3];
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("GBRP10_to_r210", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.GBRP10_to_r210", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_pixels);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_input_strides);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">755</span>:         self.validate_planar3_image(image)</pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_validate_planar3_image);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 755, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 755, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">756</span>:         pixels = image.get_pixels()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 756, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_pixels = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">757</span>:         input_strides = image.get_rowstride()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 757, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_input_strides = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">758</span>:         cdef unsigned int w = self.src_width</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;src_width;
  __pyx_v_w = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">759</span>:         cdef unsigned int h = self.src_height</pre>
<pre class='cython code score-0 '>  __pyx_t_4 = __pyx_v_self-&gt;src_height;
  __pyx_v_h = __pyx_t_4;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">760</span>:         cdef unsigned int src_stride = input_strides[0]</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_4 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 760, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_src_stride = __pyx_t_4;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">761</span>:         cdef unsigned int dst_stride = self.dst_strides[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_dst_stride = (__pyx_v_self-&gt;dst_strides[0]);
</pre><pre class="cython line score-44" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">762</span>:         assert input_strides[1]==src_stride and input_strides[2]==src_stride, "mismatch in rowstrides: %s" % (input_strides,)</pre>
<pre class='cython code score-44 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_src_stride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_3 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_1, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_3); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    if (__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L3_bool_binop_done;
    }
    __pyx_t_3 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_From_unsigned_int</span>(__pyx_v_src_stride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_1 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_3, __pyx_t_2, Py_EQ); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_6 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_5 = __pyx_t_6;
    __pyx_L3_bool_binop_done:;
    if (unlikely(!__pyx_t_5)) {
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_input_strides), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_Concat</span>(__pyx_kp_u_mismatch_in_rowstrides, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 762, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 762, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">763</span>:         assert src_stride&gt;=w*2</pre>
<pre class='cython code score-5 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!((__pyx_v_src_stride &gt;= (__pyx_v_w * 2)) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 763, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">764</span>:         assert dst_stride&gt;=w*4</pre>
<pre class='cython code score-5 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!((__pyx_v_dst_stride &gt;= (__pyx_v_w * 4)) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 764, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">765</span>:         assert self.dst_sizes[0]&gt;=dst_stride*h</pre>
<pre class='cython code score-5 '>  #ifndef CYTHON_WITHOUT_ASSERTIONS
  if (unlikely(!Py_OptimizeFlag)) {
    if (unlikely(!(((__pyx_v_self-&gt;dst_sizes[0]) &gt;= (__pyx_v_dst_stride * __pyx_v_h)) != 0))) {
      <span class='py_c_api'>PyErr_SetNone</span>(PyExc_AssertionError);
      <span class='error_goto'>__PYX_ERR(0, 765, __pyx_L1_error)</span>
    }
  }
  #endif
</pre><pre class="cython line score-0">&#xA0;<span class="">766</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">767</span>:         #allocate output buffer:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">768</span>:         cdef unsigned int *r210 = &lt;unsigned int*&gt; memalign(self.dst_sizes[0])</pre>
<pre class='cython code score-0 '>  __pyx_v_r210 = ((unsigned int *)__pyx_f_4xpra_7buffers_6membuf_memalign((__pyx_v_self-&gt;dst_sizes[0])));
</pre><pre class="cython line score-0">&#xA0;<span class="">769</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">770</span>:         cdef uintptr_t gbrp10[3]</pre>
<pre class="cython line score-0">&#xA0;<span class="">771</span>:         cdef unsigned int i</pre>
<pre class="cython line score-0">&#xA0;<span class="">772</span>:         cdef Py_buffer py_buf[3]</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">773</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">774</span>:             if PyObject_GetBuffer(pixels[i], &amp;py_buf[i], PyBUF_ANY_CONTIGUOUS):</pre>
<pre class='cython code score-8 '>    __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_pixels, __pyx_v_i, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 774, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    __pyx_t_5 = (<span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_t_2, (&amp;(__pyx_v_py_buf[__pyx_v_i])), PyBUF_ANY_CONTIGUOUS) != 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    if (unlikely(__pyx_t_5)) {
/* … */
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">775</span>:                 raise Exception("failed to read pixel data from %s" % type(pixels[i]))</pre>
<pre class='cython code score-11 '>      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_pixels, __pyx_v_i, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_failed_to_read_pixel_data_from_s, ((PyObject *)Py_TYPE(__pyx_t_2)));<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 775, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_2, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='error_goto'>__PYX_ERR(0, 775, __pyx_L1_error)</span>
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">776</span>:             gbrp10[i] = &lt;uintptr_t&gt; py_buf[i].buf</pre>
<pre class='cython code score-0 '>    (__pyx_v_gbrp10[__pyx_v_i]) = ((uintptr_t)(__pyx_v_py_buf[__pyx_v_i]).buf);
</pre><pre class="cython line score-31" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">777</span>:             assert (&lt;unsigned long&gt; py_buf[i].len)&gt;=src_stride*h, "input plane '%s' is too small: %i bytes" % ("GBR"[i], py_buf[i].len)</pre>
<pre class='cython code score-31 '>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      if (unlikely(!((((unsigned long)(__pyx_v_py_buf[__pyx_v_i]).len) &gt;= (__pyx_v_src_stride * __pyx_v_h)) != 0))) {
        __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetItemInt_Unicode</span>(__pyx_n_u_GBR, __pyx_v_i, unsigned int, 0, __Pyx_PyInt_From_unsigned_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_7 == (Py_UCS4)-1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
        __pyx_t_2 = <span class='py_c_api'>PyUnicode_FromOrdinal</span>(__pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_1 = <span class='py_c_api'>PyInt_FromSsize_t</span>((__pyx_v_py_buf[__pyx_v_i]).len);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_3 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_2);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 0, __pyx_t_2);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_3, 1, __pyx_t_1);
        __pyx_t_2 = 0;
        __pyx_t_1 = 0;
        __pyx_t_1 = <span class='py_c_api'>PyUnicode_Format</span>(__pyx_kp_u_input_plane_s_is_too_small_i_byt, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 777, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
        <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='error_goto'>__PYX_ERR(0, 777, __pyx_L1_error)</span>
      }
    }
    #endif
  }
</pre><pre class="cython line score-0">&#xA0;<span class="">778</span>: </pre>
<pre class="cython line score-21" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">779</span>:         if image.is_thread_safe():</pre>
<pre class='cython code score-21 '>  __pyx_t_3 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_is_thread_safe);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_2 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_3))) {
    __pyx_t_2 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_3);
    if (likely(__pyx_t_2)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_3, function);
    }
  }
  __pyx_t_1 = (__pyx_t_2) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_3, __pyx_t_2) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 779, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_1); if (unlikely(__pyx_t_5 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 779, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  if (__pyx_t_5) {
/* … */
    goto __pyx_L8;
  }
</pre><pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">780</span>:             with nogil:</pre>
<pre class='cython code score-4 '>    {
        #ifdef WITH_THREAD
        PyThreadState *_save;
        Py_UNBLOCK_THREADS
        <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
        #endif
        /*try:*/ {
/* … */
        /*finally:*/ {
          /*normal exit:*/{
            #ifdef WITH_THREAD
            <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
            Py_BLOCK_THREADS
            #endif
            goto __pyx_L11;
          }
          __pyx_L11:;
        }
    }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">781</span>:                 gbrp10_to_r210_copy(&lt;uintptr_t&gt; r210, gbrp10,</pre>
<pre class='cython code score-0 '>          __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_gbrp10_to_r210_copy(((uintptr_t)__pyx_v_r210), __pyx_v_gbrp10, __pyx_v_w, __pyx_v_h, __pyx_v_src_stride, __pyx_v_dst_stride);
        }
</pre><pre class="cython line score-0">&#xA0;<span class="">782</span>:                                     w, h,</pre>
<pre class="cython line score-0">&#xA0;<span class="">783</span>:                                     src_stride, dst_stride)</pre>
<pre class="cython line score-0">&#xA0;<span class="">784</span>:         else:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">785</span>:             gbrp10_to_r210_copy(&lt;uintptr_t&gt; r210, gbrp10,</pre>
<pre class='cython code score-0 '>  /*else*/ {
/* … */
    __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_gbrp10_to_r210_copy(((uintptr_t)__pyx_v_r210), __pyx_v_gbrp10, __pyx_v_w, __pyx_v_h, __pyx_v_src_stride, __pyx_v_dst_stride);
  }
  __pyx_L8:;
</pre><pre class="cython line score-0">&#xA0;<span class="">786</span>:                                 w, h,</pre>
<pre class="cython line score-0">&#xA0;<span class="">787</span>:                                 src_stride, dst_stride)</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">788</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_4 = 0; __pyx_t_4 &lt; 3; __pyx_t_4+=1) {
    __pyx_v_i = __pyx_t_4;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">789</span>:             PyBuffer_Release(&amp;py_buf[i])</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyBuffer_Release</span>((&amp;(__pyx_v_py_buf[__pyx_v_i])));
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">790</span>:         return self.packed_image_wrapper(&lt;char *&gt; r210, 30)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_8.__pyx_n = 1;
  __pyx_t_8.bpp = 30;
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;packed_image_wrapper(__pyx_v_self, ((char *)__pyx_v_r210), &amp;__pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 790, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">791</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">792</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">793</span>:     def YUV420P_to_RGBX(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_51YUV420P_to_RGBX(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_51YUV420P_to_RGBX(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_RGBX (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_50YUV420P_to_RGBX(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_50YUV420P_to_RGBX(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_RGBX", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.YUV420P_to_RGBX", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">794</span>:         return self.do_YUV420P_to_RGB(image, 4, RGBX_R, RGBX_G, RGBX_B, RGBX_X)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_YUV420P_to_RGB(__pyx_v_self, __pyx_v_image, 4, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_B, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 794, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">795</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">796</span>:     def YUV420P_to_RGB(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_53YUV420P_to_RGB(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_53YUV420P_to_RGB(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_RGB (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_52YUV420P_to_RGB(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_52YUV420P_to_RGB(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_RGB", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.YUV420P_to_RGB", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">797</span>:         return self.do_YUV420P_to_RGB(image, 3, RGB_R, RGB_G, RGB_B, 0)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_YUV420P_to_RGB(__pyx_v_self, __pyx_v_image, 3, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGB_B, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 797, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">798</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">799</span>:     def YUV420P_to_BGRX(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_55YUV420P_to_BGRX(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_55YUV420P_to_BGRX(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_BGRX (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_54YUV420P_to_BGRX(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_54YUV420P_to_BGRX(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_BGRX", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.YUV420P_to_BGRX", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">800</span>:         return self.do_YUV420P_to_RGB(image, 4, BGRX_R, BGRX_G, BGRX_B, BGRX_X)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_YUV420P_to_RGB(__pyx_v_self, __pyx_v_image, 4, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_B, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGRX_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 800, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">801</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">802</span>:     def YUV420P_to_BGR(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_57YUV420P_to_BGR(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_57YUV420P_to_BGR(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_BGR (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_56YUV420P_to_BGR(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_56YUV420P_to_BGR(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("YUV420P_to_BGR", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.YUV420P_to_BGR", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">803</span>:         return self.do_YUV420P_to_RGB(image, 3, BGR_R, BGR_G, BGR_B, 0)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_YUV420P_to_RGB(__pyx_v_self, __pyx_v_image, 3, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_BGR_B, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 803, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">804</span>: </pre>
<pre class="cython line score-13" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">805</span>:     cdef do_YUV420P_to_RGB(self, image, const uint8_t Bpp, const uint8_t Rindex, const uint8_t Gindex, const uint8_t Bindex, const uint8_t Xindex):</pre>
<pre class='cython code score-13 '>static PyObject *__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_do_YUV420P_to_RGB(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image, uint8_t const __pyx_v_Bpp, uint8_t const __pyx_v_Rindex, uint8_t const __pyx_v_Gindex, uint8_t const __pyx_v_Bindex, uint8_t const __pyx_v_Xindex) {
  unsigned int __pyx_v_x;
  unsigned int __pyx_v_y;
  unsigned int __pyx_v_o;
  unsigned int __pyx_v_sx;
  unsigned int __pyx_v_sy;
  unsigned int __pyx_v_ox;
  unsigned int __pyx_v_oy;
  unsigned char __pyx_v_dx;
  unsigned char __pyx_v_dy;
  short __pyx_v_Y;
  short __pyx_v_U;
  short __pyx_v_V;
  PyObject *__pyx_v_planes = NULL;
  PyObject *__pyx_v_input_strides = NULL;
  unsigned char *__pyx_v_output_image;
  unsigned int __pyx_v_stride;
  unsigned int __pyx_v_src_width;
  unsigned int __pyx_v_src_height;
  unsigned int __pyx_v_dst_width;
  unsigned int __pyx_v_dst_height;
  unsigned int __pyx_v_Ystride;
  unsigned int __pyx_v_Ustride;
  unsigned int __pyx_v_Vstride;
  Py_buffer __pyx_v_py_buf[3];
  int __pyx_v_i;
  PyObject *__pyx_v_min_len = NULL;
  unsigned char *__pyx_v_Ybuf;
  unsigned char *__pyx_v_Ubuf;
  unsigned char *__pyx_v_Vbuf;
  unsigned int __pyx_v_workw;
  unsigned int __pyx_v_workh;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("do_YUV420P_to_RGB", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.do_YUV420P_to_RGB", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_planes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_input_strides);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_min_len);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">806</span>:         cdef unsigned int x,y,o</pre>
<pre class="cython line score-0">&#xA0;<span class="">807</span>:         cdef unsigned int sx, sy, ox, oy</pre>
<pre class="cython line score-0">&#xA0;<span class="">808</span>:         cdef unsigned char dx, dy</pre>
<pre class="cython line score-0">&#xA0;<span class="">809</span>:         cdef short Y, U, V</pre>
<pre class="cython line score-0">&#xA0;<span class="">810</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">811</span>:         self.validate_planar3_image(image)</pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_validate_planar3_image);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 811, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 811, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">812</span>:         planes = image.get_pixels()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 812, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 812, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_planes = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">813</span>:         input_strides = image.get_rowstride()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 813, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 813, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_input_strides = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-55" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">814</span>:         log("do_YUV420P_to_RGB(%s) strides=%s", (image, Bpp, Rindex, Gindex, Bindex, Xindex), input_strides)</pre>
<pre class='cython code score-55 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyInt_From_uint8_t(__pyx_v_Bpp);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyInt_From_uint8_t(__pyx_v_Rindex);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyInt_From_uint8_t(__pyx_v_Gindex);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyInt_From_uint8_t(__pyx_v_Bindex);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyInt_From_uint8_t(__pyx_v_Xindex);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(6);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_image);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_image);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_v_image);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 3, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 4, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 5, __pyx_t_7);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_7 = NULL;
  __pyx_t_9 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_7 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_7)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_9 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_kp_u_do_YUV420P_to_RGB_s_strides_s, __pyx_t_8, __pyx_v_input_strides};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_7, __pyx_kp_u_do_YUV420P_to_RGB_s_strides_s, __pyx_t_8, __pyx_v_input_strides};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_9, 3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  } else
  #endif
  {
    __pyx_t_6 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_9);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    if (__pyx_t_7) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0, __pyx_t_7); __pyx_t_7 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_do_YUV420P_to_RGB_s_strides_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_do_YUV420P_to_RGB_s_strides_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 0+__pyx_t_9, __pyx_kp_u_do_YUV420P_to_RGB_s_strides_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 1+__pyx_t_9, __pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_input_strides);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_input_strides);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_6, 2+__pyx_t_9, __pyx_v_input_strides);
    __pyx_t_8 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 814, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">815</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">816</span>:         #allocate output buffer:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">817</span>:         cdef unsigned char *output_image = &lt;unsigned char*&gt; memalign(self.buffer_size)</pre>
<pre class='cython code score-0 '>  __pyx_v_output_image = ((unsigned char *)__pyx_f_4xpra_7buffers_6membuf_memalign(__pyx_v_self-&gt;buffer_size));
</pre><pre class="cython line score-0">&#xA0;<span class="">818</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">819</span>:         #copy to local variables:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">820</span>:         cdef unsigned int stride = self.dst_strides[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_stride = (__pyx_v_self-&gt;dst_strides[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">821</span>:         cdef unsigned int src_width = self.src_width</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;src_width;
  __pyx_v_src_width = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">822</span>:         cdef unsigned int src_height = self.src_height</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;src_height;
  __pyx_v_src_height = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">823</span>:         cdef unsigned int dst_width = self.dst_width</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;dst_width;
  __pyx_v_dst_width = __pyx_t_10;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">824</span>:         cdef unsigned int dst_height = self.dst_height</pre>
<pre class='cython code score-0 '>  __pyx_t_10 = __pyx_v_self-&gt;dst_height;
  __pyx_v_dst_height = __pyx_t_10;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">825</span>:         cdef unsigned int Ystride = input_strides[0]</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, 0, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 825, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_10 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 825, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Ystride = __pyx_t_10;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">826</span>:         cdef unsigned int Ustride = input_strides[1]</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, 1, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_10 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 826, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Ustride = __pyx_t_10;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">827</span>:         cdef unsigned int Vstride = input_strides[2]</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, 2, long, 1, __Pyx_PyInt_From_long, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 827, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_10 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_10 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 827, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Vstride = __pyx_t_10;
</pre><pre class="cython line score-0">&#xA0;<span class="">828</span>:         cdef Py_buffer py_buf[3]</pre>
<pre class="cython line score-0">&#xA0;<span class="">829</span>:         cdef int i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">830</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_9 = 0; __pyx_t_9 &lt; 3; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">831</span>:             if PyObject_GetBuffer(planes[i], &amp;py_buf[i], PyBUF_ANY_CONTIGUOUS):</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_planes, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 831, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_11 = (<span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_t_1, (&amp;(__pyx_v_py_buf[__pyx_v_i])), PyBUF_ANY_CONTIGUOUS) != 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(__pyx_t_11)) {
/* … */
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">832</span>:                 raise Exception("failed to read pixel data from %s" % type(planes[i]))</pre>
<pre class='cython code score-11 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_planes, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_failed_to_read_pixel_data_from_s, ((PyObject *)Py_TYPE(__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 832, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 832, __pyx_L1_error)</span>
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">833</span>:             min_len = input_strides[i]*image.get_height()</pre>
<pre class='cython code score-28 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 833, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_height);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 833, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_8 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_6))) {
      __pyx_t_8 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_6);
      if (likely(__pyx_t_8)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_6, function);
      }
    }
    __pyx_t_2 = (__pyx_t_8) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_6, __pyx_t_8) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 833, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 833, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_min_len, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">834</span>:             assert py_buf.len&gt;=min_len, "buffer for Y plane is too small: %s bytes, expected at least %s" % (py_buf.len, min_len)</pre>
<pre class='cython code score-51 '>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_6 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_py_buf-&gt;len);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_6, __pyx_v_min_len, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      __pyx_t_11 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_11 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 834, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_11)) {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_12 = 0;
        __pyx_t_13 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_buffer_for_Y_plane_is_too_small);
        __pyx_t_12 += 33;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_buffer_for_Y_plane_is_too_small);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_buffer_for_Y_plane_is_too_small);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_v_py_buf-&gt;len, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_12 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_6);
        __pyx_t_6 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_bytes_expected_at_least);
        __pyx_t_12 += 26;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_bytes_expected_at_least);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_bytes_expected_at_least);
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_min_len), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_13 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) &gt; __pyx_t_13) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_6) : __pyx_t_13;
        __pyx_t_12 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_6);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_6);
        __pyx_t_6 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 4, __pyx_t_12, __pyx_t_13);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 834, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        <span class='error_goto'>__PYX_ERR(0, 834, __pyx_L1_error)</span>
      }
    }
    #endif
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">835</span>:         cdef unsigned char *Ybuf = &lt;unsigned char *&gt; py_buf[0].buf</pre>
<pre class='cython code score-0 '>  __pyx_v_Ybuf = ((unsigned char *)(__pyx_v_py_buf[0]).buf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">836</span>:         cdef unsigned char *Ubuf = &lt;unsigned char *&gt; py_buf[1].buf</pre>
<pre class='cython code score-0 '>  __pyx_v_Ubuf = ((unsigned char *)(__pyx_v_py_buf[1]).buf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">837</span>:         cdef unsigned char *Vbuf = &lt;unsigned char *&gt; py_buf[2].buf</pre>
<pre class='cython code score-0 '>  __pyx_v_Vbuf = ((unsigned char *)(__pyx_v_py_buf[2]).buf);
</pre><pre class="cython line score-0">&#xA0;<span class="">838</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">839</span>:         #we process 4 pixels at a time:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">840</span>:         cdef unsigned int workw = roundup(dst_width//2, 2)</pre>
<pre class='cython code score-0 '>  __pyx_v_workw = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup((__pyx_v_dst_width / 2), 2);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">841</span>:         cdef unsigned int workh = roundup(dst_height//2, 2)</pre>
<pre class='cython code score-0 '>  __pyx_v_workh = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_roundup((__pyx_v_dst_height / 2), 2);
</pre><pre class="cython line score-0">&#xA0;<span class="">842</span>:         #from now on, we can release the gil:</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">843</span>:         with nogil:</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L8;
        }
        __pyx_L8:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">844</span>:             for y in range(workh):</pre>
<pre class='cython code score-0 '>        __pyx_t_10 = __pyx_v_workh;
        __pyx_t_14 = __pyx_t_10;
        for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
          __pyx_v_y = __pyx_t_15;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">845</span>:                 for x in range(workw):</pre>
<pre class='cython code score-0 '>          __pyx_t_16 = __pyx_v_workw;
          __pyx_t_17 = __pyx_t_16;
          for (__pyx_t_18 = 0; __pyx_t_18 &lt; __pyx_t_17; __pyx_t_18+=1) {
            __pyx_v_x = __pyx_t_18;
</pre><pre class="cython line score-0">&#xA0;<span class="">846</span>:                     #assert x*2&lt;=src_width and y*2&lt;=src_height</pre>
<pre class="cython line score-0">&#xA0;<span class="">847</span>:                     #read U and V for the next 4 pixels:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">848</span>:                     sx = x*src_width//dst_width</pre>
<pre class='cython code score-0 '>            __pyx_v_sx = ((__pyx_v_x * __pyx_v_src_width) / __pyx_v_dst_width);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">849</span>:                     sy = y*src_height//dst_height</pre>
<pre class='cython code score-0 '>            __pyx_v_sy = ((__pyx_v_y * __pyx_v_src_height) / __pyx_v_dst_height);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">850</span>:                     U = Ubuf[sy*Ustride + sx] - Uc</pre>
<pre class='cython code score-0 '>            __pyx_v_U = ((__pyx_v_Ubuf[((__pyx_v_sy * __pyx_v_Ustride) + __pyx_v_sx)]) - 0x80);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">851</span>:                     V = Vbuf[sy*Vstride + sx] - Vc</pre>
<pre class='cython code score-0 '>            __pyx_v_V = ((__pyx_v_Vbuf[((__pyx_v_sy * __pyx_v_Vstride) + __pyx_v_sx)]) - 0x80);
</pre><pre class="cython line score-0">&#xA0;<span class="">852</span>:                     #now read up to 4 Y values and write an RGBX pixel for each:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">853</span>:                     for dy in range(2):</pre>
<pre class='cython code score-0 '>            for (__pyx_t_19 = 0; __pyx_t_19 &lt; 2; __pyx_t_19+=1) {
              __pyx_v_dy = __pyx_t_19;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">854</span>:                         oy = y*2 + dy</pre>
<pre class='cython code score-0 '>              __pyx_v_oy = ((__pyx_v_y * 2) + __pyx_v_dy);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">855</span>:                         if oy&gt;=dst_height:</pre>
<pre class='cython code score-0 '>              __pyx_t_11 = ((__pyx_v_oy &gt;= __pyx_v_dst_height) != 0);
              if (__pyx_t_11) {
/* … */
              }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">856</span>:                             break</pre>
<pre class='cython code score-0 '>                goto __pyx_L14_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">857</span>:                         sy = oy*src_height//dst_height</pre>
<pre class='cython code score-0 '>              __pyx_v_sy = ((__pyx_v_oy * __pyx_v_src_height) / __pyx_v_dst_height);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">858</span>:                         for dx in range(2):</pre>
<pre class='cython code score-0 '>              for (__pyx_t_20 = 0; __pyx_t_20 &lt; 2; __pyx_t_20+=1) {
                __pyx_v_dx = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">859</span>:                             ox = x*2 + dx</pre>
<pre class='cython code score-0 '>                __pyx_v_ox = ((__pyx_v_x * 2) + __pyx_v_dx);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">860</span>:                             if ox&gt;=dst_width:</pre>
<pre class='cython code score-0 '>                __pyx_t_11 = ((__pyx_v_ox &gt;= __pyx_v_dst_width) != 0);
                if (__pyx_t_11) {
/* … */
                }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">861</span>:                                 break</pre>
<pre class='cython code score-0 '>                  goto __pyx_L17_break;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">862</span>:                             sx = ox*src_width//dst_width</pre>
<pre class='cython code score-0 '>                __pyx_v_sx = ((__pyx_v_ox * __pyx_v_src_width) / __pyx_v_dst_width);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">863</span>:                             Y = Ybuf[sy*Ystride + sx] - Yc</pre>
<pre class='cython code score-0 '>                __pyx_v_Y = ((__pyx_v_Ybuf[((__pyx_v_sy * __pyx_v_Ystride) + __pyx_v_sx)]) - 0);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">864</span>:                             o = oy*stride + ox * Bpp</pre>
<pre class='cython code score-0 '>                __pyx_v_o = ((__pyx_v_oy * __pyx_v_stride) + (__pyx_v_ox * __pyx_v_Bpp));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">865</span>:                             output_image[o + Rindex] = clamp(RY * Y + RU * U + RV * V)</pre>
<pre class='cython code score-0 '>                (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Rindex)]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp((((0x10000 * __pyx_v_Y) + (0 * __pyx_v_U)) + (0x1672B * __pyx_v_V)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">866</span>:                             output_image[o + Gindex] = clamp(GY * Y + GU * U + GV * V)</pre>
<pre class='cython code score-0 '>                (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Gindex)]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp((((0x10000 * __pyx_v_Y) + (-22544L * __pyx_v_U)) + (-46793L * __pyx_v_V)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">867</span>:                             output_image[o + Bindex] = clamp(BY * Y + BU * U + BV * V)</pre>
<pre class='cython code score-0 '>                (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Bindex)]) = __pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_clamp((((0x10000 * __pyx_v_Y) + (0x1C51F * __pyx_v_U)) + (0 * __pyx_v_V)));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">868</span>:                             if Bpp==4:</pre>
<pre class='cython code score-0 '>                __pyx_t_11 = ((__pyx_v_Bpp == 4) != 0);
                if (__pyx_t_11) {
/* … */
                }
              }
              __pyx_L17_break:;
            }
            __pyx_L14_break:;
          }
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">869</span>:                                 output_image[o + Xindex] = 255</pre>
<pre class='cython code score-0 '>                  (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Xindex)]) = 0xFF;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">870</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_9 = 0; __pyx_t_9 &lt; 3; __pyx_t_9+=1) {
    __pyx_v_i = __pyx_t_9;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">871</span>:             PyBuffer_Release(&amp;py_buf[i])</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyBuffer_Release</span>((&amp;(__pyx_v_py_buf[__pyx_v_i])));
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">872</span>:         return self.packed_image_wrapper(&lt;char *&gt; output_image, 24)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_21.__pyx_n = 1;
  __pyx_t_21.bpp = 24;
  __pyx_t_6 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;packed_image_wrapper(__pyx_v_self, ((char *)__pyx_v_output_image), &amp;__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 872, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">873</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">874</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">875</span>:     def GBRP_to_RGBX(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_59GBRP_to_RGBX(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_59GBRP_to_RGBX(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("GBRP_to_RGBX (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_58GBRP_to_RGBX(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_58GBRP_to_RGBX(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("GBRP_to_RGBX", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.GBRP_to_RGBX", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">876</span>:         return self.do_RGBP_to_RGB(image, 2, 0, 1, RGBX_R, RGBX_G, RGBX_B, RGBX_X)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_RGBP_to_RGB(__pyx_v_self, __pyx_v_image, 2, 0, 1, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_B, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 876, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">877</span>: </pre>
<pre class="cython line score-3" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">878</span>:     def GBRP_to_BGRX(self, image):</pre>
<pre class='cython code score-3 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_61GBRP_to_BGRX(PyObject *__pyx_v_self, PyObject *__pyx_v_image); /*proto*/
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_61GBRP_to_BGRX(PyObject *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("GBRP_to_BGRX (wrapper)", 0);
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_60GBRP_to_BGRX(((struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self), ((PyObject *)__pyx_v_image));

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_60GBRP_to_BGRX(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image) {
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("GBRP_to_BGRX", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.GBRP_to_BGRX", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">879</span>:         return self.do_RGBP_to_RGB(image, 2, 0, 1, RGBX_B, RGBX_G, RGBX_R, RGBX_X)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;do_RGBP_to_RGB(__pyx_v_self, __pyx_v_image, 2, 0, 1, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_B, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_G, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_R, __pyx_v_4xpra_6codecs_10csc_cython_20colorspace_converter_RGBX_X);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 879, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">880</span>: </pre>
<pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">881</span>:     cdef do_RGBP_to_RGB(self, image, const uint8_t Rsrc, const uint8_t Gsrc, const uint8_t Bsrc,</pre>
<pre class='cython code score-15 '>static PyObject *__pyx_f_4xpra_6codecs_10csc_cython_20colorspace_converter_19ColorspaceConverter_do_RGBP_to_RGB(struct __pyx_obj_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *__pyx_v_self, PyObject *__pyx_v_image, uint8_t const __pyx_v_Rsrc, uint8_t const __pyx_v_Gsrc, uint8_t const __pyx_v_Bsrc, uint8_t const __pyx_v_Rdst, uint8_t const __pyx_v_Gdst, uint8_t const __pyx_v_Bdst, uint8_t const __pyx_v_Xdst) {
  unsigned int __pyx_v_x;
  unsigned int __pyx_v_y;
  unsigned int __pyx_v_o;
  unsigned int __pyx_v_sx;
  unsigned int __pyx_v_sy;
  unsigned char *__pyx_v_Gptr;
  unsigned char *__pyx_v_Bptr;
  unsigned char *__pyx_v_Rptr;
  PyObject *__pyx_v_planes = NULL;
  PyObject *__pyx_v_input_strides = NULL;
  unsigned char *__pyx_v_output_image;
  unsigned int __pyx_v_Rstride;
  unsigned int __pyx_v_Gstride;
  unsigned int __pyx_v_Bstride;
  unsigned int __pyx_v_stride;
  unsigned int __pyx_v_src_width;
  unsigned int __pyx_v_src_height;
  unsigned int __pyx_v_dst_width;
  unsigned int __pyx_v_dst_height;
  Py_buffer __pyx_v_py_buf[3];
  int __pyx_v_i;
  PyObject *__pyx_v_min_len = NULL;
  unsigned char *__pyx_v_Gbuf;
  unsigned char *__pyx_v_Bbuf;
  unsigned char *__pyx_v_Rbuf;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("do_RGBP_to_RGB", 0);
/* … */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.ColorspaceConverter.do_RGBP_to_RGB", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = 0;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_planes);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_input_strides);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_min_len);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
</pre><pre class="cython line score-0">&#xA0;<span class="">882</span>:                                      const uint8_t Rdst, const uint8_t Gdst, const uint8_t Bdst, const uint8_t Xdst):</pre>
<pre class="cython line score-0">&#xA0;<span class="">883</span>:         cdef unsigned int x,y,o</pre>
<pre class="cython line score-0">&#xA0;<span class="">884</span>:         cdef unsigned int sx, sy</pre>
<pre class="cython line score-0">&#xA0;<span class="">885</span>:         cdef unsigned char *Gptr</pre>
<pre class="cython line score-0">&#xA0;<span class="">886</span>:         cdef unsigned char *Bptr</pre>
<pre class="cython line score-0">&#xA0;<span class="">887</span>:         cdef unsigned char *Rptr</pre>
<pre class="cython line score-0">&#xA0;<span class="">888</span>: </pre>
<pre class="cython line score-17" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">889</span>:         self.validate_planar3_image(image)</pre>
<pre class='cython code score-17 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(((PyObject *)__pyx_v_self), __pyx_n_s_validate_planar3_image);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? __Pyx_PyObject_Call2Args(__pyx_t_2, __pyx_t_3, __pyx_v_image) : <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_v_image);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 889, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">890</span>:         planes = image.get_pixels()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_pixels);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 890, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 890, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_planes = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-18" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">891</span>:         input_strides = image.get_rowstride()</pre>
<pre class='cython code score-18 '>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_rowstride);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  __pyx_t_1 = (__pyx_t_3) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  if (unlikely(!__pyx_t_1)) <span class='error_goto'>__PYX_ERR(0, 891, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_input_strides = __pyx_t_1;
  __pyx_t_1 = 0;
</pre><pre class="cython line score-57" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">892</span>:         log("do_RGBP_to_RGB(%s) strides=%s", (image, Rsrc, Gsrc, Bsrc, Rdst, Gdst, Bdst, Xdst), input_strides)</pre>
<pre class='cython code score-57 '>  <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_t_2, __pyx_n_s_log);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = __Pyx_PyInt_From_uint8_t(__pyx_v_Rsrc);<span class='error_goto'> if (unlikely(!__pyx_t_3)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_3);
  __pyx_t_4 = __Pyx_PyInt_From_uint8_t(__pyx_v_Gsrc);<span class='error_goto'> if (unlikely(!__pyx_t_4)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_5 = __Pyx_PyInt_From_uint8_t(__pyx_v_Bsrc);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
  __pyx_t_6 = __Pyx_PyInt_From_uint8_t(__pyx_v_Rdst);<span class='error_goto'> if (unlikely(!__pyx_t_6)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_t_7 = __Pyx_PyInt_From_uint8_t(__pyx_v_Gdst);<span class='error_goto'> if (unlikely(!__pyx_t_7)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
  __pyx_t_8 = __Pyx_PyInt_From_uint8_t(__pyx_v_Bdst);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_t_9 = __Pyx_PyInt_From_uint8_t(__pyx_v_Xdst);<span class='error_goto'> if (unlikely(!__pyx_t_9)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_9);
  __pyx_t_10 = <span class='py_c_api'>PyTuple_New</span>(8);<span class='error_goto'> if (unlikely(!__pyx_t_10)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_10);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_image);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_image);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 0, __pyx_v_image);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 1, __pyx_t_3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 2, __pyx_t_4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_5);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 3, __pyx_t_5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_6);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 4, __pyx_t_6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_7);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 5, __pyx_t_7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 6, __pyx_t_8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_10, 7, __pyx_t_9);
  __pyx_t_3 = 0;
  __pyx_t_4 = 0;
  __pyx_t_5 = 0;
  __pyx_t_6 = 0;
  __pyx_t_7 = 0;
  __pyx_t_8 = 0;
  __pyx_t_9 = 0;
  __pyx_t_9 = NULL;
  __pyx_t_11 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_9 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_9)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_9);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_11 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_kp_u_do_RGBP_to_RGB_s_strides_s, __pyx_t_10, __pyx_v_input_strides};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_9, __pyx_kp_u_do_RGBP_to_RGB_s_strides_s, __pyx_t_10, __pyx_v_input_strides};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_11, 3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_9); __pyx_t_9 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
  } else
  #endif
  {
    __pyx_t_8 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_11);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    if (__pyx_t_9) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_9); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0, __pyx_t_9); __pyx_t_9 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_do_RGBP_to_RGB_s_strides_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_do_RGBP_to_RGB_s_strides_s);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 0+__pyx_t_11, __pyx_kp_u_do_RGBP_to_RGB_s_strides_s);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_10);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 1+__pyx_t_11, __pyx_t_10);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_input_strides);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_input_strides);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_8, 2+__pyx_t_11, __pyx_v_input_strides);
    __pyx_t_10 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 892, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-0">&#xA0;<span class="">893</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">894</span>:         #allocate output buffer:</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">895</span>:         cdef unsigned char *output_image = &lt;unsigned char*&gt; memalign(self.buffer_size)</pre>
<pre class='cython code score-0 '>  __pyx_v_output_image = ((unsigned char *)__pyx_f_4xpra_7buffers_6membuf_memalign(__pyx_v_self-&gt;buffer_size));
</pre><pre class="cython line score-0">&#xA0;<span class="">896</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">897</span>:         #copy to local variables:</pre>
<pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">898</span>:         cdef unsigned int Rstride = input_strides[Rsrc]</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, __pyx_v_Rsrc, uint8_t const , 0, __Pyx_PyInt_From_uint8_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 898, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 898, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Rstride = __pyx_t_12;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">899</span>:         cdef unsigned int Gstride = input_strides[Gsrc]</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, __pyx_v_Gsrc, uint8_t const , 0, __Pyx_PyInt_From_uint8_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 899, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Gstride = __pyx_t_12;
</pre><pre class="cython line score-10" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">900</span>:         cdef unsigned int Bstride = input_strides[Bsrc]</pre>
<pre class='cython code score-10 '>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, __pyx_v_Bsrc, uint8_t const , 0, __Pyx_PyInt_From_uint8_t, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 900, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_12 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_int</span>(__pyx_t_1); if (unlikely((__pyx_t_12 == (unsigned int)-1) &amp;&amp; <span class='py_c_api'>PyErr_Occurred</span>())) <span class='error_goto'>__PYX_ERR(0, 900, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_Bstride = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">901</span>:         cdef unsigned int stride = self.dst_strides[0]</pre>
<pre class='cython code score-0 '>  __pyx_v_stride = (__pyx_v_self-&gt;dst_strides[0]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">902</span>:         cdef unsigned int src_width = self.src_width</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_self-&gt;src_width;
  __pyx_v_src_width = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">903</span>:         cdef unsigned int src_height = self.src_height</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_self-&gt;src_height;
  __pyx_v_src_height = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">904</span>:         cdef unsigned int dst_width = self.dst_width</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_self-&gt;dst_width;
  __pyx_v_dst_width = __pyx_t_12;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">905</span>:         cdef unsigned int dst_height = self.dst_height</pre>
<pre class='cython code score-0 '>  __pyx_t_12 = __pyx_v_self-&gt;dst_height;
  __pyx_v_dst_height = __pyx_t_12;
</pre><pre class="cython line score-0">&#xA0;<span class="">906</span>:         cdef Py_buffer py_buf[3]</pre>
<pre class="cython line score-0">&#xA0;<span class="">907</span>:         cdef int i</pre>
<pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">908</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-8" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">909</span>:             if PyObject_GetBuffer(planes[i], &amp;py_buf[i], PyBUF_ANY_CONTIGUOUS):</pre>
<pre class='cython code score-8 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_planes, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 909, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_13 = (<span class='py_c_api'>PyObject_GetBuffer</span>(__pyx_t_1, (&amp;(__pyx_v_py_buf[__pyx_v_i])), PyBUF_ANY_CONTIGUOUS) != 0);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    if (unlikely(__pyx_t_13)) {
/* … */
    }
</pre><pre class="cython line score-11" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">910</span>:                 raise Exception("failed to read pixel data from %s" % type(planes[i]))</pre>
<pre class='cython code score-11 '>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_planes, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyUnicode_FormatSafe</span>(__pyx_kp_u_failed_to_read_pixel_data_from_s, ((PyObject *)Py_TYPE(__pyx_t_1)));<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(((PyObject *)(&amp;((PyTypeObject*)PyExc_Exception)[0])), __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 910, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      <span class='pyx_c_api'>__Pyx_Raise</span>(__pyx_t_1, 0, 0, 0);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      <span class='error_goto'>__PYX_ERR(0, 910, __pyx_L1_error)</span>
</pre><pre class="cython line score-28" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">911</span>:             min_len = input_strides[i]*image.get_height()</pre>
<pre class='cython code score-28 '>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_input_strides, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_image, __pyx_n_s_get_height);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    __pyx_t_10 = NULL;
    if (CYTHON_UNPACK_METHODS &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
      __pyx_t_10 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
      if (likely(__pyx_t_10)) {
        PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_10);
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
        <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
      }
    }
    __pyx_t_2 = (__pyx_t_10) ? <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_10) : <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_10); __pyx_t_10 = 0;
    if (unlikely(!__pyx_t_2)) <span class='error_goto'>__PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_8 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_t_1, __pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 911, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_min_len, __pyx_t_8);
    __pyx_t_8 = 0;
</pre><pre class="cython line score-51" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">912</span>:             assert py_buf.len&gt;=min_len, "buffer for G plane is too small: %s bytes, expected at least %s" % (py_buf.len, min_len)</pre>
<pre class='cython code score-51 '>    #ifndef CYTHON_WITHOUT_ASSERTIONS
    if (unlikely(!Py_OptimizeFlag)) {
      __pyx_t_8 = <span class='py_c_api'>PyInt_FromSsize_t</span>(__pyx_v_py_buf-&gt;len);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_2 = <span class='py_c_api'>PyObject_RichCompare</span>(__pyx_t_8, __pyx_v_min_len, Py_GE); <span class='refnanny'>__Pyx_XGOTREF</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_13 = <span class='pyx_c_api'>__Pyx_PyObject_IsTrue</span>(__pyx_t_2); if (unlikely(__pyx_t_13 &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 912, __pyx_L1_error)</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
      if (unlikely(!__pyx_t_13)) {
        __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(4);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
        __pyx_t_14 = 0;
        __pyx_t_15 = 127;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_buffer_for_G_plane_is_too_small);
        __pyx_t_14 += 33;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_buffer_for_G_plane_is_too_small);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_u_buffer_for_G_plane_is_too_small);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_From_Py_ssize_t</span>(__pyx_v_py_buf-&gt;len, 0, ' ', 'd');<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_14 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_8);
        __pyx_t_8 = 0;
        <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_u_bytes_expected_at_least);
        __pyx_t_14 += 26;
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_u_bytes_expected_at_least);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 2, __pyx_kp_u_bytes_expected_at_least);
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_FormatSimpleAndDecref</span>(<span class='py_c_api'>PyObject_Unicode</span>(__pyx_v_min_len), __pyx_empty_unicode);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        __pyx_t_15 = (<span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) &gt; __pyx_t_15) ? <span class='pyx_c_api'>__Pyx_PyUnicode_MAX_CHAR_VALUE</span>(__pyx_t_8) : __pyx_t_15;
        __pyx_t_14 += <span class='pyx_c_api'>__Pyx_PyUnicode_GET_LENGTH</span>(__pyx_t_8);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_8);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 3, __pyx_t_8);
        __pyx_t_8 = 0;
        __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyUnicode_Join</span>(__pyx_t_2, 4, __pyx_t_14, __pyx_t_15);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 912, __pyx_L1_error)</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
        <span class='py_c_api'>PyErr_SetObject</span>(PyExc_AssertionError, __pyx_t_8);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
        <span class='error_goto'>__PYX_ERR(0, 912, __pyx_L1_error)</span>
      }
    }
    #endif
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">913</span>:         cdef unsigned char *Gbuf = &lt;unsigned char*&gt; py_buf[Gsrc].buf</pre>
<pre class='cython code score-0 '>  __pyx_v_Gbuf = ((unsigned char *)(__pyx_v_py_buf[__pyx_v_Gsrc]).buf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">914</span>:         cdef unsigned char *Bbuf = &lt;unsigned char*&gt; py_buf[Bsrc].buf</pre>
<pre class='cython code score-0 '>  __pyx_v_Bbuf = ((unsigned char *)(__pyx_v_py_buf[__pyx_v_Bsrc]).buf);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">915</span>:         cdef unsigned char *Rbuf = &lt;unsigned char*&gt; py_buf[Rsrc].buf</pre>
<pre class='cython code score-0 '>  __pyx_v_Rbuf = ((unsigned char *)(__pyx_v_py_buf[__pyx_v_Rsrc]).buf);
</pre><pre class="cython line score-0">&#xA0;<span class="">916</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">917</span>:         #from now on, we can release the gil:</pre>
<pre class="cython line score-4" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">918</span>:         with nogil:</pre>
<pre class='cython code score-4 '>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      <span class='pyx_c_api'>__Pyx_FastGIL_Remember</span>();
      #endif
      /*try:*/ {
/* … */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          <span class='pyx_c_api'>__Pyx_FastGIL_Forget</span>();
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L8;
        }
        __pyx_L8:;
      }
  }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">919</span>:             for y in range(dst_height):</pre>
<pre class='cython code score-0 '>        __pyx_t_12 = __pyx_v_dst_height;
        __pyx_t_16 = __pyx_t_12;
        for (__pyx_t_17 = 0; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
          __pyx_v_y = __pyx_t_17;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">920</span>:                 o = stride*y</pre>
<pre class='cython code score-0 '>          __pyx_v_o = (__pyx_v_stride * __pyx_v_y);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">921</span>:                 sy = y*src_height/dst_height</pre>
<pre class='cython code score-0 '>          __pyx_v_sy = ((__pyx_v_y * __pyx_v_src_height) / __pyx_v_dst_height);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">922</span>:                 Rptr  = Rbuf + (sy * Rstride)</pre>
<pre class='cython code score-0 '>          __pyx_v_Rptr = (__pyx_v_Rbuf + (__pyx_v_sy * __pyx_v_Rstride));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">923</span>:                 Gptr  = Gbuf + (sy * Gstride)</pre>
<pre class='cython code score-0 '>          __pyx_v_Gptr = (__pyx_v_Gbuf + (__pyx_v_sy * __pyx_v_Gstride));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">924</span>:                 Bptr  = Bbuf + (sy * Bstride)</pre>
<pre class='cython code score-0 '>          __pyx_v_Bptr = (__pyx_v_Bbuf + (__pyx_v_sy * __pyx_v_Bstride));
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">925</span>:                 for x in range(dst_width):</pre>
<pre class='cython code score-0 '>          __pyx_t_18 = __pyx_v_dst_width;
          __pyx_t_19 = __pyx_t_18;
          for (__pyx_t_20 = 0; __pyx_t_20 &lt; __pyx_t_19; __pyx_t_20+=1) {
            __pyx_v_x = __pyx_t_20;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">926</span>:                     sx = x*src_width/dst_width</pre>
<pre class='cython code score-0 '>            __pyx_v_sx = ((__pyx_v_x * __pyx_v_src_width) / __pyx_v_dst_width);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">927</span>:                     output_image[o+Rdst] = Rptr[sx]</pre>
<pre class='cython code score-0 '>            (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Rdst)]) = (__pyx_v_Rptr[__pyx_v_sx]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">928</span>:                     output_image[o+Gdst] = Gptr[sx]</pre>
<pre class='cython code score-0 '>            (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Gdst)]) = (__pyx_v_Gptr[__pyx_v_sx]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">929</span>:                     output_image[o+Bdst] = Bptr[sx]</pre>
<pre class='cython code score-0 '>            (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Bdst)]) = (__pyx_v_Bptr[__pyx_v_sx]);
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">930</span>:                     output_image[o+Xdst] = 255</pre>
<pre class='cython code score-0 '>            (__pyx_v_output_image[(__pyx_v_o + __pyx_v_Xdst)]) = 0xFF;
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">931</span>:                     o += 4</pre>
<pre class='cython code score-0 '>            __pyx_v_o = (__pyx_v_o + 4);
          }
        }
      }
</pre><pre class="cython line score-0" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">932</span>:         for i in range(3):</pre>
<pre class='cython code score-0 '>  for (__pyx_t_11 = 0; __pyx_t_11 &lt; 3; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class="cython line score-5" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">933</span>:             PyBuffer_Release(&amp;py_buf[i])</pre>
<pre class='cython code score-5 '>    <span class='py_c_api'>PyBuffer_Release</span>((&amp;(__pyx_v_py_buf[__pyx_v_i])));
  }
</pre><pre class="cython line score-1" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">934</span>:         return self.packed_image_wrapper(&lt;char *&gt; output_image, 24)</pre>
<pre class='cython code score-1 '>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_21.__pyx_n = 1;
  __pyx_t_21.bpp = 24;
  __pyx_t_8 = ((struct __pyx_vtabstruct_4xpra_6codecs_10csc_cython_20colorspace_converter_ColorspaceConverter *)__pyx_v_self-&gt;__pyx_vtab)-&gt;packed_image_wrapper(__pyx_v_self, ((char *)__pyx_v_output_image), &amp;__pyx_t_21);<span class='error_goto'> if (unlikely(!__pyx_t_8)) __PYX_ERR(0, 934, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
  __pyx_r = __pyx_t_8;
  __pyx_t_8 = 0;
  goto __pyx_L0;
</pre><pre class="cython line score-0">&#xA0;<span class="">935</span>: </pre>
<pre class="cython line score-0">&#xA0;<span class="">936</span>: </pre>
<pre class="cython line score-38" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">937</span>: def selftest(full=False):</pre>
<pre class='cython code score-38 '>/* Python wrapper */
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19selftest(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19selftest = {"selftest", (PyCFunction)(void*)(PyCFunctionWithKeywords)__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19selftest, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_4xpra_6codecs_10csc_cython_20colorspace_converter_19selftest(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_full = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("selftest (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_full,0};
    PyObject* values[1] = {0};
    values[0] = ((PyObject *)Py_False);
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (kw_args &gt; 0) {
          PyObject* value = <span class='pyx_c_api'>__Pyx_PyDict_GetItemStr</span>(__pyx_kwds, __pyx_n_s_full);
          if (value) { values[0] = value; kw_args--; }
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "selftest") &lt; 0)) <span class='error_goto'>__PYX_ERR(0, 937, __pyx_L3_error)</span>
      }
    } else {
      switch (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)) {
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        CYTHON_FALLTHROUGH;
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
    }
    __pyx_v_full = values[0];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("selftest", 0, 0, 1, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>__PYX_ERR(0, 937, __pyx_L3_error)</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.selftest", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_18selftest(__pyx_self, __pyx_v_full);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_4xpra_6codecs_10csc_cython_20colorspace_converter_18selftest(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_full) {
  PyObject *__pyx_v_testcsc = NULL;
  PyObject *__pyx_v_colorspace_converter = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("selftest", 0);
/* … */
  /* function exit code */
  __pyx_r = Py_None; <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_None);
  goto __pyx_L0;
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_5);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("xpra.codecs.csc_cython.colorspace_converter.selftest", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_testcsc);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_colorspace_converter);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/* … */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(3, __pyx_n_s_full, __pyx_n_s_testcsc, __pyx_n_s_colorspace_converter);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) __PYX_ERR(0, 937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
/* … */
  __pyx_t_11 = PyCFunction_NewEx(&amp;__pyx_mdef_4xpra_6codecs_10csc_cython_20colorspace_converter_19selftest, NULL, __pyx_n_s_xpra_codecs_csc_cython_colorspac_2);<span class='error_goto'> if (unlikely(!__pyx_t_11)) __PYX_ERR(0, 937, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_11);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_selftest, __pyx_t_11) &lt; 0) <span class='error_goto'>__PYX_ERR(0, 937, __pyx_L1_error)</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_11); __pyx_t_11 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">938</span>:     from xpra.codecs.codec_checks import testcsc</pre>
<pre class='cython code score-15 '>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_testcsc);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_testcsc);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_testcsc);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_xpra_codecs_codec_checks, __pyx_t_1, 0);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_testcsc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 938, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_1);
  __pyx_v_testcsc = __pyx_t_1;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class="cython line score-15" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">939</span>:     from xpra.codecs.csc_cython import colorspace_converter</pre>
<pre class='cython code score-15 '>  __pyx_t_2 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_colorspace_converter);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_colorspace_converter);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_2, 0, __pyx_n_s_colorspace_converter);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_xpra_codecs_csc_cython, __pyx_t_2, 0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_1, __pyx_n_s_colorspace_converter);<span class='error_goto'> if (unlikely(!__pyx_t_2)) __PYX_ERR(0, 939, __pyx_L1_error)</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_2);
  __pyx_v_colorspace_converter = __pyx_t_2;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class="cython line score-41" onclick="(function(s){s.display=s.display==='block'?'none':'block'})(this.nextElementSibling.style)">+<span class="">940</span>:     testcsc(colorspace_converter, False, full)</pre>
<pre class='cython code score-41 '>  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_testcsc);
  __pyx_t_2 = __pyx_v_testcsc; __pyx_t_3 = NULL;
  __pyx_t_4 = 0;
  if (CYTHON_UNPACK_METHODS &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
      __pyx_t_4 = 1;
    }
  }
  #if CYTHON_FAST_PYCALL
  if (<span class='py_c_api'>PyFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_colorspace_converter, Py_False, __pyx_v_full};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  #if CYTHON_FAST_PYCCALL
  if (<span class='pyx_c_api'>__Pyx_PyFastCFunction_Check</span>(__pyx_t_2)) {
    PyObject *__pyx_temp[4] = {__pyx_t_3, __pyx_v_colorspace_converter, Py_False, __pyx_v_full};
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyCFunction_FastCall</span>(__pyx_t_2, __pyx_temp+1-__pyx_t_4, 3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  } else
  #endif
  {
    __pyx_t_5 = <span class='py_c_api'>PyTuple_New</span>(3+__pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_5)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_5);
    if (__pyx_t_3) {
      <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_3); <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0, __pyx_t_3); __pyx_t_3 = NULL;
    }
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_colorspace_converter);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_colorspace_converter);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 0+__pyx_t_4, __pyx_v_colorspace_converter);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(Py_False);
    <span class='refnanny'>__Pyx_GIVEREF</span>(Py_False);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 1+__pyx_t_4, Py_False);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_v_full);
    <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_v_full);
    <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_5, 2+__pyx_t_4, __pyx_v_full);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_2, __pyx_t_5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) __PYX_ERR(0, 940, __pyx_L1_error)</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_5); __pyx_t_5 = 0;
  }
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre></div></body></html>
